// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <kha/LoaderImpl.h>
#include <kha/korehl/Sound.h>
#include <hl/types/ArrayDyn.h>
extern hl_type t$kha_korehl_Sound;
extern hl_type t$_dyn;
extern hl_type t$hl_types_ArrayDyn;
void kha_korehl_Sound_new(kha__korehl__Sound,String);
extern String s$readable;
bool Reflect_hasField(vdynamic*,String);
extern hl_type t$_bool;
kha__Image kha_Image_fromFile(String,bool);
extern hl_type t$vrt_2fe1e17;
extern String s$c0cb5f0;
extern hl_type t$String;
extern String s$Could_not_load_image_s_;
#include <haxe/io/Bytes.h>
#include <hl/natives.h>
extern String s$Could_not_load_blob_s_;
extern hl_type t$kha_internal_BytesBlob;
extern hl_type t$haxe_io_Bytes;
void haxe_io_Bytes_new(haxe__io__Bytes,vbyte*,int);
void kha_internal_BytesBlob_new(kha__internal__BytesBlob,haxe__io__Bytes);
extern hl_type t$kha_Kravur;
void kha_Kravur_new(kha__Kravur,kha__internal__BytesBlob,int*);
extern String s$Could_not_load_font_s_;
extern hl_type t$fun_11ee11d;
extern hl_type t$fun_ce44255;

void kha_LoaderImpl_loadSoundFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r8;
	kha__korehl__Sound r4;
	hl__types__ArrayDyn r6;
	vdynamic *r5;
	int r7;
	if( r1 == NULL ) hl_null_access();
	r4 = (kha__korehl__Sound)hl_alloc_obj(&t$kha_korehl_Sound);
	if( r0 == NULL ) hl_null_access();
	r5 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r6 = (hl__types__ArrayDyn)hl_dyn_castp(&r5,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r6 == NULL ) hl_null_access();
	r7 = 0;
	r5 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r6->$type->vobj_proto[0])(r6,r7);
	r8 = (String)r5;
	kha_korehl_Sound_new(r4,r8);
	r1->hasValue ? ((void (*)(vdynamic*,kha__Sound))r1->fun)((vdynamic*)r1->value,((kha__Sound)r4)) : ((void (*)(kha__Sound))r1->fun)(((kha__Sound)r4));
	return;
}

void kha_LoaderImpl_loadImageFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r5;
	kha__Image r7;
	vvirtual *r10;
	bool r3;
	hl__types__ArrayDyn r8;
	vdynamic *r4;
	int r9;
	r5 = (String)s$readable;
	r3 = Reflect_hasField(r0,r5);
	if( !r3 ) goto label$00c322a_2_9;
	if( r0 == NULL ) hl_null_access();
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,495394175/*readable*/,&t$_dyn);
	r3 = (bool)hl_dyn_casti(&r4,&t$_dyn,&t$_bool);
	if( !r3 ) goto label$00c322a_2_9;
	r3 = true;
	goto label$00c322a_2_10;
	label$00c322a_2_9:
	r3 = false;
	label$00c322a_2_10:
	if( r0 == NULL ) hl_null_access();
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r8 = (hl__types__ArrayDyn)hl_dyn_castp(&r4,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r8 == NULL ) hl_null_access();
	r9 = 0;
	r4 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r8->$type->vobj_proto[0])(r8,r9);
	r5 = (String)r4;
	r7 = kha_Image_fromFile(r5,r3);
	if( r7 ) goto label$00c322a_2_33;
	if( r2 == NULL ) hl_null_access();
	r10 = hl_alloc_virtual(&t$vrt_2fe1e17);
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	if( r4 == NULL ) hl_null_access();
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r4,107295988/*join*/,&t$_dyn);
	if( r4 == NULL ) hl_null_access();
	r5 = (String)s$c0cb5f0;
	{
		vdynamic *args[] = {(vdynamic*)r5};
		r4 = (vdynamic*)hl_dyn_call((vclosure*)r4,args,1);
	}
	r5 = (String)hl_dyn_castp(&r4,&t$_dyn,&t$String);
	if( hl_vfields(r10)[1] ) *(String*)(hl_vfields(r10)[1]) = (String)r5; else hl_dyn_setp(r10->value,5843823/*url*/,&t$String,r5);
	r5 = (String)s$Could_not_load_image_s_;
	if( hl_vfields(r10)[0] ) *(vdynamic**)(hl_vfields(r10)[0]) = (vdynamic*)r5; else hl_dyn_setp(r10->value,321506647/*error*/,&t$String,r5);
	r2->hasValue ? ((void (*)(vdynamic*,vvirtual*))r2->fun)((vdynamic*)r2->value,r10) : ((void (*)(vvirtual*))r2->fun)(r10);
	goto label$00c322a_2_35;
	label$00c322a_2_33:
	if( r1 == NULL ) hl_null_access();
	r1->hasValue ? ((void (*)(vdynamic*,kha__Image))r1->fun)((vdynamic*)r1->value,r7) : ((void (*)(kha__Image))r1->fun)(r7);
	label$00c322a_2_35:
	return;
}

void kha_LoaderImpl_loadBlobFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r10;
	vvirtual *r15;
	haxe__io__Bytes r17;
	kha__internal__BytesBlob r16;
	hl__types__ArrayDyn r8;
	int *r11, *r13;
	vdynamic *r7;
	vbyte *r6, *r12, *r14;
	int r3, r5, r9;
	r3 = 0;
	r5 = 0;
	if( r0 == NULL ) hl_null_access();
	r7 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r8 = (hl__types__ArrayDyn)hl_dyn_castp(&r7,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r8 == NULL ) hl_null_access();
	r9 = 0;
	r7 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r8->$type->vobj_proto[0])(r8,r9);
	r10 = (String)r7;
	if( r10 == NULL ) hl_null_access();
	r6 = r10->bytes;
	r11 = &r5;
	r9 = 0;
	r12 = hl_utf16_to_utf8(r6,r9,r11);
	r13 = &r3;
	r14 = hl_kinc_file_contents(r12,r13);
	if( r14 ) goto label$00c322a_3_31;
	if( r2 == NULL ) hl_null_access();
	r15 = hl_alloc_virtual(&t$vrt_2fe1e17);
	r7 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	if( r7 == NULL ) hl_null_access();
	r7 = (vdynamic*)hl_dyn_getp((vdynamic*)r7,107295988/*join*/,&t$_dyn);
	if( r7 == NULL ) hl_null_access();
	r10 = (String)s$c0cb5f0;
	{
		vdynamic *args[] = {(vdynamic*)r10};
		r7 = (vdynamic*)hl_dyn_call((vclosure*)r7,args,1);
	}
	r10 = (String)hl_dyn_castp(&r7,&t$_dyn,&t$String);
	if( hl_vfields(r15)[1] ) *(String*)(hl_vfields(r15)[1]) = (String)r10; else hl_dyn_setp(r15->value,5843823/*url*/,&t$String,r10);
	r10 = (String)s$Could_not_load_blob_s_;
	if( hl_vfields(r15)[0] ) *(vdynamic**)(hl_vfields(r15)[0]) = (vdynamic*)r10; else hl_dyn_setp(r15->value,321506647/*error*/,&t$String,r10);
	r2->hasValue ? ((void (*)(vdynamic*,vvirtual*))r2->fun)((vdynamic*)r2->value,r15) : ((void (*)(vvirtual*))r2->fun)(r15);
	goto label$00c322a_3_37;
	label$00c322a_3_31:
	if( r1 == NULL ) hl_null_access();
	r16 = (kha__internal__BytesBlob)hl_alloc_obj(&t$kha_internal_BytesBlob);
	r17 = (haxe__io__Bytes)hl_alloc_obj(&t$haxe_io_Bytes);
	haxe_io_Bytes_new(r17,r14,r3);
	kha_internal_BytesBlob_new(r16,r17);
	r1->hasValue ? ((void (*)(vdynamic*,kha__internal__BytesBlob))r1->fun)((vdynamic*)r1->value,r16) : ((void (*)(kha__internal__BytesBlob))r1->fun)(r16);
	label$00c322a_3_37:
	return;
}

void kha_LoaderImpl_loadFontFromDescription__$1(vclosure* r0,kha__internal__BytesBlob r1) {
	kha__Kravur r3;
	int *r4;
	if( r0 == NULL ) hl_null_access();
	r3 = (kha__Kravur)hl_alloc_obj(&t$kha_Kravur);
	r4 = NULL;
	kha_Kravur_new(r3,r1,r4);
	r0->hasValue ? ((void (*)(vdynamic*,kha__Kravur))r0->fun)((vdynamic*)r0->value,r3) : ((void (*)(kha__Kravur))r0->fun)(r3);
	return;
}

void kha_LoaderImpl_loadFontFromDescription__$2(vclosure* r0,vvirtual* r1) {
	String r2;
	if( r1 == NULL ) hl_null_access();
	r2 = (String)s$Could_not_load_font_s_;
	if( hl_vfields(r1)[0] ) *(vdynamic**)(hl_vfields(r1)[0]) = (vdynamic*)r2; else hl_dyn_setp(r1->value,321506647/*error*/,&t$String,r2);
	if( r0 == NULL ) hl_null_access();
	r0->hasValue ? ((void (*)(vdynamic*,vvirtual*))r0->fun)((vdynamic*)r0->value,r1) : ((void (*)(vvirtual*))r0->fun)(r1);
	return;
}

void kha_LoaderImpl_loadFontFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	vclosure *r4, *r5;
	r4 = hl_alloc_closure_ptr(&t$fun_11ee11d,kha_LoaderImpl_loadFontFromDescription__$1,r1);
	r5 = hl_alloc_closure_ptr(&t$fun_ce44255,kha_LoaderImpl_loadFontFromDescription__$2,r2);
	kha_LoaderImpl_loadBlobFromDescription(r0,r4,r5);
	return;
}

