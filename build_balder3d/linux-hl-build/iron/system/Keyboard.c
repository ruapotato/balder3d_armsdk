// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <iron/system/Keyboard.h>
#include <hl/types/ArrayBase.h>
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);
hl__types__ArrayBase hl_types_ArrayObj_splice(hl__types__ArrayObj,int,int);
extern hl_type t$hl_types_ArrayObj;
extern hl_type t$hl_types_ArrayBase;
double kha_Scheduler_time(void);
extern iron__system__$Keyboard g$_iron_system_Keyboard;
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
String String_fromCharCode(int);
String String_toLowerCase(String);
extern String s$back;
extern String s$backspace;
extern String s$tab;
extern String s$enter;
extern String s$shift;
extern String s$control;
extern String s$alt;
extern String s$capslock;
extern String s$escape;
extern String s$space;
extern String s$left;
extern String s$up;
extern String s$right;
extern String s$down;
extern String s$delete;
extern String s$0;
extern String s$1;
extern String s$2;
extern String s$3;
extern String s$4;
extern String s$5;
extern String s$6;
extern String s$7;
extern String s$8;
extern String s$9;
extern String s$853ae90;
extern String s$9eecb7d;
extern String s$524a507;
extern String s$43ec3e5;
extern String s$cedf8da;
extern String s$d1457b7;
extern String s$518ed29;
extern String s$win;
extern String s$3389dae;
extern String s$26b1722;
extern String s$336d5eb;
extern String s$5058f1a;
extern String s$6666cd7;
extern String s$f1;
extern String s$f2;
extern String s$f3;
extern String s$f4;
extern String s$f5;
extern String s$f6;
extern String s$f7;
extern String s$f8;
extern String s$f9;
extern String s$f10;
extern String s$f11;
extern String s$f12;
extern String s$9033e0e;
extern String s$b15835f;
extern String s$01abfc7;
extern String s$c3e97dd;
extern String s$0bcef9c;
extern String s$6cff047;
extern String s$b14a7b8;
extern String s$84c4047;
extern String s$9371d7a;
extern String s$b99834b;
extern String s$f95b70f;
extern String s$cbb184d;
extern String s$4c761f1;
extern String s$c0cb5f0;
extern String s$833344d;
extern String s$8154172;
extern String s$28d397e;
extern String s$0fbd177;
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
void iron_system_VirtualInput_downVirtual(iron__system__VirtualInput,String);
void iron_system_VirtualInput_upVirtual(iron__system__VirtualInput,String);
#include <kha/input/Keyboard.h>
extern hl_type t$String;
#include <hl/natives.h>
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
void iron_system_VirtualInput_new(iron__system__VirtualInput);
kha__input__Keyboard kha_input_Keyboard_get(int*);
extern hl_type t$fun_fd2bdea;
extern hl_type t$fun_7bd35b7;
void kha_input_Keyboard_notify(kha__input__Keyboard,vclosure*,vclosure*,vclosure*);

void iron_system_Keyboard_endFrame(iron__system__Keyboard r0) {
	String r7;
	haxe__ds__StringMap r10;
	hl__types__ArrayObj r3, r6;
	bool r11;
	hl__types__ArrayBase r12;
	double r13, r14;
	vdynamic *r8;
	varray *r9;
	int r2, r4, r5;
	r3 = r0->keysFrame;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->length;
	r4 = 0;
	if( r4 >= r2 ) goto label$7027374_1_38;
	r2 = 0;
	r3 = r0->keysFrame;
	label$7027374_1_7:
	if( r3 == NULL ) hl_null_access();
	r5 = r3->length;
	if( r2 >= r5 ) goto label$7027374_1_30;
	r5 = r3->length;
	if( ((unsigned)r2) < ((unsigned)r5) ) goto label$7027374_1_15;
	r7 = NULL;
	goto label$7027374_1_18;
	label$7027374_1_15:
	r9 = r3->array;
	r8 = ((vdynamic**)(r9 + 1))[r2];
	r7 = (String)r8;
	label$7027374_1_18:
	++r2;
	r10 = r0->keysStarted;
	if( r10 == NULL ) hl_null_access();
	r11 = false;
	r8 = hl_alloc_dynbool(r11);
	haxe_ds_StringMap_set(r10,r7,r8);
	r10 = r0->keysReleased;
	if( r10 == NULL ) hl_null_access();
	r11 = false;
	r8 = hl_alloc_dynbool(r11);
	haxe_ds_StringMap_set(r10,r7,r8);
	goto label$7027374_1_7;
	label$7027374_1_30:
	r3 = r0->keysFrame;
	if( r3 == NULL ) hl_null_access();
	r2 = 0;
	r6 = r0->keysFrame;
	if( r6 == NULL ) hl_null_access();
	r4 = r6->length;
	r12 = hl_types_ArrayObj_splice(r3,r2,r4);
	r3 = (hl__types__ArrayObj)hl_dyn_castp(&r12,&t$hl_types_ArrayBase,&t$hl_types_ArrayObj);
	label$7027374_1_38:
	r13 = kha_Scheduler_time();
	r14 = r0->repeatTime;
	r13 = r13 - r14;
	r14 = 0.05000000000000000278;
	if( !(r14 < r13) ) goto label$7027374_1_48;
	r13 = kha_Scheduler_time();
	r0->repeatTime = r13;
	r11 = true;
	r0->repeatKey = r11;
	goto label$7027374_1_50;
	label$7027374_1_48:
	r11 = false;
	r0->repeatKey = r11;
	label$7027374_1_50:
	return;
}

void iron_system_Keyboard_reset(iron__system__Keyboard r0) {
	String r6;
	haxe__ds__StringMap r9;
	hl__types__ArrayObj r3;
	bool r10;
	iron__system__$Keyboard r4;
	vdynamic *r7;
	varray *r8;
	int r1, r5;
	r1 = 0;
	r4 = (iron__system__$Keyboard)g$_iron_system_Keyboard;
	r3 = r4->keys;
	label$7027374_2_3:
	if( r3 == NULL ) hl_null_access();
	r5 = r3->length;
	if( r1 >= r5 ) goto label$7027374_2_31;
	r5 = r3->length;
	if( ((unsigned)r1) < ((unsigned)r5) ) goto label$7027374_2_11;
	r6 = NULL;
	goto label$7027374_2_14;
	label$7027374_2_11:
	r8 = r3->array;
	r7 = ((vdynamic**)(r8 + 1))[r1];
	r6 = (String)r7;
	label$7027374_2_14:
	++r1;
	r9 = r0->keysDown;
	if( r9 == NULL ) hl_null_access();
	r10 = false;
	r7 = hl_alloc_dynbool(r10);
	haxe_ds_StringMap_set(r9,r6,r7);
	r9 = r0->keysStarted;
	if( r9 == NULL ) hl_null_access();
	r10 = false;
	r7 = hl_alloc_dynbool(r10);
	haxe_ds_StringMap_set(r9,r6,r7);
	r9 = r0->keysReleased;
	if( r9 == NULL ) hl_null_access();
	r10 = false;
	r7 = hl_alloc_dynbool(r10);
	haxe_ds_StringMap_set(r9,r6,r7);
	goto label$7027374_2_3;
	label$7027374_2_31:
	iron_system_Keyboard_endFrame(r0);
	return;
}

bool iron_system_Keyboard_down(iron__system__Keyboard r0,String r1) {
	haxe__ds__StringMap r3;
	bool r5;
	vdynamic *r2, *r4;
	r3 = r0->keysDown;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_StringMap_get(r3,r1);
	r4 = (vdynamic*)r2;
	r5 = r4 ? r4->v.b : 0;
	return r5;
}

bool iron_system_Keyboard_started(iron__system__Keyboard r0,String r1) {
	haxe__ds__StringMap r3;
	bool r5;
	vdynamic *r2, *r4;
	r3 = r0->keysStarted;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_StringMap_get(r3,r1);
	r4 = (vdynamic*)r2;
	r5 = r4 ? r4->v.b : 0;
	return r5;
}

bool iron_system_Keyboard_released(iron__system__Keyboard r0,String r1) {
	haxe__ds__StringMap r3;
	bool r5;
	vdynamic *r2, *r4;
	r3 = r0->keysReleased;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_StringMap_get(r3,r1);
	r4 = (vdynamic*)r2;
	r5 = r4 ? r4->v.b : 0;
	return r5;
}

String iron_system_Keyboard_keyCode(int r0) {
	String r1;
	switch(r0) {
		default:
		case 0:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
		case 10:
		case 11:
		case 12:
		case 14:
		case 15:
		case 19:
		case 21:
		case 22:
		case 23:
		case 24:
		case 25:
		case 26:
		case 28:
		case 29:
		case 30:
		case 31:
		case 33:
		case 34:
		case 35:
		case 36:
		case 41:
		case 42:
		case 43:
		case 44:
		case 45:
		case 47:
		case 65:
		case 66:
		case 67:
		case 68:
		case 69:
		case 70:
		case 71:
		case 72:
		case 73:
		case 74:
		case 75:
		case 76:
		case 77:
		case 78:
		case 79:
		case 80:
		case 81:
		case 82:
		case 83:
		case 84:
		case 85:
		case 86:
		case 87:
		case 88:
		case 89:
		case 90:
		case 92:
		case 93:
		case 94:
		case 95:
		case 108:
		case 124:
		case 125:
		case 126:
		case 127:
		case 128:
		case 129:
		case 130:
		case 131:
		case 132:
		case 133:
		case 134:
		case 135:
		case 136:
		case 137:
		case 138:
		case 139:
		case 140:
		case 141:
		case 142:
		case 143:
		case 144:
		case 145:
		case 146:
		case 147:
		case 148:
		case 149:
		case 150:
		case 151:
		case 152:
		case 153:
		case 154:
		case 155:
		case 156:
		case 157:
		case 158:
		case 159:
		case 160:
		case 177:
		case 178:
		case 179:
		case 180:
		case 181:
		case 182:
		case 183:
		case 184:
		case 185:
		case 186:
		case 187:
		case 189:
		case 193:
		case 194:
		case 195:
		case 196:
		case 197:
		case 198:
		case 199:
		case 200:
		case 201:
		case 202:
		case 203:
		case 204:
		case 205:
		case 206:
		case 207:
		case 208:
		case 209:
		case 210:
		case 211:
		case 212:
		case 213:
		case 214:
		case 215:
		case 216:
		case 217:
		case 218:
			r1 = String_fromCharCode(r0);
			if( r1 == NULL ) hl_null_access();
			r1 = String_toLowerCase(r1);
			return r1;
		case 1:
			r1 = (String)s$back;
			return r1;
		case 8:
			r1 = (String)s$backspace;
			return r1;
		case 9:
			r1 = (String)s$tab;
			return r1;
		case 13:
			r1 = (String)s$enter;
			return r1;
		case 16:
			r1 = (String)s$shift;
			return r1;
		case 17:
			r1 = (String)s$control;
			return r1;
		case 18:
			r1 = (String)s$alt;
			return r1;
		case 20:
			r1 = (String)s$capslock;
			return r1;
		case 27:
			r1 = (String)s$escape;
			return r1;
		case 32:
			r1 = (String)s$space;
			return r1;
		case 37:
			r1 = (String)s$left;
			return r1;
		case 38:
			r1 = (String)s$up;
			return r1;
		case 39:
			r1 = (String)s$right;
			return r1;
		case 40:
			r1 = (String)s$down;
			return r1;
		case 46:
			r1 = (String)s$delete;
			return r1;
		case 48:
			r1 = (String)s$0;
			return r1;
		case 49:
			r1 = (String)s$1;
			return r1;
		case 50:
			r1 = (String)s$2;
			return r1;
		case 51:
			r1 = (String)s$3;
			return r1;
		case 52:
			r1 = (String)s$4;
			return r1;
		case 53:
			r1 = (String)s$5;
			return r1;
		case 54:
			r1 = (String)s$6;
			return r1;
		case 55:
			r1 = (String)s$7;
			return r1;
		case 56:
			r1 = (String)s$8;
			return r1;
		case 57:
			r1 = (String)s$9;
			return r1;
		case 58:
			r1 = (String)s$853ae90;
			return r1;
		case 59:
			r1 = (String)s$9eecb7d;
			return r1;
		case 60:
			r1 = (String)s$524a507;
			return r1;
		case 61:
			r1 = (String)s$43ec3e5;
			return r1;
		case 62:
			r1 = (String)s$cedf8da;
			return r1;
		case 63:
			r1 = (String)s$d1457b7;
			return r1;
		case 64:
			r1 = (String)s$518ed29;
			return r1;
		case 91:
			r1 = (String)s$win;
			return r1;
		case 96:
			r1 = (String)s$0;
			return r1;
		case 97:
			r1 = (String)s$1;
			return r1;
		case 98:
			r1 = (String)s$2;
			return r1;
		case 99:
			r1 = (String)s$3;
			return r1;
		case 100:
			r1 = (String)s$4;
			return r1;
		case 101:
			r1 = (String)s$5;
			return r1;
		case 102:
			r1 = (String)s$6;
			return r1;
		case 103:
			r1 = (String)s$7;
			return r1;
		case 104:
			r1 = (String)s$8;
			return r1;
		case 105:
			r1 = (String)s$9;
			return r1;
		case 106:
			r1 = (String)s$3389dae;
			return r1;
		case 107:
			r1 = (String)s$26b1722;
			return r1;
		case 109:
			r1 = (String)s$336d5eb;
			return r1;
		case 110:
			r1 = (String)s$5058f1a;
			return r1;
		case 111:
			r1 = (String)s$6666cd7;
			return r1;
		case 112:
			r1 = (String)s$f1;
			return r1;
		case 113:
			r1 = (String)s$f2;
			return r1;
		case 114:
			r1 = (String)s$f3;
			return r1;
		case 115:
			r1 = (String)s$f4;
			return r1;
		case 116:
			r1 = (String)s$f5;
			return r1;
		case 117:
			r1 = (String)s$f6;
			return r1;
		case 118:
			r1 = (String)s$f7;
			return r1;
		case 119:
			r1 = (String)s$f8;
			return r1;
		case 120:
			r1 = (String)s$f9;
			return r1;
		case 121:
			r1 = (String)s$f10;
			return r1;
		case 122:
			r1 = (String)s$f11;
			return r1;
		case 123:
			r1 = (String)s$f12;
			return r1;
		case 161:
			r1 = (String)s$9033e0e;
			return r1;
		case 162:
			r1 = (String)s$b15835f;
			return r1;
		case 163:
			r1 = (String)s$01abfc7;
			return r1;
		case 164:
			r1 = (String)s$c3e97dd;
			return r1;
		case 165:
			r1 = (String)s$0bcef9c;
			return r1;
		case 166:
			r1 = (String)s$6cff047;
			return r1;
		case 167:
			r1 = (String)s$b14a7b8;
			return r1;
		case 168:
			r1 = (String)s$84c4047;
			return r1;
		case 169:
			r1 = (String)s$9371d7a;
			return r1;
		case 170:
			r1 = (String)s$3389dae;
			return r1;
		case 171:
			r1 = (String)s$26b1722;
			return r1;
		case 172:
			r1 = (String)s$b99834b;
			return r1;
		case 173:
			r1 = (String)s$336d5eb;
			return r1;
		case 174:
			r1 = (String)s$f95b70f;
			return r1;
		case 175:
			r1 = (String)s$cbb184d;
			return r1;
		case 176:
			r1 = (String)s$4c761f1;
			return r1;
		case 188:
			r1 = (String)s$c0cb5f0;
			return r1;
		case 190:
			r1 = (String)s$5058f1a;
			return r1;
		case 191:
			r1 = (String)s$6666cd7;
			return r1;
		case 192:
			r1 = (String)s$833344d;
			return r1;
		case 219:
			r1 = (String)s$8154172;
			return r1;
		case 220:
			r1 = (String)s$28d397e;
			return r1;
		case 221:
			r1 = (String)s$0fbd177;
			return r1;
	}
}

void iron_system_Keyboard_downListener(iron__system__Keyboard r0,int r1) {
	String r2;
	haxe__ds__StringMap r6;
	hl__types__ArrayObj r5;
	bool r7;
	double r9, r10;
	vdynamic *r8;
	int r3;
	r2 = iron_system_Keyboard_keyCode(r1);
	r5 = r0->keysFrame;
	if( r5 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_push(r5,((vdynamic*)r2));
	r6 = r0->keysStarted;
	if( r6 == NULL ) hl_null_access();
	r7 = true;
	r8 = hl_alloc_dynbool(r7);
	haxe_ds_StringMap_set(r6,r2,r8);
	r6 = r0->keysDown;
	if( r6 == NULL ) hl_null_access();
	r7 = true;
	r8 = hl_alloc_dynbool(r7);
	haxe_ds_StringMap_set(r6,r2,r8);
	r9 = kha_Scheduler_time();
	r10 = 0.4000000000000000222;
	r9 = r9 + r10;
	r0->repeatTime = r9;
	iron_system_VirtualInput_downVirtual(((iron__system__VirtualInput)r0),r2);
	return;
}

void iron_system_Keyboard_upListener(iron__system__Keyboard r0,int r1) {
	String r2;
	haxe__ds__StringMap r6;
	hl__types__ArrayObj r5;
	bool r7;
	vdynamic *r8;
	int r3;
	r2 = iron_system_Keyboard_keyCode(r1);
	r5 = r0->keysFrame;
	if( r5 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_push(r5,((vdynamic*)r2));
	r6 = r0->keysReleased;
	if( r6 == NULL ) hl_null_access();
	r7 = true;
	r8 = hl_alloc_dynbool(r7);
	haxe_ds_StringMap_set(r6,r2,r8);
	r6 = r0->keysDown;
	if( r6 == NULL ) hl_null_access();
	r7 = false;
	r8 = hl_alloc_dynbool(r7);
	haxe_ds_StringMap_set(r6,r2,r8);
	iron_system_VirtualInput_upVirtual(((iron__system__VirtualInput)r0),r2);
	return;
}

void iron_system_Keyboard_pressListener(iron__system__Keyboard r0,String r1) {
	return;
}

void iron_system_Keyboard_new(iron__system__Keyboard r0) {
	haxe__ds__StringMap r7;
	hl__types__ArrayObj r3;
	hl_type *r5;
	bool r2;
	vclosure *r11, *r12, *r13;
	double r1;
	int *r10;
	kha__input__Keyboard r9;
	int r6;
	varray *r4;
	r1 = 0.;
	r0->repeatTime = r1;
	r2 = false;
	r0->repeatKey = r2;
	r5 = &t$String;
	r6 = 0;
	r4 = hl_alloc_array(r5,r6);
	r3 = hl_types_ArrayObj_alloc(r4);
	r0->keysFrame = r3;
	r7 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r7);
	r0->keysReleased = r7;
	r7 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r7);
	r0->keysStarted = r7;
	r7 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r7);
	r0->keysDown = r7;
	iron_system_VirtualInput_new(((iron__system__VirtualInput)r0));
	iron_system_Keyboard_reset(r0);
	r10 = NULL;
	r9 = kha_input_Keyboard_get(r10);
	if( r9 == NULL ) hl_null_access();
	r11 = hl_alloc_closure_ptr(&t$fun_fd2bdea,iron_system_Keyboard_downListener,r0);
	r12 = hl_alloc_closure_ptr(&t$fun_fd2bdea,iron_system_Keyboard_upListener,r0);
	r13 = hl_alloc_closure_ptr(&t$fun_7bd35b7,iron_system_Keyboard_pressListener,r0);
	kha_input_Keyboard_notify(r9,r11,r12,r13);
	return;
}

