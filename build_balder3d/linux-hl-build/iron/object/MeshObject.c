// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <iron/object/MeshObject.h>
#include <iron/data/Geometry.h>
void iron_data_Geometry_build(iron__data__Geometry);
#include <iron/object/ParticleSystem.h>
#include <iron/Scene.h>
void iron_object_ParticleSystem_remove(iron__object__ParticleSystem);
void iron_object_Tilesheet_remove(iron__object__Tilesheet);
extern iron__$Scene g$_iron_Scene;
bool hl_types_ArrayObj_remove(hl__types__ArrayObj,vdynamic*);
void iron_object_Object_remove(iron__object__Object);
#include <iron/object/BoneAnimation.h>
iron__object__BoneAnimation iron_object_Object_getParentArmature(iron__object__Object,String);
extern hl_type t$iron_object_BoneAnimation;
void iron_object_BoneAnimation_new(iron__object__BoneAnimation,String);
extern hl_type t$iron_object_Animation;
void iron_object_BoneAnimation_setSkin(iron__object__BoneAnimation,iron__object__MeshObject);
void iron_object_Object_setupAnimation(iron__object__Object,hl__types__ArrayObj);
#include <iron/data/TMorphTarget.h>
#include <iron/data/TMeshData.h>
extern hl_type t$iron_object_MorphTarget;
void iron_object_MorphTarget_new(iron__object__MorphTarget,iron__data__TMorphTarget);
#include <iron/data/TParticleReference.h>
extern hl_type t$iron_object_ParticleSystem;
#include <hl/natives.h>
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
void iron_object_ParticleSystem_new(iron__object__ParticleSystem,String,iron__data__TParticleReference);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
extern hl_type t$iron_object_Tilesheet;
void iron_object_Tilesheet_new(iron__object__Tilesheet,String,String,String);
bool iron_object_MeshObject_validContext(iron__object__MeshObject,hl__types__ArrayObj,String);
extern String s$shadowmap;
int String___compare(String,vdynamic*);
extern String s$voxel;
#include <iron/object/CameraObject.h>
#include <iron/object/LightObject.h>
#include <iron/data/TCameraData.h>
#include <iron/data/CameraData.h>
#include <iron/data/TLightData.h>
#include <iron/data/LightData.h>
extern String s$sun;
bool iron_object_CameraObject_sphereInFrustum(hl__types__ArrayObj,iron__object__Transform,double*,double*,double*,double*);
#include <iron/data/MaterialData.h>
#include <iron/data/TMaterialData.h>
#include <iron/data/TMaterialContext.h>
#include <iron/data/MaterialContext.h>
#include <iron/data/ShaderContext.h>
#include <iron/data/ShaderData.h>
extern hl_type t$_i32;
String String_substr(String,int,vdynamic*);
iron__data__ShaderContext iron_data_ShaderData_getContext(iron__data__ShaderData,String);
extern hl_type t$iron_object_MeshObject;
extern hl_type t$iron_object_Object;
#include <kha/graphics4/VertexBuffer.h>
#include <kha/Image.h>
#include <kha/math/FastMatrix3.h>
#include <kha/math/FastMatrix4.h>
#include <kha/graphics4/IndexBuffer.h>
#include <kha/arrays/ByteArrayPrivate.h>
#include <kha/graphics4/CubeMap.h>
#include <iron/RenderPath.h>
#include <iron/data/TParticleData.h>
#include <iron/data/ParticleData.h>
#include <iron/data/TSceneFormat.h>
#include <iron/math/Vec4.h>
#include <iron/data/TLod.h>
#include <iron/object/Uniforms.h>
#include <hl/types/ArrayBytes_Int.h>
#include <iron/data/TShaderContext.h>
extern iron__$RenderPath g$_iron_RenderPath;
extern String s$mesh;
extern hl_type t$fun_c7cc210;
void iron_Scene_spawnObject(iron__Scene,String,iron__object__Object,vclosure*,bool*,iron__data__TSceneFormat);
void iron_object_ParticleSystem_update(iron__object__ParticleSystem,iron__object__MeshObject,iron__object__MeshObject);
extern String s$;
iron__object__Object iron_Scene_getChild(iron__Scene,String);
extern hl_type t$iron_data_MaterialContext;
extern hl_type t$iron_data_ShaderContext;
extern hl_type t$_f32;
extern iron__object__$Uniforms g$_iron_object_Uniforms;
void iron_object_Transform_update(iron__object__Transform);
extern iron__object__$MeshObject g$_iron_object_MeshObject;
extern hl_type t$fun_c80ec77;
void iron_object_Uniforms_setContextConstants(vvirtual*,iron__data__ShaderContext,hl__types__ArrayObj);
void iron_object_Uniforms_setObjectConstants(vvirtual*,iron__data__ShaderContext,iron__object__Object);
void iron_object_Uniforms_setMaterialConstants(vvirtual*,iron__data__ShaderContext,iron__data__MaterialContext);
extern hl_type t$kha_graphics4_VertexBuffer;
kha__graphics4__VertexBuffer iron_data_Geometry_get(iron__data__Geometry,hl__types__ArrayObj);
extern hl_type t$fun_58e3acc;
extern hl_type t$fun_a561c62;
extern hl_type t$fun_46c6b6e;
extern hl_type t$fun_bb34868;
extern hl_type t$fun_8305be0;
iron__data__MaterialContext iron_data_MaterialData_getContext(iron__data__MaterialData,String);
void iron_object_Object_new(iron__object__Object);

void iron_object_MeshObject_setData(iron__object__MeshObject r0,iron__data__MeshData r1) {
	iron__data__Geometry r4;
	iron__object__Transform r5;
	float r6;
	int r2;
	r0->data = r1;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->refcount;
	++r2;
	r1->refcount = r2;
	r4 = r1->geom;
	if( r4 == NULL ) hl_null_access();
	iron_data_Geometry_build(r4);
	r5 = r0->transform;
	if( r5 == NULL ) hl_null_access();
	r6 = r1->scalePos;
	r5->scaleWorld = r6;
	return;
}

void iron_object_MeshObject_remove(iron__object__MeshObject r0) {
	iron__object__ParticleSystem r8;
	iron__object__MeshObject r5;
	hl__types__ArrayObj r2;
	bool r12;
	iron__$Scene r11;
	iron__Scene r10;
	iron__data__MeshData r13;
	iron__object__Tilesheet r9;
	vdynamic *r6;
	varray *r7;
	int r3, r4;
	r2 = r0->particleChildren;
	if( !r2 ) goto label$f53fdd2_2_21;
	r3 = 0;
	r2 = r0->particleChildren;
	label$f53fdd2_2_4:
	if( r2 == NULL ) hl_null_access();
	r4 = r2->length;
	if( r3 >= r4 ) goto label$f53fdd2_2_19;
	r4 = r2->length;
	if( ((unsigned)r3) < ((unsigned)r4) ) goto label$f53fdd2_2_12;
	r5 = NULL;
	goto label$f53fdd2_2_15;
	label$f53fdd2_2_12:
	r7 = r2->array;
	r6 = ((vdynamic**)(r7 + 1))[r3];
	r5 = (iron__object__MeshObject)r6;
	label$f53fdd2_2_15:
	++r3;
	if( r5 == NULL ) hl_null_access();
	iron_object_MeshObject_remove(r5);
	goto label$f53fdd2_2_4;
	label$f53fdd2_2_19:
	r2 = NULL;
	r0->particleChildren = r2;
	label$f53fdd2_2_21:
	r2 = r0->particleSystems;
	if( !r2 ) goto label$f53fdd2_2_42;
	r3 = 0;
	r2 = r0->particleSystems;
	label$f53fdd2_2_25:
	if( r2 == NULL ) hl_null_access();
	r4 = r2->length;
	if( r3 >= r4 ) goto label$f53fdd2_2_40;
	r4 = r2->length;
	if( ((unsigned)r3) < ((unsigned)r4) ) goto label$f53fdd2_2_33;
	r8 = NULL;
	goto label$f53fdd2_2_36;
	label$f53fdd2_2_33:
	r7 = r2->array;
	r6 = ((vdynamic**)(r7 + 1))[r3];
	r8 = (iron__object__ParticleSystem)r6;
	label$f53fdd2_2_36:
	++r3;
	if( r8 == NULL ) hl_null_access();
	iron_object_ParticleSystem_remove(r8);
	goto label$f53fdd2_2_25;
	label$f53fdd2_2_40:
	r2 = NULL;
	r0->particleSystems = r2;
	label$f53fdd2_2_42:
	r9 = r0->tilesheet;
	if( !r9 ) goto label$f53fdd2_2_47;
	r9 = r0->tilesheet;
	if( r9 == NULL ) hl_null_access();
	iron_object_Tilesheet_remove(r9);
	label$f53fdd2_2_47:
	r11 = (iron__$Scene)g$_iron_Scene;
	r10 = r11->active;
	if( !r10 ) goto label$f53fdd2_2_56;
	r11 = (iron__$Scene)g$_iron_Scene;
	r10 = r11->active;
	if( r10 == NULL ) hl_null_access();
	r2 = r10->meshes;
	if( r2 == NULL ) hl_null_access();
	r12 = hl_types_ArrayObj_remove(r2,((vdynamic*)r0));
	label$f53fdd2_2_56:
	r13 = r0->data;
	if( r13 == NULL ) hl_null_access();
	r3 = r13->refcount;
	--r3;
	r13->refcount = r3;
	iron_object_Object_remove(((iron__object__Object)r0));
	return;
}

void iron_object_MeshObject_setupAnimation(iron__object__MeshObject r0,hl__types__ArrayObj r1) {
	String r8;
	hl__types__ArrayObj r5;
	bool r2, r7;
	iron__data__TObj r4;
	iron__data__MeshData r11;
	iron__object__BoneAnimation r9;
	iron__object__Object r3;
	iron__object__Animation r10;
	r3 = r0->parent;
	if( !r3 ) goto label$f53fdd2_3_14;
	r3 = r0->parent;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->raw;
	if( !r4 ) goto label$f53fdd2_3_14;
	r3 = r0->parent;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->raw;
	if( r4 == NULL ) hl_null_access();
	r5 = r4->bone_actions;
	if( !r5 ) goto label$f53fdd2_3_14;
	r2 = true;
	goto label$f53fdd2_3_15;
	label$f53fdd2_3_14:
	r2 = false;
	label$f53fdd2_3_15:
	if( !r2 ) goto label$f53fdd2_3_34;
	r3 = r0->parent;
	if( r3 == NULL ) hl_null_access();
	r8 = r3->name;
	r9 = iron_object_Object_getParentArmature(((iron__object__Object)r0),r8);
	r0->animation = ((iron__object__Animation)r9);
	r10 = r0->animation;
	if( r10 ) goto label$f53fdd2_3_26;
	r9 = (iron__object__BoneAnimation)hl_alloc_obj(&t$iron_object_BoneAnimation);
	iron_object_BoneAnimation_new(r9,r8);
	r0->animation = ((iron__object__Animation)r9);
	label$f53fdd2_3_26:
	r11 = r0->data;
	if( r11 == NULL ) hl_null_access();
	r7 = r11->isSkinned;
	if( !r7 ) goto label$f53fdd2_3_34;
	r10 = r0->animation;
	r9 = (iron__object__BoneAnimation)hl_dyn_castp(&r10,&t$iron_object_Animation,&t$iron_object_BoneAnimation);
	if( r9 == NULL ) hl_null_access();
	iron_object_BoneAnimation_setSkin(r9,r0);
	label$f53fdd2_3_34:
	iron_object_Object_setupAnimation(((iron__object__Object)r0),r1);
	return;
}

void iron_object_MeshObject_setupMorphTargets(iron__object__MeshObject r0) {
	iron__object__MorphTarget r5;
	iron__data__MeshData r4;
	iron__data__TMorphTarget r2;
	iron__data__TMeshData r3;
	r4 = r0->data;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->raw;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->morph_target;
	if( !r2 ) goto label$f53fdd2_4_14;
	r5 = (iron__object__MorphTarget)hl_alloc_obj(&t$iron_object_MorphTarget);
	r4 = r0->data;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->raw;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->morph_target;
	iron_object_MorphTarget_new(r5,r2);
	r0->morphTarget = r5;
	label$f53fdd2_4_14:
	return;
}

void iron_object_MeshObject_setupParticleSystem(iron__object__MeshObject r0,String r1,iron__data__TParticleReference r2) {
	iron__object__ParticleSystem r8;
	hl__types__ArrayObj r4;
	hl_type *r6;
	int r7;
	varray *r5;
	r4 = r0->particleSystems;
	if( r4 ) goto label$f53fdd2_5_7;
	r6 = &t$iron_object_ParticleSystem;
	r7 = 0;
	r5 = hl_alloc_array(r6,r7);
	r4 = hl_types_ArrayObj_alloc(r5);
	r0->particleSystems = r4;
	label$f53fdd2_5_7:
	r8 = (iron__object__ParticleSystem)hl_alloc_obj(&t$iron_object_ParticleSystem);
	iron_object_ParticleSystem_new(r8,r1,r2);
	r4 = r0->particleSystems;
	if( r4 == NULL ) hl_null_access();
	r7 = hl_types_ArrayObj_push(r4,((vdynamic*)r8));
	return;
}

void iron_object_MeshObject_setupTilesheet(iron__object__MeshObject r0,String r1,String r2,String r3) {
	iron__object__Tilesheet r4;
	r4 = (iron__object__Tilesheet)hl_alloc_obj(&t$iron_object_Tilesheet);
	iron_object_Tilesheet_new(r4,r1,r2,r3);
	r0->tilesheet = r4;
	return;
}

bool iron_object_MeshObject_setCulled(iron__object__MeshObject r0,bool r1,bool r2) {
	bool r3;
	if( !r1 ) goto label$f53fdd2_7_3;
	r0->culledShadow = r2;
	goto label$f53fdd2_7_4;
	label$f53fdd2_7_3:
	r0->culledMesh = r2;
	label$f53fdd2_7_4:
	r3 = r0->culledMesh;
	if( !r3 ) goto label$f53fdd2_7_10;
	r3 = r0->culledShadow;
	if( !r3 ) goto label$f53fdd2_7_10;
	r3 = true;
	goto label$f53fdd2_7_11;
	label$f53fdd2_7_10:
	r3 = false;
	label$f53fdd2_7_11:
	r0->culled = r3;
	return r2;
}

bool iron_object_MeshObject_cullMaterial(iron__object__MeshObject r0,String r1) {
	String r7, r8;
	hl__types__ArrayObj r2;
	bool r5, r9, r10;
	iron__data__TObj r3;
	vdynamic *r4, *r6;
	r2 = r0->materials;
	r3 = r0->raw;
	if( !r3 ) goto label$f53fdd2_8_13;
	r3 = r0->raw;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->lod_material;
	if( !r4 ) goto label$f53fdd2_8_13;
	r3 = r0->raw;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->lod_material;
	r5 = true;
	r6 = hl_alloc_dynbool(r5);
	if( r4 == r6 || (r4 && r6 && (r4->v.b == r6->v.b)) ) goto label$f53fdd2_8_17;
	label$f53fdd2_8_13:
	r5 = iron_object_MeshObject_validContext(r0,r2,r1);
	if( r5 ) goto label$f53fdd2_8_17;
	r5 = true;
	return r5;
	label$f53fdd2_8_17:
	r8 = (String)s$shadowmap;
	if( r1 == r8 || (r1 && r8 && String___compare(r1,(vdynamic*)r8) == 0) ) goto label$f53fdd2_8_21;
	r5 = false;
	goto label$f53fdd2_8_22;
	label$f53fdd2_8_21:
	r5 = true;
	label$f53fdd2_8_22:
	r9 = r0->visibleMesh;
	if( r9 ) goto label$f53fdd2_8_28;
	if( r5 ) goto label$f53fdd2_8_28;
	r10 = true;
	r9 = iron_object_MeshObject_setCulled(r0,r5,r10);
	return r9;
	label$f53fdd2_8_28:
	r9 = r0->visibleShadow;
	if( r9 ) goto label$f53fdd2_8_34;
	if( !r5 ) goto label$f53fdd2_8_34;
	r10 = true;
	r9 = iron_object_MeshObject_setCulled(r0,r5,r10);
	return r9;
	label$f53fdd2_8_34:
	r7 = r0->skip_context;
	if( r7 != r1 && (!r7 || !r1 || String___compare(r7,(vdynamic*)r1) != 0) ) goto label$f53fdd2_8_39;
	r10 = true;
	r9 = iron_object_MeshObject_setCulled(r0,r5,r10);
	return r9;
	label$f53fdd2_8_39:
	r7 = r0->force_context;
	if( !r7 ) goto label$f53fdd2_8_46;
	r7 = r0->force_context;
	if( r7 == r1 || (r7 && r1 && String___compare(r7,(vdynamic*)r1) == 0) ) goto label$f53fdd2_8_46;
	r10 = true;
	r9 = iron_object_MeshObject_setCulled(r0,r5,r10);
	return r9;
	label$f53fdd2_8_46:
	r8 = (String)s$voxel;
	if( r1 != r8 && (!r1 || !r8 || String___compare(r1,(vdynamic*)r8) != 0) ) goto label$f53fdd2_8_59;
	r3 = r0->raw;
	if( !r3 ) goto label$f53fdd2_8_59;
	r3 = r0->raw;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->mobile;
	r9 = true;
	r6 = hl_alloc_dynbool(r9);
	if( r4 != r6 && (!r4 || !r6 || (r4->v.b != r6->v.b)) ) goto label$f53fdd2_8_59;
	r10 = true;
	r9 = iron_object_MeshObject_setCulled(r0,r5,r10);
	return r9;
	label$f53fdd2_8_59:
	r10 = false;
	r9 = iron_object_MeshObject_setCulled(r0,r5,r10);
	return r9;
}

bool iron_object_MeshObject_cullMesh(iron__object__MeshObject r0,String r1,iron__object__CameraObject r2,iron__object__LightObject r3) {
	iron__data__Geometry r16;
	String r14, r15;
	iron__object__MeshObject r11;
	iron__data__TLightData r18;
	hl__types__ArrayObj r10, r23;
	bool r4, r17, r28;
	iron__data__LightData r19;
	iron__data__TCameraData r6;
	iron__object__Transform r20;
	iron__data__CameraData r7;
	iron__data__MeshData r9;
	float r22;
	double r8, r12, r13;
	double *r24, *r25, *r26, *r27;
	vdynamic *r5, *r21;
	if( r2 ) goto label$f53fdd2_9_3;
	r4 = false;
	return r4;
	label$f53fdd2_9_3:
	if( r2 == NULL ) hl_null_access();
	r7 = r2->data;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->raw;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->frustum_culling;
	r4 = r5 ? r5->v.b : 0;
	if( !r4 ) goto label$f53fdd2_9_91;
	r4 = r0->frustumCulling;
	if( !r4 ) goto label$f53fdd2_9_91;
	r9 = r0->data;
	if( r9 == NULL ) hl_null_access();
	r4 = r9->isSkinned;
	if( !r4 ) goto label$f53fdd2_9_19;
	r8 = 2.;
	goto label$f53fdd2_9_20;
	label$f53fdd2_9_19:
	r8 = 1.;
	label$f53fdd2_9_20:
	r10 = r0->particleSystems;
	if( r10 ) goto label$f53fdd2_9_24;
	r11 = r0->particleOwner;
	if( !r11 ) goto label$f53fdd2_9_27;
	label$f53fdd2_9_24:
	r13 = 1000.;
	r12 = r8 * r13;
	r8 = r12;
	label$f53fdd2_9_27:
	r15 = (String)s$voxel;
	if( r1 != r15 && (!r1 || !r15 || String___compare(r1,(vdynamic*)r15) != 0) ) goto label$f53fdd2_9_32;
	r13 = 100.;
	r12 = r8 * r13;
	r8 = r12;
	label$f53fdd2_9_32:
	r9 = r0->data;
	if( r9 == NULL ) hl_null_access();
	r16 = r9->geom;
	if( r16 == NULL ) hl_null_access();
	r4 = r16->instanced;
	if( !r4 ) goto label$f53fdd2_9_41;
	r13 = 100.;
	r12 = r8 * r13;
	r8 = r12;
	label$f53fdd2_9_41:
	r15 = (String)s$shadowmap;
	if( r1 == r15 || (r1 && r15 && String___compare(r1,(vdynamic*)r15) == 0) ) goto label$f53fdd2_9_45;
	r4 = false;
	goto label$f53fdd2_9_46;
	label$f53fdd2_9_45:
	r4 = true;
	label$f53fdd2_9_46:
	if( !r4 ) goto label$f53fdd2_9_50;
	if( r3 == NULL ) hl_null_access();
	r10 = r3->frustumPlanes;
	goto label$f53fdd2_9_51;
	label$f53fdd2_9_50:
	r10 = r2->frustumPlanes;
	label$f53fdd2_9_51:
	if( !r4 ) goto label$f53fdd2_9_80;
	if( r3 == NULL ) hl_null_access();
	r19 = r3->data;
	if( r19 == NULL ) hl_null_access();
	r18 = r19->raw;
	if( r18 == NULL ) hl_null_access();
	r14 = r18->type;
	r15 = (String)s$sun;
	if( r14 == r15 || (r14 && r15 && String___compare(r14,(vdynamic*)r15) == 0) ) goto label$f53fdd2_9_80;
	r20 = r3->transform;
	if( r20 == NULL ) hl_null_access();
	r19 = r3->data;
	if( r19 == NULL ) hl_null_access();
	r18 = r19->raw;
	if( r18 == NULL ) hl_null_access();
	r21 = r18->far_plane;
	r22 = r21 ? r21->v.f : 0;
	r20->radius = r22;
	r23 = r2->frustumPlanes;
	r20 = r3->transform;
	r24 = NULL;
	r25 = NULL;
	r26 = NULL;
	r27 = NULL;
	r17 = iron_object_CameraObject_sphereInFrustum(r23,r20,r24,r25,r26,r27);
	if( r17 ) goto label$f53fdd2_9_80;
	r28 = true;
	r17 = iron_object_MeshObject_setCulled(r0,r4,r28);
	return r17;
	label$f53fdd2_9_80:
	r20 = r0->transform;
	r12 = r8;
	r24 = &r12;
	r25 = NULL;
	r26 = NULL;
	r27 = NULL;
	r17 = iron_object_CameraObject_sphereInFrustum(r10,r20,r24,r25,r26,r27);
	if( r17 ) goto label$f53fdd2_9_91;
	r28 = true;
	r17 = iron_object_MeshObject_setCulled(r0,r4,r28);
	return r17;
	label$f53fdd2_9_91:
	r4 = false;
	r0->culled = r4;
	r4 = r0->culled;
	return r4;
}

bool iron_object_MeshObject_skipContext(iron__object__MeshObject r0,String r1,iron__data__MaterialData r2) {
	String r3;
	bool r5;
	iron__data__TMaterialData r4;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->raw;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->skip_context;
	if( !r3 ) goto label$f53fdd2_10_11;
	r4 = r2->raw;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->skip_context;
	if( r3 != r1 && (!r3 || !r1 || String___compare(r3,(vdynamic*)r1) != 0) ) goto label$f53fdd2_10_11;
	r5 = true;
	return r5;
	label$f53fdd2_10_11:
	r5 = false;
	return r5;
}

void iron_object_MeshObject_getContexts(iron__object__MeshObject r0,String r1,hl__types__ArrayObj r2,hl__types__ArrayObj r3,hl__types__ArrayObj r4) {
	String r17;
	iron__data__ShaderContext r23;
	hl__types__ArrayObj r9, r21;
	iron__data__MaterialContext r22;
	bool r13, r25;
	iron__data__TMaterialContext r19;
	iron__data__MaterialData r10;
	iron__data__TMaterialData r14;
	iron__data__ShaderData r24;
	vdynamic *r11, *r20;
	varray *r12;
	int r5, r7, r8, r15, r16, r18;
	r5 = 0;
	label$f53fdd2_11_1:
	if( r2 == NULL ) hl_null_access();
	r8 = r2->length;
	if( r5 >= r8 ) goto label$f53fdd2_11_74;
	r8 = r2->length;
	if( ((unsigned)r5) < ((unsigned)r8) ) goto label$f53fdd2_11_9;
	r10 = NULL;
	goto label$f53fdd2_11_12;
	label$f53fdd2_11_9:
	r12 = r2->array;
	r11 = ((vdynamic**)(r12 + 1))[r5];
	r10 = (iron__data__MaterialData)r11;
	label$f53fdd2_11_12:
	++r5;
	r13 = false;
	r7 = 0;
	if( r10 == NULL ) hl_null_access();
	r14 = r10->raw;
	if( r14 == NULL ) hl_null_access();
	r9 = r14->contexts;
	if( r9 == NULL ) hl_null_access();
	r8 = r9->length;
	label$f53fdd2_11_21:
	if( r7 >= r8 ) goto label$f53fdd2_11_66;
	r15 = r7;
	++r7;
	if( r10 == NULL ) hl_null_access();
	r14 = r10->raw;
	if( r14 == NULL ) hl_null_access();
	r9 = r14->contexts;
	if( r9 == NULL ) hl_null_access();
	r18 = r9->length;
	if( ((unsigned)r15) < ((unsigned)r18) ) goto label$f53fdd2_11_34;
	r19 = NULL;
	goto label$f53fdd2_11_37;
	label$f53fdd2_11_34:
	r12 = r9->array;
	r11 = ((vdynamic**)(r12 + 1))[r15];
	r19 = (iron__data__TMaterialContext)r11;
	label$f53fdd2_11_37:
	if( r19 == NULL ) hl_null_access();
	r17 = r19->name;
	if( r17 == NULL ) hl_null_access();
	r16 = 0;
	if( r1 == NULL ) hl_null_access();
	r18 = r1->length;
	r20 = hl_alloc_dynamic(&t$_i32);
	r20->v.i = r18;
	r17 = String_substr(r17,r16,r20);
	if( r17 != r1 && (!r17 || !r1 || String___compare(r17,(vdynamic*)r1) != 0) ) goto label$f53fdd2_11_65;
	if( r3 == NULL ) hl_null_access();
	r21 = r10->contexts;
	if( r21 == NULL ) hl_null_access();
	r18 = r21->length;
	if( ((unsigned)r15) < ((unsigned)r18) ) goto label$f53fdd2_11_53;
	r22 = NULL;
	goto label$f53fdd2_11_56;
	label$f53fdd2_11_53:
	r12 = r21->array;
	r11 = ((vdynamic**)(r12 + 1))[r15];
	r22 = (iron__data__MaterialContext)r11;
	label$f53fdd2_11_56:
	r16 = hl_types_ArrayObj_push(r3,((vdynamic*)r22));
	if( r4 == NULL ) hl_null_access();
	r24 = r10->shader;
	if( r24 == NULL ) hl_null_access();
	r23 = iron_data_ShaderData_getContext(r24,r1);
	r16 = hl_types_ArrayObj_push(r4,((vdynamic*)r23));
	r25 = true;
	r13 = r25;
	goto label$f53fdd2_11_66;
	label$f53fdd2_11_65:
	goto label$f53fdd2_11_21;
	label$f53fdd2_11_66:
	if( r13 ) goto label$f53fdd2_11_73;
	if( r3 == NULL ) hl_null_access();
	r22 = NULL;
	r7 = hl_types_ArrayObj_push(r3,((vdynamic*)r22));
	if( r4 == NULL ) hl_null_access();
	r23 = NULL;
	r7 = hl_types_ArrayObj_push(r4,((vdynamic*)r23));
	label$f53fdd2_11_73:
	goto label$f53fdd2_11_1;
	label$f53fdd2_11_74:
	return;
}

void iron_object_MeshObject_render__$1(iron__object__MeshObject r0,iron__object__Object r1) {
	iron__object__MeshObject r3;
	hl__types__ArrayObj r5;
	int r4, r6;
	if( !r1 ) goto label$f53fdd2_12_14;
	r3 = (iron__object__MeshObject)hl_dyn_castp(&r1,&t$iron_object_Object,&t$iron_object_MeshObject);
	if( r0 == NULL ) hl_null_access();
	r5 = r0->particleChildren;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_push(r5,((vdynamic*)r3));
	if( r3 == NULL ) hl_null_access();
	r3->particleOwner = r0;
	r5 = r0->particleChildren;
	if( r5 == NULL ) hl_null_access();
	r4 = r5->length;
	r6 = 1;
	r4 = r4 - r6;
	r3->particleIndex = r4;
	label$f53fdd2_12_14:
	return;
}

void iron_object_MeshObject_render(iron__object__MeshObject r0,vvirtual* r1,String r2,hl__types__ArrayObj r3) {
	bool *r34;
	iron__$RenderPath r16;
	String r10, r18;
	iron__object__MeshObject r4, r21, r47;
	iron__data__ShaderContext r56;
	iron__data__MaterialContext r62;
	iron__data__TShaderContext r58;
	bool r7, r20;
	iron__math__Vec4 r40;
	iron__object__LightObject r14;
	iron__data__MaterialData r57;
	iron__data__TObj r17;
	kha__graphics4__VertexBuffer r63;
	iron__data__TSceneFormat r35;
	iron__data__MeshData r6;
	vclosure *r33;
	int *r65, *r67;
	iron__object__Object r32;
	vdynamic *r9, *r19, *r48, *r51;
	int r25, r26, r27, r36, r37, r55, r66, r68;
	iron__RenderPath r15;
	iron__object__$MeshObject r61;
	iron__data__Geometry r8;
	kha__graphics4__PipelineState r59, r60;
	iron__object__ParticleSystem r29;
	hl__types__ArrayObj r22, r28, r45, r49, r50;
	hl_type *r24;
	iron__data__ParticleData r31;
	iron__$Scene r13;
	iron__Scene r12;
	iron__object__$Uniforms r52;
	iron__data__TLod r46;
	iron__data__TParticleData r30;
	hl__types__ArrayBytes_Int r53;
	iron__object__Transform r38;
	kha__graphics4__IndexBuffer r64;
	float r39, r41;
	double r42, r43, r44;
	iron__object__CameraObject r11;
	vbyte *r54;
	varray *r23;
	r4 = r0;
	r6 = r0->data;
	if( !r6 ) goto label$f53fdd2_13_9;
	r6 = r0->data;
	if( r6 == NULL ) hl_null_access();
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->ready;
	if( r7 ) goto label$f53fdd2_13_10;
	label$f53fdd2_13_9:
	return;
	label$f53fdd2_13_10:
	r7 = r0->visible;
	if( r7 ) goto label$f53fdd2_13_13;
	return;
	label$f53fdd2_13_13:
	r13 = (iron__$Scene)g$_iron_Scene;
	r12 = r13->active;
	if( r12 == NULL ) hl_null_access();
	r11 = r12->camera;
	r16 = (iron__$RenderPath)g$_iron_RenderPath;
	r15 = r16->active;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->light;
	r7 = iron_object_MeshObject_cullMesh(r0,r2,r11,r14);
	if( !r7 ) goto label$f53fdd2_13_24;
	return;
	label$f53fdd2_13_24:
	r17 = r0->raw;
	if( !r17 ) goto label$f53fdd2_13_30;
	r18 = (String)s$mesh;
	if( r2 != r18 && (!r2 || !r18 || String___compare(r2,(vdynamic*)r18) != 0) ) goto label$f53fdd2_13_30;
	r7 = true;
	goto label$f53fdd2_13_31;
	label$f53fdd2_13_30:
	r7 = false;
	label$f53fdd2_13_31:
	r17 = r0->raw;
	if( !r17 ) goto label$f53fdd2_13_41;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r19 = r17->is_particle;
	r20 = r19 ? r19->v.b : 0;
	if( !r20 ) goto label$f53fdd2_13_41;
	r21 = r0->particleOwner;
	if( r21 ) goto label$f53fdd2_13_41;
	return;
	label$f53fdd2_13_41:
	r22 = r0->particleSystems;
	if( !r22 ) goto label$f53fdd2_13_109;
	if( !r7 ) goto label$f53fdd2_13_109;
	r22 = r0->particleChildren;
	if( r22 ) goto label$f53fdd2_13_80;
	r24 = &t$iron_object_MeshObject;
	r25 = 0;
	r23 = hl_alloc_array(r24,r25);
	r22 = hl_types_ArrayObj_alloc(r23);
	r0->particleChildren = r22;
	r25 = 0;
	r22 = r0->particleSystems;
	label$f53fdd2_13_53:
	if( r22 == NULL ) hl_null_access();
	r27 = r22->length;
	if( r25 >= r27 ) goto label$f53fdd2_13_80;
	r27 = r22->length;
	if( ((unsigned)r25) < ((unsigned)r27) ) goto label$f53fdd2_13_61;
	r29 = NULL;
	goto label$f53fdd2_13_64;
	label$f53fdd2_13_61:
	r23 = r22->array;
	r9 = ((vdynamic**)(r23 + 1))[r25];
	r29 = (iron__object__ParticleSystem)r9;
	label$f53fdd2_13_64:
	++r25;
	r13 = (iron__$Scene)g$_iron_Scene;
	r12 = r13->active;
	if( r12 == NULL ) hl_null_access();
	if( r29 == NULL ) hl_null_access();
	r31 = r29->data;
	if( r31 == NULL ) hl_null_access();
	r30 = r31->raw;
	if( r30 == NULL ) hl_null_access();
	r10 = r30->instance_object;
	r32 = NULL;
	r33 = hl_alloc_closure_ptr(&t$fun_c7cc210,iron_object_MeshObject_render__$1,r4);
	r34 = NULL;
	r35 = NULL;
	iron_Scene_spawnObject(r12,r10,r32,r33,r34,r35);
	goto label$f53fdd2_13_53;
	label$f53fdd2_13_80:
	r25 = 0;
	r22 = r0->particleSystems;
	if( r22 == NULL ) hl_null_access();
	r26 = r22->length;
	label$f53fdd2_13_84:
	if( r25 >= r26 ) goto label$f53fdd2_13_109;
	r27 = r25;
	++r25;
	r22 = r0->particleSystems;
	if( r22 == NULL ) hl_null_access();
	r37 = r22->length;
	if( ((unsigned)r27) < ((unsigned)r37) ) goto label$f53fdd2_13_94;
	r29 = NULL;
	goto label$f53fdd2_13_97;
	label$f53fdd2_13_94:
	r23 = r22->array;
	r9 = ((vdynamic**)(r23 + 1))[r27];
	r29 = (iron__object__ParticleSystem)r9;
	label$f53fdd2_13_97:
	if( r29 == NULL ) hl_null_access();
	r22 = r0->particleChildren;
	if( r22 == NULL ) hl_null_access();
	r37 = r22->length;
	if( ((unsigned)r27) < ((unsigned)r37) ) goto label$f53fdd2_13_104;
	r21 = NULL;
	goto label$f53fdd2_13_107;
	label$f53fdd2_13_104:
	r23 = r22->array;
	r9 = ((vdynamic**)(r23 + 1))[r27];
	r21 = (iron__object__MeshObject)r9;
	label$f53fdd2_13_107:
	iron_object_ParticleSystem_update(r29,r21,r0);
	goto label$f53fdd2_13_84;
	label$f53fdd2_13_109:
	r22 = r0->particleSystems;
	if( !r22 ) goto label$f53fdd2_13_121;
	r22 = r0->particleSystems;
	if( r22 == NULL ) hl_null_access();
	r25 = r22->length;
	r26 = 0;
	if( r26 >= r25 ) goto label$f53fdd2_13_121;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r20 = r17->render_emitter;
	if( r20 ) goto label$f53fdd2_13_121;
	return;
	label$f53fdd2_13_121:
	r20 = iron_object_MeshObject_cullMaterial(r0,r2);
	if( !r20 ) goto label$f53fdd2_13_124;
	return;
	label$f53fdd2_13_124:
	r22 = r0->materials;
	r21 = r0;
	r17 = r0->raw;
	if( !r17 ) goto label$f53fdd2_13_285;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r28 = r17->lods;
	if( !r28 ) goto label$f53fdd2_13_285;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r28 = r17->lods;
	if( r28 == NULL ) hl_null_access();
	r25 = r28->length;
	r26 = 0;
	if( r26 >= r25 ) goto label$f53fdd2_13_285;
	r13 = (iron__$Scene)g$_iron_Scene;
	r12 = r13->active;
	if( r12 == NULL ) hl_null_access();
	r11 = r12->camera;
	r38 = r0->transform;
	if( r38 == NULL ) hl_null_access();
	r40 = r38->dim;
	if( r40 == NULL ) hl_null_access();
	r39 = r40->x;
	r40 = r38->dim;
	if( r40 == NULL ) hl_null_access();
	r41 = r40->y;
	r39 = r39 * r41;
	r40 = r38->dim;
	if( r40 == NULL ) hl_null_access();
	r41 = r40->z;
	r39 = r39 * r41;
	r42 = (double)r39;
	r43 = 1.;
	r44 = r0->cameraDistance;
	r43 = r43 / r44;
	r42 = r42 * r43;
	r0->screenSize = r42;
	r42 = r0->screenSize;
	r43 = 1.;
	if( !(r43 < r42) ) goto label$f53fdd2_13_167;
	r42 = 1.;
	goto label$f53fdd2_13_168;
	label$f53fdd2_13_167:
	r42 = r0->screenSize;
	label$f53fdd2_13_168:
	r0->screenSize = r42;
	r28 = r0->lods;
	if( r28 ) goto label$f53fdd2_13_210;
	r24 = &t$iron_object_Object;
	r25 = 0;
	r23 = hl_alloc_array(r24,r25);
	r28 = hl_types_ArrayObj_alloc(r23);
	r0->lods = r28;
	r25 = 0;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r28 = r17->lods;
	label$f53fdd2_13_180:
	if( r28 == NULL ) hl_null_access();
	r27 = r28->length;
	if( r25 >= r27 ) goto label$f53fdd2_13_210;
	r27 = r28->length;
	if( ((unsigned)r25) < ((unsigned)r27) ) goto label$f53fdd2_13_188;
	r46 = NULL;
	goto label$f53fdd2_13_191;
	label$f53fdd2_13_188:
	r23 = r28->array;
	r9 = ((vdynamic**)(r23 + 1))[r25];
	r46 = (iron__data__TLod)r9;
	label$f53fdd2_13_191:
	++r25;
	if( r46 == NULL ) hl_null_access();
	r10 = r46->object_ref;
	r18 = (String)s$;
	if( r10 != r18 && (!r10 || !r18 || String___compare(r10,(vdynamic*)r18) != 0) ) goto label$f53fdd2_13_201;
	r45 = r0->lods;
	if( r45 == NULL ) hl_null_access();
	r32 = NULL;
	r26 = hl_types_ArrayObj_push(r45,((vdynamic*)r32));
	goto label$f53fdd2_13_209;
	label$f53fdd2_13_201:
	r45 = r0->lods;
	if( r45 == NULL ) hl_null_access();
	r13 = (iron__$Scene)g$_iron_Scene;
	r12 = r13->active;
	if( r12 == NULL ) hl_null_access();
	r10 = r46->object_ref;
	r32 = iron_Scene_getChild(r12,r10);
	r26 = hl_types_ArrayObj_push(r45,((vdynamic*)r32));
	label$f53fdd2_13_209:
	goto label$f53fdd2_13_180;
	label$f53fdd2_13_210:
	r18 = (String)s$voxel;
	if( r2 != r18 && (!r2 || !r18 || String___compare(r2,(vdynamic*)r18) != 0) ) goto label$f53fdd2_13_229;
	r28 = r0->lods;
	if( r28 == NULL ) hl_null_access();
	r45 = r0->lods;
	if( r45 == NULL ) hl_null_access();
	r25 = r45->length;
	r26 = 1;
	r25 = r25 - r26;
	r26 = r28->length;
	if( ((unsigned)r25) < ((unsigned)r26) ) goto label$f53fdd2_13_223;
	r32 = NULL;
	goto label$f53fdd2_13_226;
	label$f53fdd2_13_223:
	r23 = r28->array;
	r9 = ((vdynamic**)(r23 + 1))[r25];
	r32 = (iron__object__Object)r9;
	label$f53fdd2_13_226:
	r47 = (iron__object__MeshObject)hl_dyn_castp(&r32,&t$iron_object_Object,&t$iron_object_MeshObject);
	r21 = r47;
	goto label$f53fdd2_13_283;
	label$f53fdd2_13_229:
	r25 = 0;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r28 = r17->lods;
	if( r28 == NULL ) hl_null_access();
	r26 = r28->length;
	label$f53fdd2_13_235:
	if( r25 >= r26 ) goto label$f53fdd2_13_283;
	r27 = r25;
	++r25;
	r42 = r0->screenSize;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r28 = r17->lods;
	if( r28 == NULL ) hl_null_access();
	r37 = r28->length;
	if( ((unsigned)r27) < ((unsigned)r37) ) goto label$f53fdd2_13_248;
	r46 = NULL;
	goto label$f53fdd2_13_251;
	label$f53fdd2_13_248:
	r23 = r28->array;
	r9 = ((vdynamic**)(r23 + 1))[r27];
	r46 = (iron__data__TLod)r9;
	label$f53fdd2_13_251:
	if( r46 == NULL ) hl_null_access();
	r39 = r46->screen_size;
	r43 = (double)r39;
	if( !(r43 < r42) ) goto label$f53fdd2_13_256;
	goto label$f53fdd2_13_283;
	label$f53fdd2_13_256:
	r28 = r0->lods;
	if( r28 == NULL ) hl_null_access();
	r37 = r28->length;
	if( ((unsigned)r27) < ((unsigned)r37) ) goto label$f53fdd2_13_262;
	r32 = NULL;
	goto label$f53fdd2_13_265;
	label$f53fdd2_13_262:
	r23 = r28->array;
	r9 = ((vdynamic**)(r23 + 1))[r27];
	r32 = (iron__object__Object)r9;
	label$f53fdd2_13_265:
	r47 = (iron__object__MeshObject)hl_dyn_castp(&r32,&t$iron_object_Object,&t$iron_object_MeshObject);
	r21 = r47;
	r17 = r0->raw;
	if( !r17 ) goto label$f53fdd2_13_282;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r19 = r17->lod_material;
	if( !r19 ) goto label$f53fdd2_13_282;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r19 = r17->lod_material;
	r20 = true;
	r48 = hl_alloc_dynbool(r20);
	if( r19 != r48 && (!r19 || !r48 || (r19->v.b != r48->v.b)) ) goto label$f53fdd2_13_282;
	if( r47 == NULL ) hl_null_access();
	r28 = r47->materials;
	r22 = r28;
	label$f53fdd2_13_282:
	goto label$f53fdd2_13_235;
	label$f53fdd2_13_283:
	if( r21 ) goto label$f53fdd2_13_285;
	return;
	label$f53fdd2_13_285:
	r17 = r0->raw;
	if( !r17 ) goto label$f53fdd2_13_300;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r19 = r17->lod_material;
	if( !r19 ) goto label$f53fdd2_13_300;
	r17 = r0->raw;
	if( r17 == NULL ) hl_null_access();
	r19 = r17->lod_material;
	r20 = true;
	r48 = hl_alloc_dynbool(r20);
	if( r19 != r48 && (!r19 || !r48 || (r19->v.b != r48->v.b)) ) goto label$f53fdd2_13_300;
	r20 = iron_object_MeshObject_validContext(r0,r22,r2);
	if( r20 ) goto label$f53fdd2_13_300;
	return;
	label$f53fdd2_13_300:
	r24 = &t$iron_data_MaterialContext;
	r25 = 0;
	r23 = hl_alloc_array(r24,r25);
	r28 = hl_types_ArrayObj_alloc(r23);
	r24 = &t$iron_data_ShaderContext;
	r25 = 0;
	r23 = hl_alloc_array(r24,r25);
	r45 = hl_types_ArrayObj_alloc(r23);
	iron_object_MeshObject_getContexts(r0,r2,r22,r28,r45);
	r6 = r0->data;
	if( r6 == NULL ) hl_null_access();
	r39 = r6->scalePos;
	r51 = hl_alloc_dynamic(&t$_f32);
	r51->v.f = r39;
	r52 = (iron__object__$Uniforms)g$_iron_object_Uniforms;
	r52->posUnpack = r51;
	r6 = r0->data;
	if( r6 == NULL ) hl_null_access();
	r39 = r6->scaleTex;
	r51 = hl_alloc_dynamic(&t$_f32);
	r51->v.f = r39;
	r52 = (iron__object__$Uniforms)g$_iron_object_Uniforms;
	r52->texUnpack = r51;
	r38 = r0->transform;
	if( r38 == NULL ) hl_null_access();
	iron_object_Transform_update(r38);
	if( r21 == NULL ) hl_null_access();
	r6 = r21->data;
	r25 = 0;
	if( r6 == NULL ) hl_null_access();
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r49 = r8->indexBuffers;
	if( r49 == NULL ) hl_null_access();
	r26 = r49->length;
	label$f53fdd2_13_333:
	if( r25 >= r26 ) goto label$f53fdd2_13_480;
	r27 = r25;
	++r25;
	if( r6 == NULL ) hl_null_access();
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r53 = r8->materialIndices;
	if( r53 == NULL ) hl_null_access();
	r37 = r53->length;
	if( ((unsigned)r27) < ((unsigned)r37) ) goto label$f53fdd2_13_346;
	r36 = 0;
	goto label$f53fdd2_13_350;
	label$f53fdd2_13_346:
	r54 = r53->bytes;
	r37 = 2;
	r37 = r27 << r37;
	r36 = *(int*)(r54 + r37);
	label$f53fdd2_13_350:
	if( r45 == NULL ) hl_null_access();
	r37 = r45->length;
	if( r36 >= r37 ) goto label$f53fdd2_13_361;
	r55 = r45->length;
	if( ((unsigned)r36) < ((unsigned)r55) ) goto label$f53fdd2_13_357;
	r56 = NULL;
	goto label$f53fdd2_13_360;
	label$f53fdd2_13_357:
	r23 = r45->array;
	r9 = ((vdynamic**)(r23 + 1))[r36];
	r56 = (iron__data__ShaderContext)r9;
	label$f53fdd2_13_360:
	if( r56 ) goto label$f53fdd2_13_362;
	label$f53fdd2_13_361:
	goto label$f53fdd2_13_333;
	label$f53fdd2_13_362:
	r0->materialIndex = r36;
	r49 = r0->materials;
	if( r49 == NULL ) hl_null_access();
	r37 = r49->length;
	if( r36 >= r37 ) goto label$f53fdd2_13_379;
	r49 = r0->materials;
	if( r49 == NULL ) hl_null_access();
	r55 = r49->length;
	if( ((unsigned)r36) < ((unsigned)r55) ) goto label$f53fdd2_13_373;
	r57 = NULL;
	goto label$f53fdd2_13_376;
	label$f53fdd2_13_373:
	r23 = r49->array;
	r9 = ((vdynamic**)(r23 + 1))[r36];
	r57 = (iron__data__MaterialData)r9;
	label$f53fdd2_13_376:
	r20 = iron_object_MeshObject_skipContext(r0,r2,r57);
	if( !r20 ) goto label$f53fdd2_13_379;
	goto label$f53fdd2_13_333;
	label$f53fdd2_13_379:
	r55 = r45->length;
	if( ((unsigned)r36) < ((unsigned)r55) ) goto label$f53fdd2_13_383;
	r56 = NULL;
	goto label$f53fdd2_13_386;
	label$f53fdd2_13_383:
	r23 = r45->array;
	r9 = ((vdynamic**)(r23 + 1))[r36];
	r56 = (iron__data__ShaderContext)r9;
	label$f53fdd2_13_386:
	if( r56 ) goto label$f53fdd2_13_388;
	goto label$f53fdd2_13_333;
	label$f53fdd2_13_388:
	if( r56 == NULL ) hl_null_access();
	r58 = r56->raw;
	if( r58 == NULL ) hl_null_access();
	r49 = r58->vertex_elements;
	r59 = r56->pipeState;
	r61 = (iron__object__$MeshObject)g$_iron_object_MeshObject;
	r60 = r61->lastPipeline;
	if( r59 == r60 ) goto label$f53fdd2_13_402;
	if( r1 == NULL ) hl_null_access();
	r59 = r56->pipeState;
	if( hl_vfields(r1)[8] ) ((void (*)(vdynamic*,kha__graphics4__PipelineState))hl_vfields(r1)[8])(r1->value,r59); else {
		void *args[] = {r59};
		hl_dyn_call_obj(r1->value,&t$fun_c80ec77,467961459/*setPipeline*/,args,NULL);
	}
	r59 = r56->pipeState;
	r61 = (iron__object__$MeshObject)g$_iron_object_MeshObject;
	r61->lastPipeline = r59;
	label$f53fdd2_13_402:
	iron_object_Uniforms_setContextConstants(r1,r56,r3);
	iron_object_Uniforms_setObjectConstants(r1,r56,((iron__object__Object)r0));
	if( r28 == NULL ) hl_null_access();
	r37 = r28->length;
	if( r36 >= r37 ) goto label$f53fdd2_13_415;
	r55 = r28->length;
	if( ((unsigned)r36) < ((unsigned)r55) ) goto label$f53fdd2_13_411;
	r62 = NULL;
	goto label$f53fdd2_13_414;
	label$f53fdd2_13_411:
	r23 = r28->array;
	r9 = ((vdynamic**)(r23 + 1))[r36];
	r62 = (iron__data__MaterialContext)r9;
	label$f53fdd2_13_414:
	iron_object_Uniforms_setMaterialConstants(r1,r56,r62);
	label$f53fdd2_13_415:
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r63 = r8->instancedVB;
	if( !r63 ) goto label$f53fdd2_13_436;
	if( r1 == NULL ) hl_null_access();
	r24 = &t$kha_graphics4_VertexBuffer;
	r37 = 2;
	r23 = hl_alloc_array(r24,r37);
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r63 = iron_data_Geometry_get(r8,r49);
	r37 = 0;
	((kha__graphics4__VertexBuffer*)(r23 + 1))[r37] = r63;
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r63 = r8->instancedVB;
	r37 = 1;
	((kha__graphics4__VertexBuffer*)(r23 + 1))[r37] = r63;
	r50 = hl_types_ArrayObj_alloc(r23);
	if( hl_vfields(r1)[1] ) ((void (*)(vdynamic*,hl__types__ArrayObj))hl_vfields(r1)[1])(r1->value,r50); else {
		void *args[] = {r50};
		hl_dyn_call_obj(r1->value,&t$fun_58e3acc,-466453651/*setVertexBuffers*/,args,NULL);
	}
	goto label$f53fdd2_13_441;
	label$f53fdd2_13_436:
	if( r1 == NULL ) hl_null_access();
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r63 = iron_data_Geometry_get(r8,r49);
	if( hl_vfields(r1)[2] ) ((void (*)(vdynamic*,kha__graphics4__VertexBuffer))hl_vfields(r1)[2])(r1->value,r63); else {
		void *args[] = {r63};
		hl_dyn_call_obj(r1->value,&t$fun_a561c62,-278953801/*setVertexBuffer*/,args,NULL);
	}
	label$f53fdd2_13_441:
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r50 = r8->indexBuffers;
	if( r50 == NULL ) hl_null_access();
	r55 = r50->length;
	if( ((unsigned)r27) < ((unsigned)r55) ) goto label$f53fdd2_13_449;
	r64 = NULL;
	goto label$f53fdd2_13_452;
	label$f53fdd2_13_449:
	r23 = r50->array;
	r9 = ((vdynamic**)(r23 + 1))[r27];
	r64 = (kha__graphics4__IndexBuffer)r9;
	label$f53fdd2_13_452:
	if( hl_vfields(r1)[12] ) ((void (*)(vdynamic*,kha__graphics4__IndexBuffer))hl_vfields(r1)[12])(r1->value,r64); else {
		void *args[] = {r64};
		hl_dyn_call_obj(r1->value,&t$fun_46c6b6e,-43737183/*setIndexBuffer*/,args,NULL);
	}
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r20 = r8->instanced;
	if( !r20 ) goto label$f53fdd2_13_470;
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r37 = r8->instanceCount;
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r55 = r8->start;
	r65 = &r55;
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r66 = r8->count;
	r67 = &r66;
	if( hl_vfields(r1)[25] ) ((void (*)(vdynamic*,int,int*,int*))hl_vfields(r1)[25])(r1->value,r37,r65,r67); else {
		void *args[] = {&r37,r65,r67};
		hl_dyn_call_obj(r1->value,&t$fun_bb34868,219108984/*drawIndexedVerticesInstanced*/,args,NULL);
	}
	goto label$f53fdd2_13_479;
	label$f53fdd2_13_470:
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r37 = r8->start;
	r65 = &r37;
	r8 = r6->geom;
	if( r8 == NULL ) hl_null_access();
	r68 = r8->count;
	r67 = &r68;
	if( hl_vfields(r1)[26] ) ((void (*)(vdynamic*,int*,int*))hl_vfields(r1)[26])(r1->value,r65,r67); else {
		void *args[] = {r65,r67};
		hl_dyn_call_obj(r1->value,&t$fun_8305be0,-519327652/*drawIndexedVertices*/,args,NULL);
	}
	label$f53fdd2_13_479:
	goto label$f53fdd2_13_333;
	label$f53fdd2_13_480:
	return;
}

bool iron_object_MeshObject_validContext(iron__object__MeshObject r0,hl__types__ArrayObj r1,String r2) {
	iron__data__MaterialContext r8;
	bool r9;
	iron__data__MaterialData r5;
	vdynamic *r6;
	varray *r7;
	int r3, r4;
	r3 = 0;
	label$f53fdd2_14_1:
	if( r1 == NULL ) hl_null_access();
	r4 = r1->length;
	if( r3 >= r4 ) goto label$f53fdd2_14_19;
	r4 = r1->length;
	if( ((unsigned)r3) < ((unsigned)r4) ) goto label$f53fdd2_14_9;
	r5 = NULL;
	goto label$f53fdd2_14_12;
	label$f53fdd2_14_9:
	r7 = r1->array;
	r6 = ((vdynamic**)(r7 + 1))[r3];
	r5 = (iron__data__MaterialData)r6;
	label$f53fdd2_14_12:
	++r3;
	if( r5 == NULL ) hl_null_access();
	r8 = iron_data_MaterialData_getContext(r5,r2);
	if( !r8 ) goto label$f53fdd2_14_18;
	r9 = true;
	return r9;
	label$f53fdd2_14_18:
	goto label$f53fdd2_14_1;
	label$f53fdd2_14_19:
	r9 = false;
	return r9;
}

void iron_object_MeshObject_new(iron__object__MeshObject r0,iron__data__MeshData r1,hl__types__ArrayObj r2) {
	String r4;
	iron__object__MeshObject r9;
	hl__types__ArrayObj r10;
	iron__$Scene r14;
	iron__Scene r13;
	bool r6;
	iron__object__MorphTarget r3;
	iron__data__MeshData r11;
	iron__object__Tilesheet r5;
	double r7;
	int r8;
	r3 = NULL;
	r0->morphTarget = r3;
	r4 = NULL;
	r0->force_context = r4;
	r4 = NULL;
	r0->skip_context = r4;
	r5 = NULL;
	r0->tilesheet = r5;
	r6 = true;
	r0->frustumCulling = r6;
	r7 = 0.;
	r0->screenSize = r7;
	r8 = -1;
	r0->particleIndex = r8;
	r9 = NULL;
	r0->particleOwner = r9;
	r10 = NULL;
	r0->particleChildren = r10;
	r10 = NULL;
	r0->particleSystems = r10;
	r8 = 0;
	r0->materialIndex = r8;
	r11 = NULL;
	r0->data = r11;
	iron_object_Object_new(((iron__object__Object)r0));
	r0->materials = r2;
	iron_object_MeshObject_setData(r0,r1);
	r14 = (iron__$Scene)g$_iron_Scene;
	r13 = r14->active;
	if( r13 == NULL ) hl_null_access();
	r10 = r13->meshes;
	if( r10 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_push(r10,((vdynamic*)r0));
	return;
}

