// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <iron/data/Geometry.h>
extern hl_type t$kha_graphics4_VertexStructure;
void kha_graphics4_VertexStructure_new(kha__graphics4__VertexStructure);
int iron_data_Geometry_getVertexData(String);
void kha_graphics4_VertexStructure_add(kha__graphics4__VertexStructure,String,int);
#include <hl/natives.h>
int String___compare(String,vdynamic*);
extern String s$ipos;
extern String s$irot;
extern String s$iscl;
int kha_graphics4_VertexStructure_byteSize(kha__graphics4__VertexStructure);
extern hl_type t$kha_graphics4_VertexBuffer;
void kha_graphics4_VertexBuffer_new(kha__graphics4__VertexBuffer,int,kha__graphics4__VertexStructure,int,int*,bool*);
kha__arrays__ByteArrayPrivate kha_graphics4_VertexBuffer_lock(kha__graphics4__VertexBuffer,vdynamic*,vdynamic*);
void kha_graphics4_VertexBuffer_unlock(kha__graphics4__VertexBuffer,vdynamic*);
extern hl_type t$_i32;
#include <iron/data/TVertexElement.h>
#include <hl/types/ArrayDyn.h>
#include <haxe/Log.h>
extern String s$;
String String___add__(String,String);
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
extern hl_type t$iron_data_TVertexArray;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
extern String s$tex;
extern String s$col;
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);
extern haxe__$Log g$_haxe_Log;
extern String s$Armory_Warning_Geometry_;
extern String s$_is_missing_UV_map;
extern hl_type t$vrt_329ffa8;
extern String s$Sources_iron_data_Geometry_hx;
extern hl_type t$String;
extern String s$iron_data_Geometry;
extern String s$get;
extern hl_type t$vrt_eaa6a3b;
extern String s$_is_missing_vertex_colors;
#include <kha/graphics4/IndexBuffer.h>
#include <iron/data/TMeshData.h>
extern hl_type t$kha_graphics4_IndexBuffer;
void kha_graphics4_IndexBuffer_new(kha__graphics4__IndexBuffer,int,int,bool*);
kha__arrays__ByteArrayPrivate kha_graphics4_IndexBuffer_lock(kha__graphics4__IndexBuffer,vdynamic*,vdynamic*);
void kha_graphics4_IndexBuffer_unlock(kha__graphics4__IndexBuffer,vdynamic*);
#include <iron/data/Armature.h>
extern hl_type t$vrt_7235b40;
extern hl_type t$hl_types_ArrayObj;
void iron_data_Geometry_addAction(iron__data__Geometry,hl__types__ArrayObj,String);
#include <iron/data/TObj.h>
#include <iron/data/TTransform.h>
#include <iron/math/Mat4.h>
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
extern hl_type t$_dyn;
extern hl_type t$iron_data_TObj;
extern hl_type t$iron_math_Mat4;
void iron_math_Mat4_new(iron__math__Mat4,float,float,float,float,float,float,float,float,float,float,float,float,float,float,float,float);
#include <kha/graphics4/VertexElement.h>
extern String s$pos;
extern String s$nor;

kha__graphics4__VertexStructure iron_data_Geometry_getVertexStructure(hl__types__ArrayObj r0) {
	String r7, r12;
	iron__data__TVertexArray r9;
	vdynamic *r10;
	varray *r11;
	int r3, r4, r5, r6, r8;
	kha__graphics4__VertexStructure r1;
	r1 = (kha__graphics4__VertexStructure)hl_alloc_obj(&t$kha_graphics4_VertexStructure);
	kha_graphics4_VertexStructure_new(r1);
	r3 = 0;
	if( r0 == NULL ) hl_null_access();
	r4 = r0->length;
	label$b7ac406_1_5:
	if( r3 >= r4 ) goto label$b7ac406_1_32;
	r5 = r3;
	++r3;
	if( r1 == NULL ) hl_null_access();
	if( r0 == NULL ) hl_null_access();
	r8 = r0->length;
	if( ((unsigned)r5) < ((unsigned)r8) ) goto label$b7ac406_1_15;
	r9 = NULL;
	goto label$b7ac406_1_18;
	label$b7ac406_1_15:
	r11 = r0->array;
	r10 = ((vdynamic**)(r11 + 1))[r5];
	r9 = (iron__data__TVertexArray)r10;
	label$b7ac406_1_18:
	if( r9 == NULL ) hl_null_access();
	r7 = r9->attrib;
	r8 = r0->length;
	if( ((unsigned)r5) < ((unsigned)r8) ) goto label$b7ac406_1_24;
	r9 = NULL;
	goto label$b7ac406_1_27;
	label$b7ac406_1_24:
	r11 = r0->array;
	r10 = ((vdynamic**)(r11 + 1))[r5];
	r9 = (iron__data__TVertexArray)r10;
	label$b7ac406_1_27:
	if( r9 == NULL ) hl_null_access();
	r12 = r9->data;
	r6 = iron_data_Geometry_getVertexData(r12);
	kha_graphics4_VertexStructure_add(r1,r7,r6);
	goto label$b7ac406_1_5;
	label$b7ac406_1_32:
	return r1;
}

int iron_data_Geometry_getVertexData(String r0) {
	vbyte *r3, *r4;
	int r1, r2;
	if( !r0 ) goto label$b7ac406_2_9;
	r1 = r0->length;
	r2 = 10;
	if( r1 != r2 ) goto label$b7ac406_2_9;
	r3 = r0->bytes;
	r4 = (vbyte*)USTR("short2norm");
	r1 = hl_string_compare(r3,r4,r1);
	r2 = 0;
	if( r1 == r2 ) goto label$b7ac406_2_20;
	label$b7ac406_2_9:
	if( !r0 ) goto label$b7ac406_2_18;
	r1 = r0->length;
	r2 = 10;
	if( r1 != r2 ) goto label$b7ac406_2_18;
	r3 = r0->bytes;
	r4 = (vbyte*)USTR("short4norm");
	r1 = hl_string_compare(r3,r4,r1);
	r2 = 0;
	if( r1 == r2 ) goto label$b7ac406_2_22;
	label$b7ac406_2_18:
	r1 = 27;
	return r1;
	label$b7ac406_2_20:
	r1 = 23;
	return r1;
	label$b7ac406_2_22:
	r1 = 27;
	return r1;
}

iron__data__TVertexArray iron_data_Geometry_getVArray(iron__data__Geometry r0,String r1) {
	String r6;
	hl__types__ArrayObj r4;
	iron__data__TVertexArray r8;
	vdynamic *r9;
	varray *r10;
	int r2, r3, r5, r7;
	r2 = 0;
	r4 = r0->vertexArrays;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->length;
	label$b7ac406_3_4:
	if( r2 >= r3 ) goto label$b7ac406_3_31;
	r5 = r2;
	++r2;
	r4 = r0->vertexArrays;
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$b7ac406_3_14;
	r8 = NULL;
	goto label$b7ac406_3_17;
	label$b7ac406_3_14:
	r10 = r4->array;
	r9 = ((vdynamic**)(r10 + 1))[r5];
	r8 = (iron__data__TVertexArray)r9;
	label$b7ac406_3_17:
	if( r8 == NULL ) hl_null_access();
	r6 = r8->attrib;
	if( r6 != r1 && (!r6 || !r1 || String___compare(r6,(vdynamic*)r1) != 0) ) goto label$b7ac406_3_30;
	r4 = r0->vertexArrays;
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$b7ac406_3_26;
	r8 = NULL;
	goto label$b7ac406_3_29;
	label$b7ac406_3_26:
	r10 = r4->array;
	r9 = ((vdynamic**)(r10 + 1))[r5];
	r8 = (iron__data__TVertexArray)r9;
	label$b7ac406_3_29:
	return r8;
	label$b7ac406_3_30:
	goto label$b7ac406_3_4;
	label$b7ac406_3_31:
	r8 = NULL;
	return r8;
}

void iron_data_Geometry_setupInstanced(iron__data__Geometry r0,kha__arrays__ByteArrayPrivate r1,int r2,int r3) {
	bool *r18;
	String r7;
	bool r6;
	kha__graphics4__VertexBuffer r14;
	kha__arrays__ByteArrayPrivate r10;
	float r24;
	double r11, r12, r13, r21;
	vdynamic *r19, *r20;
	int *r17;
	vbyte *r25;
	int r8, r9, r15, r16, r22, r23, r26, r27;
	kha__graphics4__VertexStructure r4;
	r4 = (kha__graphics4__VertexStructure)hl_alloc_obj(&t$kha_graphics4_VertexStructure);
	kha_graphics4_VertexStructure_new(r4);
	r6 = true;
	r4->instanced = r6;
	r6 = true;
	r0->instanced = r6;
	r7 = (String)s$ipos;
	r8 = 2;
	kha_graphics4_VertexStructure_add(r4,r7,r8);
	r9 = 2;
	if( r2 == r9 ) goto label$b7ac406_4_13;
	r9 = 4;
	if( r2 != r9 ) goto label$b7ac406_4_16;
	label$b7ac406_4_13:
	r7 = (String)s$irot;
	r8 = 2;
	kha_graphics4_VertexStructure_add(r4,r7,r8);
	label$b7ac406_4_16:
	r9 = 3;
	if( r2 == r9 ) goto label$b7ac406_4_20;
	r9 = 4;
	if( r2 != r9 ) goto label$b7ac406_4_23;
	label$b7ac406_4_20:
	r7 = (String)s$iscl;
	r8 = 2;
	kha_graphics4_VertexStructure_add(r4,r7,r8);
	label$b7ac406_4_23:
	if( r1 == NULL ) hl_null_access();
	r8 = r1->byteArrayLength;
	r9 = 2;
	r8 = r8 >> r9;
	r9 = kha_graphics4_VertexStructure_byteSize(r4);
	r11 = (double)r9;
	r12 = 4.;
	r11 = r11 / r12;
	r12 = (double)r8;
	r9 = (int)r11;
	r13 = (double)r9;
	r12 = r12 / r13;
	r9 = (int)r12;
	r0->instanceCount = r9;
	r14 = (kha__graphics4__VertexBuffer)hl_alloc_obj(&t$kha_graphics4_VertexBuffer);
	r9 = r0->instanceCount;
	r16 = 1;
	r17 = &r16;
	r18 = NULL;
	kha_graphics4_VertexBuffer_new(r14,r9,r4,r3,r17,r18);
	r0->instancedVB = r14;
	r14 = r0->instancedVB;
	if( r14 == NULL ) hl_null_access();
	r19 = NULL;
	r20 = NULL;
	r10 = kha_graphics4_VertexBuffer_lock(r14,r19,r20);
	r9 = 0;
	if( r10 == NULL ) hl_null_access();
	r15 = r10->byteArrayLength;
	r13 = (double)r15;
	r21 = 4.;
	r13 = r13 / r21;
	r15 = (int)r13;
	label$b7ac406_4_56:
	if( r9 >= r15 ) goto label$b7ac406_4_75;
	r22 = r9;
	++r9;
	if( r1 == NULL ) hl_null_access();
	r25 = r1->self;
	r23 = r1->byteArrayOffset;
	r27 = 4;
	r26 = r22 * r27;
	r23 = r23 + r26;
	r24 = hl_kinc_bytearray_getfloat32(r25,r23);
	if( r10 == NULL ) hl_null_access();
	r25 = r10->self;
	r23 = r10->byteArrayOffset;
	r27 = 4;
	r26 = r22 * r27;
	r23 = r23 + r26;
	hl_kinc_bytearray_setfloat32(r25,r23,r24);
	goto label$b7ac406_4_56;
	label$b7ac406_4_75:
	r14 = r0->instancedVB;
	if( r14 == NULL ) hl_null_access();
	r19 = NULL;
	kha_graphics4_VertexBuffer_unlock(r14,r19);
	return;
}

void iron_data_Geometry_buildVertices(kha__arrays__ByteArrayPrivate r0,hl__types__ArrayObj r1,int* r2,bool* r3,int* r4) {
	bool r6;
	iron__data__TVertexArray r10, r16;
	kha__arrays__ByteArrayPrivate r15;
	double r14, r18;
	vdynamic *r11, *r17, *r27, *r28;
	vbyte *r30;
	varray *r12;
	int r5, r7, r8, r9, r19, r20, r21, r22, r23, r24, r25, r26, r29, r31, r32;
	if( r2 ) goto label$b7ac406_5_3;
	r5 = 0;
	goto label$b7ac406_5_4;
	label$b7ac406_5_3:
	r5 = *r2;
	label$b7ac406_5_4:
	if( r3 ) goto label$b7ac406_5_7;
	r6 = false;
	goto label$b7ac406_5_8;
	label$b7ac406_5_7:
	r6 = *r3;
	label$b7ac406_5_8:
	if( r4 ) goto label$b7ac406_5_11;
	r7 = -1;
	goto label$b7ac406_5_12;
	label$b7ac406_5_11:
	r7 = *r4;
	label$b7ac406_5_12:
	if( r1 == NULL ) hl_null_access();
	r8 = 0;
	r9 = r1->length;
	if( ((unsigned)r8) < ((unsigned)r9) ) goto label$b7ac406_5_18;
	r10 = NULL;
	goto label$b7ac406_5_21;
	label$b7ac406_5_18:
	r12 = r1->array;
	r11 = ((vdynamic**)(r12 + 1))[r8];
	r10 = (iron__data__TVertexArray)r11;
	label$b7ac406_5_21:
	if( r10 == NULL ) hl_null_access();
	r15 = r10->values;
	if( r15 == NULL ) hl_null_access();
	r8 = r15->byteArrayLength;
	r9 = 1;
	r8 = r8 >> r9;
	r14 = (double)r8;
	r17 = r10->size;
	r8 = r17 ? r17->v.i : 0;
	r18 = (double)r8;
	r14 = r14 / r18;
	r8 = (int)r14;
	r9 = -1;
	r9 = r9 + r5;
	r19 = 0;
	r20 = r8;
	label$b7ac406_5_37:
	if( r19 >= r20 ) goto label$b7ac406_5_147;
	r21 = r19;
	++r19;
	r22 = 0;
	if( r1 == NULL ) hl_null_access();
	r23 = r1->length;
	label$b7ac406_5_44:
	if( r22 >= r23 ) goto label$b7ac406_5_146;
	r24 = r22;
	++r22;
	if( r1 == NULL ) hl_null_access();
	r26 = r1->length;
	if( ((unsigned)r24) < ((unsigned)r26) ) goto label$b7ac406_5_53;
	r16 = NULL;
	goto label$b7ac406_5_56;
	label$b7ac406_5_53:
	r12 = r1->array;
	r11 = ((vdynamic**)(r12 + 1))[r24];
	r16 = (iron__data__TVertexArray)r11;
	label$b7ac406_5_56:
	if( r16 == NULL ) hl_null_access();
	r17 = r16->size;
	if( !r6 ) goto label$b7ac406_5_77;
	if( r24 != r7 ) goto label$b7ac406_5_77;
	r25 = 0;
	r27 = r17;
	label$b7ac406_5_62:
	r29 = r27 ? r27->v.i : 0;
	if( r25 >= r29 ) goto label$b7ac406_5_76;
	++r25;
	if( r0 == NULL ) hl_null_access();
	r30 = r0->self;
	r29 = r0->byteArrayOffset;
	++r9;
	r31 = 2;
	r31 = r9 * r31;
	r29 = r29 + r31;
	r31 = 0;
	hl_kinc_bytearray_setint16(r30,r29,r31);
	goto label$b7ac406_5_62;
	label$b7ac406_5_76:
	goto label$b7ac406_5_44;
	label$b7ac406_5_77:
	r25 = 0;
	r27 = r17;
	label$b7ac406_5_79:
	r29 = r27 ? r27->v.i : 0;
	if( r25 >= r29 ) goto label$b7ac406_5_113;
	r26 = r25;
	++r25;
	if( r1 == NULL ) hl_null_access();
	r31 = r1->length;
	if( ((unsigned)r24) < ((unsigned)r31) ) goto label$b7ac406_5_89;
	r16 = NULL;
	goto label$b7ac406_5_92;
	label$b7ac406_5_89:
	r12 = r1->array;
	r11 = ((vdynamic**)(r12 + 1))[r24];
	r16 = (iron__data__TVertexArray)r11;
	label$b7ac406_5_92:
	if( r16 == NULL ) hl_null_access();
	r15 = r16->values;
	if( r15 == NULL ) hl_null_access();
	r30 = r15->self;
	r29 = r15->byteArrayOffset;
	r32 = r17 ? r17->v.i : 0;
	r31 = r21 * r32;
	r31 = r31 + r26;
	r32 = 2;
	r31 = r31 * r32;
	r29 = r29 + r31;
	r29 = hl_kinc_bytearray_getint16(r30,r29);
	if( r0 == NULL ) hl_null_access();
	r30 = r0->self;
	r31 = r0->byteArrayOffset;
	++r9;
	r32 = 2;
	r32 = r9 * r32;
	r31 = r31 + r32;
	hl_kinc_bytearray_setint16(r30,r31,r29);
	goto label$b7ac406_5_79;
	label$b7ac406_5_113:
	if( r1 == NULL ) hl_null_access();
	r26 = r1->length;
	if( ((unsigned)r24) < ((unsigned)r26) ) goto label$b7ac406_5_118;
	r16 = NULL;
	goto label$b7ac406_5_121;
	label$b7ac406_5_118:
	r12 = r1->array;
	r11 = ((vdynamic**)(r12 + 1))[r24];
	r16 = (iron__data__TVertexArray)r11;
	label$b7ac406_5_121:
	if( r16 == NULL ) hl_null_access();
	r27 = r16->padding;
	if( !r27 ) goto label$b7ac406_5_145;
	r26 = r1->length;
	if( ((unsigned)r24) < ((unsigned)r26) ) goto label$b7ac406_5_128;
	r16 = NULL;
	goto label$b7ac406_5_131;
	label$b7ac406_5_128:
	r12 = r1->array;
	r11 = ((vdynamic**)(r12 + 1))[r24];
	r16 = (iron__data__TVertexArray)r11;
	label$b7ac406_5_131:
	if( r16 == NULL ) hl_null_access();
	r27 = r16->padding;
	r25 = 1;
	r28 = hl_alloc_dynamic(&t$_i32);
	r28->v.i = r25;
	if( r27 != r28 && (!r27 || !r28 || (r27->v.i != r28->v.i)) ) goto label$b7ac406_5_145;
	if( r0 == NULL ) hl_null_access();
	r30 = r0->self;
	r25 = r0->byteArrayOffset;
	++r9;
	r26 = 2;
	r26 = r9 * r26;
	r25 = r25 + r26;
	r26 = 0;
	hl_kinc_bytearray_setint16(r30,r25,r26);
	label$b7ac406_5_145:
	goto label$b7ac406_5_44;
	label$b7ac406_5_146:
	goto label$b7ac406_5_37;
	label$b7ac406_5_147:
	return;
}

kha__graphics4__VertexBuffer iron_data_Geometry_get(iron__data__Geometry r0,hl__types__ArrayObj r1) {
	bool *r35;
	String r2, r11, r12;
	vvirtual *r40, *r41;
	haxe__ds__StringMap r13;
	hl__types__ArrayObj r7, r19, r28;
	hl_type *r16;
	bool r17, r18, r23;
	haxe__$Log r39;
	iron__data__TVertexArray r27;
	kha__graphics4__VertexBuffer r14, r15;
	kha__arrays__ByteArrayPrivate r31;
	vclosure *r38;
	double r30, r33;
	iron__data__TVertexElement r8;
	int *r34, *r37;
	vdynamic *r9, *r32, *r36;
	kha__graphics4__VertexStructure r29;
	varray *r10;
	int r4, r5, r6, r20, r21, r22, r24, r25, r26;
	r2 = (String)s$;
	r4 = 0;
	label$b7ac406_6_2:
	if( r1 == NULL ) hl_null_access();
	r6 = r1->length;
	if( r4 >= r6 ) goto label$b7ac406_6_19;
	r6 = r1->length;
	if( ((unsigned)r4) < ((unsigned)r6) ) goto label$b7ac406_6_10;
	r8 = NULL;
	goto label$b7ac406_6_13;
	label$b7ac406_6_10:
	r10 = r1->array;
	r9 = ((vdynamic**)(r10 + 1))[r4];
	r8 = (iron__data__TVertexElement)r9;
	label$b7ac406_6_13:
	++r4;
	if( r8 == NULL ) hl_null_access();
	r12 = r8->name;
	r11 = String___add__(r2,r12);
	r2 = r11;
	goto label$b7ac406_6_2;
	label$b7ac406_6_19:
	r13 = r0->vertexBufferMap;
	if( r13 == NULL ) hl_null_access();
	r9 = haxe_ds_StringMap_get(r13,r2);
	r14 = (kha__graphics4__VertexBuffer)r9;
	if( r14 ) goto label$b7ac406_6_196;
	r16 = &t$iron_data_TVertexArray;
	r4 = 0;
	r10 = hl_alloc_array(r16,r4);
	r7 = hl_types_ArrayObj_alloc(r10);
	r17 = false;
	r4 = -1;
	r18 = false;
	r5 = 0;
	r6 = r1->length;
	label$b7ac406_6_33:
	if( r5 >= r6 ) goto label$b7ac406_6_108;
	r20 = r5;
	++r5;
	if( r1 == NULL ) hl_null_access();
	r22 = r1->length;
	if( ((unsigned)r20) < ((unsigned)r22) ) goto label$b7ac406_6_42;
	r8 = NULL;
	goto label$b7ac406_6_45;
	label$b7ac406_6_42:
	r10 = r1->array;
	r9 = ((vdynamic**)(r10 + 1))[r20];
	r8 = (iron__data__TVertexElement)r9;
	label$b7ac406_6_45:
	if( r8 == NULL ) hl_null_access();
	r11 = r8->name;
	r12 = (String)s$tex;
	if( r11 != r12 && (!r11 || !r12 || String___compare(r11,(vdynamic*)r12) != 0) ) goto label$b7ac406_6_52;
	r23 = true;
	r17 = r23;
	r4 = r20;
	label$b7ac406_6_52:
	r22 = r1->length;
	if( ((unsigned)r20) < ((unsigned)r22) ) goto label$b7ac406_6_56;
	r8 = NULL;
	goto label$b7ac406_6_59;
	label$b7ac406_6_56:
	r10 = r1->array;
	r9 = ((vdynamic**)(r10 + 1))[r20];
	r8 = (iron__data__TVertexElement)r9;
	label$b7ac406_6_59:
	if( r8 == NULL ) hl_null_access();
	r11 = r8->name;
	r12 = (String)s$col;
	if( r11 != r12 && (!r11 || !r12 || String___compare(r11,(vdynamic*)r12) != 0) ) goto label$b7ac406_6_65;
	r23 = true;
	r18 = r23;
	label$b7ac406_6_65:
	r21 = 0;
	r19 = r0->vertexArrays;
	if( r19 == NULL ) hl_null_access();
	r22 = r19->length;
	label$b7ac406_6_69:
	if( r21 >= r22 ) goto label$b7ac406_6_107;
	r24 = r21;
	++r21;
	if( r1 == NULL ) hl_null_access();
	r26 = r1->length;
	if( ((unsigned)r20) < ((unsigned)r26) ) goto label$b7ac406_6_78;
	r8 = NULL;
	goto label$b7ac406_6_81;
	label$b7ac406_6_78:
	r10 = r1->array;
	r9 = ((vdynamic**)(r10 + 1))[r20];
	r8 = (iron__data__TVertexElement)r9;
	label$b7ac406_6_81:
	if( r8 == NULL ) hl_null_access();
	r11 = r8->name;
	r19 = r0->vertexArrays;
	if( r19 == NULL ) hl_null_access();
	r26 = r19->length;
	if( ((unsigned)r24) < ((unsigned)r26) ) goto label$b7ac406_6_89;
	r27 = NULL;
	goto label$b7ac406_6_92;
	label$b7ac406_6_89:
	r10 = r19->array;
	r9 = ((vdynamic**)(r10 + 1))[r24];
	r27 = (iron__data__TVertexArray)r9;
	label$b7ac406_6_92:
	if( r27 == NULL ) hl_null_access();
	r12 = r27->attrib;
	if( r11 != r12 && (!r11 || !r12 || String___compare(r11,(vdynamic*)r12) != 0) ) goto label$b7ac406_6_106;
	if( r7 == NULL ) hl_null_access();
	r28 = r0->vertexArrays;
	if( r28 == NULL ) hl_null_access();
	r26 = r28->length;
	if( ((unsigned)r24) < ((unsigned)r26) ) goto label$b7ac406_6_102;
	r27 = NULL;
	goto label$b7ac406_6_105;
	label$b7ac406_6_102:
	r10 = r28->array;
	r9 = ((vdynamic**)(r10 + 1))[r24];
	r27 = (iron__data__TVertexArray)r9;
	label$b7ac406_6_105:
	r25 = hl_types_ArrayObj_push(r7,((vdynamic*)r27));
	label$b7ac406_6_106:
	goto label$b7ac406_6_69;
	label$b7ac406_6_107:
	goto label$b7ac406_6_33;
	label$b7ac406_6_108:
	r29 = iron_data_Geometry_getVertexStructure(r7);
	r27 = r0->positions;
	if( r27 == NULL ) hl_null_access();
	r31 = r27->values;
	if( r31 == NULL ) hl_null_access();
	r5 = r31->byteArrayLength;
	r6 = 1;
	r5 = r5 >> r6;
	r30 = (double)r5;
	r27 = r0->positions;
	if( r27 == NULL ) hl_null_access();
	r32 = r27->size;
	r5 = r32 ? r32->v.i : 0;
	r33 = (double)r5;
	r30 = r30 / r33;
	r15 = (kha__graphics4__VertexBuffer)hl_alloc_obj(&t$kha_graphics4_VertexBuffer);
	r5 = (int)r30;
	r6 = r0->usage;
	r34 = NULL;
	r35 = NULL;
	kha_graphics4_VertexBuffer_new(r15,r5,r29,r6,r34,r35);
	r14 = r15;
	r32 = NULL;
	r36 = NULL;
	r31 = kha_graphics4_VertexBuffer_lock(r15,r32,r36);
	r0->vertices = r31;
	r31 = r0->vertices;
	r5 = 0;
	r34 = &r5;
	if( !r17 ) goto label$b7ac406_6_142;
	r27 = r0->uvs;
	if( r27 ) goto label$b7ac406_6_142;
	r23 = true;
	goto label$b7ac406_6_143;
	label$b7ac406_6_142:
	r23 = false;
	label$b7ac406_6_143:
	r35 = &r23;
	r6 = r4;
	r37 = &r6;
	iron_data_Geometry_buildVertices(r31,r7,r34,r35,r37);
	r32 = NULL;
	kha_graphics4_VertexBuffer_unlock(r15,r32);
	r13 = r0->vertexBufferMap;
	if( r13 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r13,r2,((vdynamic*)r15));
	if( !r17 ) goto label$b7ac406_6_174;
	r27 = r0->uvs;
	if( r27 ) goto label$b7ac406_6_174;
	r39 = (haxe__$Log)g$_haxe_Log;
	r38 = r39->trace;
	if( r38 == NULL ) hl_null_access();
	r11 = (String)s$Armory_Warning_Geometry_;
	r12 = r0->name;
	r11 = String___add__(r11,r12);
	r12 = (String)s$_is_missing_UV_map;
	r11 = String___add__(r11,r12);
	r40 = hl_alloc_virtual(&t$vrt_329ffa8);
	r12 = (String)s$Sources_iron_data_Geometry_hx;
	if( hl_vfields(r40)[1] ) *(String*)(hl_vfields(r40)[1]) = (String)r12; else hl_dyn_setp(r40->value,37969014/*fileName*/,&t$String,r12);
	r20 = 228;
	if( hl_vfields(r40)[2] ) *(int*)(hl_vfields(r40)[2]) = (int)r20; else hl_dyn_seti(r40->value,371360620/*lineNumber*/,&t$_i32,r20);
	r12 = (String)s$iron_data_Geometry;
	if( hl_vfields(r40)[0] ) *(String*)(hl_vfields(r40)[0]) = (String)r12; else hl_dyn_setp(r40->value,-63073762/*className*/,&t$String,r12);
	r12 = (String)s$get;
	if( hl_vfields(r40)[3] ) *(String*)(hl_vfields(r40)[3]) = (String)r12; else hl_dyn_setp(r40->value,302979532/*methodName*/,&t$String,r12);
	r41 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r40);
	r38->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r38->fun)((vdynamic*)r38->value,((vdynamic*)r11),r41) : ((void (*)(vdynamic*,vvirtual*))r38->fun)(((vdynamic*)r11),r41);
	label$b7ac406_6_174:
	if( !r18 ) goto label$b7ac406_6_196;
	r27 = r0->cols;
	if( r27 ) goto label$b7ac406_6_196;
	r39 = (haxe__$Log)g$_haxe_Log;
	r38 = r39->trace;
	if( r38 == NULL ) hl_null_access();
	r11 = (String)s$Armory_Warning_Geometry_;
	r12 = r0->name;
	r11 = String___add__(r11,r12);
	r12 = (String)s$_is_missing_vertex_colors;
	r11 = String___add__(r11,r12);
	r40 = hl_alloc_virtual(&t$vrt_329ffa8);
	r12 = (String)s$Sources_iron_data_Geometry_hx;
	if( hl_vfields(r40)[1] ) *(String*)(hl_vfields(r40)[1]) = (String)r12; else hl_dyn_setp(r40->value,37969014/*fileName*/,&t$String,r12);
	r20 = 229;
	if( hl_vfields(r40)[2] ) *(int*)(hl_vfields(r40)[2]) = (int)r20; else hl_dyn_seti(r40->value,371360620/*lineNumber*/,&t$_i32,r20);
	r12 = (String)s$iron_data_Geometry;
	if( hl_vfields(r40)[0] ) *(String*)(hl_vfields(r40)[0]) = (String)r12; else hl_dyn_setp(r40->value,-63073762/*className*/,&t$String,r12);
	r12 = (String)s$get;
	if( hl_vfields(r40)[3] ) *(String*)(hl_vfields(r40)[3]) = (String)r12; else hl_dyn_setp(r40->value,302979532/*methodName*/,&t$String,r12);
	r41 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r40);
	r38->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r38->fun)((vdynamic*)r38->value,((vdynamic*)r11),r41) : ((void (*)(vdynamic*,vvirtual*))r38->fun)(((vdynamic*)r11),r41);
	label$b7ac406_6_196:
	return r14;
}

void iron_data_Geometry_build(iron__data__Geometry r0) {
	String r19;
	bool *r14;
	haxe__ds__StringMap r18;
	hl__types__ArrayObj r16, r23;
	hl_type *r21;
	int64 r29;
	bool r2;
	kha__graphics4__VertexBuffer r11;
	iron__data__TVertexArray r7;
	kha__graphics4__IndexBuffer r25;
	kha__arrays__ByteArrayPrivate r6, r24;
	iron__data__MeshData r35;
	iron__data__TMeshData r34;
	double r4, r10, r26;
	int *r13, *r17;
	vdynamic *r3, *r9, *r15;
	vbyte *r30;
	varray *r20;
	kha__graphics4__VertexStructure r12;
	int r5, r8, r22, r27, r28, r31, r32, r33;
	r2 = r0->ready;
	if( !r2 ) goto label$b7ac406_7_3;
	return;
	label$b7ac406_7_3:
	r7 = r0->positions;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->values;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->byteArrayLength;
	r8 = 1;
	r5 = r5 >> r8;
	r4 = (double)r5;
	r7 = r0->positions;
	if( r7 == NULL ) hl_null_access();
	r9 = r7->size;
	r5 = r9 ? r9->v.i : 0;
	r10 = (double)r5;
	r4 = r4 / r10;
	r11 = (kha__graphics4__VertexBuffer)hl_alloc_obj(&t$kha_graphics4_VertexBuffer);
	r5 = (int)r4;
	r12 = r0->_struct;
	r8 = r0->usage;
	r13 = NULL;
	r14 = NULL;
	kha_graphics4_VertexBuffer_new(r11,r5,r12,r8,r13,r14);
	r0->vertexBuffer = r11;
	r11 = r0->vertexBuffer;
	if( r11 == NULL ) hl_null_access();
	r9 = NULL;
	r15 = NULL;
	r6 = kha_graphics4_VertexBuffer_lock(r11,r9,r15);
	r0->vertices = r6;
	r6 = r0->vertices;
	r16 = r0->vertexArrays;
	r13 = NULL;
	r14 = NULL;
	r17 = NULL;
	iron_data_Geometry_buildVertices(r6,r16,r13,r14,r17);
	r11 = r0->vertexBuffer;
	if( r11 == NULL ) hl_null_access();
	r9 = NULL;
	kha_graphics4_VertexBuffer_unlock(r11,r9);
	r18 = r0->vertexBufferMap;
	if( r18 == NULL ) hl_null_access();
	r19 = r0->structStr;
	r11 = r0->vertexBuffer;
	haxe_ds_StringMap_set(r18,r19,((vdynamic*)r11));
	r21 = &t$kha_graphics4_IndexBuffer;
	r5 = 0;
	r20 = hl_alloc_array(r21,r5);
	r16 = hl_types_ArrayObj_alloc(r20);
	r0->indexBuffers = r16;
	r5 = 0;
	r16 = r0->indices;
	label$b7ac406_7_53:
	if( r16 == NULL ) hl_null_access();
	r22 = r16->length;
	if( r5 >= r22 ) goto label$b7ac406_7_131;
	r22 = r16->length;
	if( ((unsigned)r5) < ((unsigned)r22) ) goto label$b7ac406_7_61;
	r6 = NULL;
	goto label$b7ac406_7_64;
	label$b7ac406_7_61:
	r20 = r16->array;
	r3 = ((vdynamic**)(r20 + 1))[r5];
	r6 = (kha__arrays__ByteArrayPrivate)r3;
	label$b7ac406_7_64:
	++r5;
	if( r6 == NULL ) hl_null_access();
	r8 = r6->byteArrayLength;
	r22 = 2;
	r8 = r8 >> r22;
	r22 = 0;
	if( r8 != r22 ) goto label$b7ac406_7_72;
	goto label$b7ac406_7_53;
	label$b7ac406_7_72:
	r25 = (kha__graphics4__IndexBuffer)hl_alloc_obj(&t$kha_graphics4_IndexBuffer);
	r8 = r6->byteArrayLength;
	r22 = 2;
	r8 = r8 >> r22;
	r22 = r0->usage;
	r14 = NULL;
	kha_graphics4_IndexBuffer_new(r25,r8,r22,r14);
	r8 = r6->byteArrayLength;
	r22 = 2;
	r8 = r8 >> r22;
	r10 = (double)r8;
	r26 = 3.;
	r10 = r10 / r26;
	r8 = r0->numTris;
	r22 = (int)r10;
	r8 = r8 + r22;
	r0->numTris = r8;
	r9 = NULL;
	r15 = NULL;
	r24 = kha_graphics4_IndexBuffer_lock(r25,r9,r15);
	r8 = 0;
	if( r24 == NULL ) hl_null_access();
	r22 = r24->byteArrayLength;
	r27 = 2;
	r22 = r22 >> r27;
	label$b7ac406_7_97:
	if( r8 >= r22 ) goto label$b7ac406_7_124;
	r27 = r8;
	++r8;
	if( r6 == NULL ) hl_null_access();
	r30 = r6->self;
	r28 = r6->byteArrayOffset;
	r32 = 4;
	r31 = r27 * r32;
	r28 = r28 + r31;
	r29 = hl_kinc_bytearray_getuint32(r30,r28);
	r28 = (int)r29;
	if( r24 == NULL ) hl_null_access();
	r30 = r24->self;
	r31 = r24->byteArrayOffset;
	r33 = 4;
	r32 = r27 * r33;
	r31 = r31 + r32;
	r29 = (int)r28;
	hl_kinc_bytearray_setuint32(r30,r31,r29);
	r30 = r24->self;
	r31 = r24->byteArrayOffset;
	r33 = 4;
	r32 = r27 * r33;
	r31 = r31 + r32;
	r29 = hl_kinc_bytearray_getuint32(r30,r31);
	goto label$b7ac406_7_97;
	label$b7ac406_7_124:
	if( r25 == NULL ) hl_null_access();
	r9 = NULL;
	kha_graphics4_IndexBuffer_unlock(r25,r9);
	r23 = r0->indexBuffers;
	if( r23 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_push(r23,((vdynamic*)r25));
	goto label$b7ac406_7_53;
	label$b7ac406_7_131:
	r35 = r0->data;
	if( r35 == NULL ) hl_null_access();
	r34 = r35->raw;
	if( r34 == NULL ) hl_null_access();
	r6 = r34->instanced_data;
	if( !r6 ) goto label$b7ac406_7_150;
	r35 = r0->data;
	if( r35 == NULL ) hl_null_access();
	r34 = r35->raw;
	if( r34 == NULL ) hl_null_access();
	r6 = r34->instanced_data;
	r35 = r0->data;
	if( r35 == NULL ) hl_null_access();
	r34 = r35->raw;
	if( r34 == NULL ) hl_null_access();
	r9 = r34->instanced_type;
	r5 = r9 ? r9->v.i : 0;
	r8 = r0->usage;
	iron_data_Geometry_setupInstanced(r0,r6,r5,r8);
	label$b7ac406_7_150:
	r2 = true;
	r0->ready = r2;
	return;
}

void iron_data_Geometry_addArmature(iron__data__Geometry r0,iron__data__Armature r1) {
	String r10;
	vvirtual *r7;
	hl__types__ArrayObj r4, r6;
	vdynamic *r8;
	varray *r9;
	int r2, r5;
	r2 = 0;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->actions;
	label$b7ac406_8_3:
	if( r4 == NULL ) hl_null_access();
	r5 = r4->length;
	if( r2 >= r5 ) goto label$b7ac406_8_20;
	r5 = r4->length;
	if( ((unsigned)r2) < ((unsigned)r5) ) goto label$b7ac406_8_11;
	r7 = NULL;
	goto label$b7ac406_8_14;
	label$b7ac406_8_11:
	r9 = r4->array;
	r8 = ((vdynamic**)(r9 + 1))[r2];
	r7 = hl_to_virtual(&t$vrt_7235b40,(vdynamic*)r8);
	label$b7ac406_8_14:
	++r2;
	if( r7 == NULL ) hl_null_access();
	r6 = hl_vfields(r7)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r7)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r7->value,-151562331/*bones*/,&t$hl_types_ArrayObj);
	r10 = hl_vfields(r7)[2] ? (*(String*)(hl_vfields(r7)[2])) : (String)hl_dyn_getp(r7->value,150958933/*name*/,&t$String);
	iron_data_Geometry_addAction(r0,r6,r10);
	goto label$b7ac406_8_3;
	label$b7ac406_8_20:
	return;
}

void iron_data_Geometry_addAction(iron__data__Geometry r0,hl__types__ArrayObj r1,String r2) {
	String r7, r16;
	haxe__ds__StringMap r6;
	hl__types__ArrayObj r4, r11;
	hl_type *r9;
	iron__data__TObj r15;
	iron__data__TTransform r18;
	kha__arrays__ByteArrayPrivate r17;
	float r20, r23, r24, r25, r26, r27, r28, r29, r30, r31, r32, r33, r34, r35, r36, r37;
	iron__math__Mat4 r19;
	vdynamic *r5;
	vbyte *r21;
	int r10, r12, r13, r14, r22;
	varray *r8;
	if( r1 ) goto label$b7ac406_9_2;
	return;
	label$b7ac406_9_2:
	r6 = r0->actions;
	if( r6 ) goto label$b7ac406_9_10;
	r6 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r6);
	r0->actions = r6;
	r6 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r6);
	r0->mats = r6;
	label$b7ac406_9_10:
	r6 = r0->actions;
	if( r6 == NULL ) hl_null_access();
	r5 = haxe_ds_StringMap_get(r6,r2);
	r4 = (hl__types__ArrayObj)hl_dyn_castp(&r5,&t$_dyn,&t$hl_types_ArrayObj);
	if( !r4 ) goto label$b7ac406_9_16;
	return;
	label$b7ac406_9_16:
	r9 = &t$iron_data_TObj;
	r10 = 0;
	r8 = hl_alloc_array(r9,r10);
	r4 = hl_types_ArrayObj_alloc(r8);
	r10 = 0;
	r11 = r0->skeletonBoneRefs;
	label$b7ac406_9_22:
	if( r11 == NULL ) hl_null_access();
	r13 = r11->length;
	if( r10 >= r13 ) goto label$b7ac406_9_54;
	r13 = r11->length;
	if( ((unsigned)r10) < ((unsigned)r13) ) goto label$b7ac406_9_30;
	r7 = NULL;
	goto label$b7ac406_9_33;
	label$b7ac406_9_30:
	r8 = r11->array;
	r5 = ((vdynamic**)(r8 + 1))[r10];
	r7 = (String)r5;
	label$b7ac406_9_33:
	++r10;
	r12 = 0;
	label$b7ac406_9_35:
	if( r1 == NULL ) hl_null_access();
	r14 = r1->length;
	if( r12 >= r14 ) goto label$b7ac406_9_53;
	r14 = r1->length;
	if( ((unsigned)r12) < ((unsigned)r14) ) goto label$b7ac406_9_43;
	r15 = NULL;
	goto label$b7ac406_9_46;
	label$b7ac406_9_43:
	r8 = r1->array;
	r5 = ((vdynamic**)(r8 + 1))[r12];
	r15 = (iron__data__TObj)r5;
	label$b7ac406_9_46:
	++r12;
	if( r15 == NULL ) hl_null_access();
	r16 = r15->name;
	if( r16 != r7 && (!r16 || !r7 || String___compare(r16,(vdynamic*)r7) != 0) ) goto label$b7ac406_9_52;
	if( r4 == NULL ) hl_null_access();
	r13 = hl_types_ArrayObj_push(r4,((vdynamic*)r15));
	label$b7ac406_9_52:
	goto label$b7ac406_9_35;
	label$b7ac406_9_53:
	goto label$b7ac406_9_22;
	label$b7ac406_9_54:
	r6 = r0->actions;
	if( r6 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r6,r2,((vdynamic*)r4));
	r9 = &t$iron_math_Mat4;
	r10 = 0;
	r8 = hl_alloc_array(r9,r10);
	r11 = hl_types_ArrayObj_alloc(r8);
	r10 = 0;
	label$b7ac406_9_62:
	if( r4 == NULL ) hl_null_access();
	r13 = r4->length;
	if( r10 >= r13 ) goto label$b7ac406_9_211;
	r13 = r4->length;
	if( ((unsigned)r10) < ((unsigned)r13) ) goto label$b7ac406_9_70;
	r15 = NULL;
	goto label$b7ac406_9_73;
	label$b7ac406_9_70:
	r8 = r4->array;
	r5 = ((vdynamic**)(r8 + 1))[r10];
	r15 = (iron__data__TObj)r5;
	label$b7ac406_9_73:
	++r10;
	if( r15 == NULL ) hl_null_access();
	r18 = r15->transform;
	if( r18 == NULL ) hl_null_access();
	r17 = r18->values;
	r12 = 0;
	if( r11 == NULL ) hl_null_access();
	r19 = (iron__math__Mat4)hl_alloc_obj(&t$iron_math_Mat4);
	if( r17 == NULL ) hl_null_access();
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r22 = 4;
	r14 = r12 * r22;
	r13 = r13 + r14;
	r20 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 1;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r23 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 2;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r24 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 3;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r25 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 4;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r26 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 5;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r27 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 6;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r28 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 7;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r29 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 8;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r30 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 9;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r31 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 10;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r32 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 11;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r33 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 12;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r34 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 13;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r35 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 14;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r36 = hl_kinc_bytearray_getfloat32(r21,r13);
	r21 = r17->self;
	r13 = r17->byteArrayOffset;
	r14 = 15;
	r14 = r14 + r12;
	r22 = 4;
	r14 = r14 * r22;
	r13 = r13 + r14;
	r37 = hl_kinc_bytearray_getfloat32(r21,r13);
	iron_math_Mat4_new(r19,r20,r23,r24,r25,r26,r27,r28,r29,r30,r31,r32,r33,r34,r35,r36,r37);
	r13 = hl_types_ArrayObj_push(r11,((vdynamic*)r19));
	goto label$b7ac406_9_62;
	label$b7ac406_9_211:
	r6 = r0->mats;
	if( r6 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r6,r2,((vdynamic*)r11));
	return;
}

void iron_data_Geometry_initSkeletonTransforms(iron__data__Geometry r0,hl__types__ArrayObj r1) {
	hl__types__ArrayObj r2;
	hl_type *r4;
	kha__arrays__ByteArrayPrivate r9;
	float r12, r16, r17, r18, r19, r20, r21, r22, r23, r24, r25, r26, r27, r28, r29, r30;
	iron__math__Mat4 r11;
	vdynamic *r10;
	vbyte *r13;
	int r5, r7, r8, r14, r15;
	varray *r3;
	r4 = &t$iron_math_Mat4;
	r5 = 0;
	r3 = hl_alloc_array(r4,r5);
	r2 = hl_types_ArrayObj_alloc(r3);
	r0->skeletonTransformsI = r2;
	r5 = 0;
	label$b7ac406_10_6:
	if( r1 == NULL ) hl_null_access();
	r8 = r1->length;
	if( r5 >= r8 ) goto label$b7ac406_10_152;
	r8 = r1->length;
	if( ((unsigned)r5) < ((unsigned)r8) ) goto label$b7ac406_10_14;
	r9 = NULL;
	goto label$b7ac406_10_17;
	label$b7ac406_10_14:
	r3 = r1->array;
	r10 = ((vdynamic**)(r3 + 1))[r5];
	r9 = (kha__arrays__ByteArrayPrivate)r10;
	label$b7ac406_10_17:
	++r5;
	r7 = 0;
	r11 = (iron__math__Mat4)hl_alloc_obj(&t$iron_math_Mat4);
	if( r9 == NULL ) hl_null_access();
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r15 = 4;
	r14 = r7 * r15;
	r8 = r8 + r14;
	r12 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 1;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r16 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 2;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r17 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 3;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r18 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 4;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r19 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 5;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r20 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 6;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r21 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 7;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r22 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 8;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r23 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 9;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r24 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 10;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r25 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 11;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r26 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 12;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r27 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 13;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r28 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 14;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r29 = hl_kinc_bytearray_getfloat32(r13,r8);
	r13 = r9->self;
	r8 = r9->byteArrayOffset;
	r14 = 15;
	r14 = r14 + r7;
	r15 = 4;
	r14 = r14 * r15;
	r8 = r8 + r14;
	r30 = hl_kinc_bytearray_getfloat32(r13,r8);
	iron_math_Mat4_new(r11,r12,r16,r17,r18,r19,r20,r21,r22,r23,r24,r25,r26,r27,r28,r29,r30);
	r2 = r0->skeletonTransformsI;
	if( r2 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_push(r2,((vdynamic*)r11));
	goto label$b7ac406_10_6;
	label$b7ac406_10_152:
	return;
}

void iron_data_Geometry_new(iron__data__Geometry r0,iron__data__MeshData r1,hl__types__ArrayObj r2,hl__types__ArrayBytes_Int r3,vdynamic* r4) {
	String r11, r23;
	hl__types__ArrayObj r7;
	haxe__ds__StringMap r5;
	bool r9;
	kha__graphics4__VertexElement r20;
	iron__data__TVertexArray r15;
	kha__graphics4__VertexBuffer r10;
	kha__arrays__ByteArrayPrivate r6;
	double r17, r18;
	iron__data__TMeshData r14;
	vdynamic *r13, *r21;
	varray *r22;
	kha__graphics4__VertexStructure r16;
	int r8, r19;
	r5 = NULL;
	r0->mats = r5;
	r5 = NULL;
	r0->actions = r5;
	r6 = NULL;
	r0->skeletonBoneLens = r6;
	r7 = NULL;
	r0->skeletonBoneRefs = r7;
	r7 = NULL;
	r0->skeletonTransformsI = r7;
	r6 = NULL;
	r0->skinBoneWeights = r6;
	r6 = NULL;
	r0->skinBoneIndices = r6;
	r6 = NULL;
	r0->skinBoneCounts = r6;
	r8 = 0;
	r0->instanceCount = r8;
	r9 = false;
	r0->instanced = r9;
	r10 = NULL;
	r0->instancedVB = r10;
	r8 = 0;
	r0->numTris = r8;
	r9 = false;
	r0->ready = r9;
	r11 = (String)s$;
	r0->name = r11;
	r8 = -1;
	r0->count = r8;
	r8 = 0;
	r0->start = r8;
	r5 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r5);
	r0->vertexBufferMap = r5;
	if( r4 ) goto label$b7ac406_11_39;
	r8 = 0;
	r13 = hl_alloc_dynamic(&t$_i32);
	r13->v.i = r8;
	r4 = r13;
	label$b7ac406_11_39:
	r0->indices = r2;
	r0->materialIndices = r3;
	r8 = r4 ? r4->v.i : 0;
	r0->usage = r8;
	if( r1 == NULL ) hl_null_access();
	r14 = r1->raw;
	if( r14 == NULL ) hl_null_access();
	r7 = r14->vertex_arrays;
	r0->vertexArrays = r7;
	r11 = (String)s$pos;
	r15 = iron_data_Geometry_getVArray(r0,r11);
	r0->positions = r15;
	r11 = (String)s$nor;
	r15 = iron_data_Geometry_getVArray(r0,r11);
	r0->normals = r15;
	r11 = (String)s$tex;
	r15 = iron_data_Geometry_getVArray(r0,r11);
	r0->uvs = r15;
	r11 = (String)s$col;
	r15 = iron_data_Geometry_getVArray(r0,r11);
	r0->cols = r15;
	r0->data = r1;
	r7 = r0->vertexArrays;
	r16 = iron_data_Geometry_getVertexStructure(r7);
	r0->_struct = r16;
	r16 = r0->_struct;
	if( r16 == NULL ) hl_null_access();
	r8 = kha_graphics4_VertexStructure_byteSize(r16);
	r17 = (double)r8;
	r18 = 2.;
	r17 = r17 / r18;
	r8 = (int)r17;
	r0->structLength = r8;
	r11 = (String)s$;
	r0->structStr = r11;
	r8 = 0;
	r16 = r0->_struct;
	if( r16 == NULL ) hl_null_access();
	r7 = r16->elements;
	label$b7ac406_11_78:
	if( r7 == NULL ) hl_null_access();
	r19 = r7->length;
	if( r8 >= r19 ) goto label$b7ac406_11_96;
	r19 = r7->length;
	if( ((unsigned)r8) < ((unsigned)r19) ) goto label$b7ac406_11_86;
	r20 = NULL;
	goto label$b7ac406_11_89;
	label$b7ac406_11_86:
	r22 = r7->array;
	r21 = ((vdynamic**)(r22 + 1))[r8];
	r20 = (kha__graphics4__VertexElement)r21;
	label$b7ac406_11_89:
	++r8;
	r11 = r0->structStr;
	if( r20 == NULL ) hl_null_access();
	r23 = r20->name;
	r11 = String___add__(r11,r23);
	r0->structStr = r11;
	goto label$b7ac406_11_78;
	label$b7ac406_11_96:
	return;
}

