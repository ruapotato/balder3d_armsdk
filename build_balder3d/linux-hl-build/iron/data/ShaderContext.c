// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <iron/data/ShaderContext.h>
#include <hl/types/ArrayBytes_Int.h>
#include <kha/graphics4/VertexShader.h>
#include <kha/graphics4/FragmentShader.h>
#include <kha/Shaders.h>
#include <kha/graphics4/GeometryShader.h>
#include <kha/graphics4/TessellationControlShader.h>
#include <kha/graphics4/TessellationEvaluationShader.h>
void kha_graphics4_PipelineState_delete(kha__graphics4__PipelineState);
extern hl_type t$kha_graphics4_PipelineState;
void kha_graphics4_PipelineState_new(kha__graphics4__PipelineState);
extern hl_type t$vrt_b840ca7;
#include <hl/natives.h>
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
extern hl_type t$kha_graphics4_VertexStructure;
void kha_graphics4_VertexStructure_new(kha__graphics4__VertexStructure);
extern String s$ipos;
void kha_graphics4_VertexStructure_add(kha__graphics4__VertexStructure,String,int);
extern String s$irot;
extern String s$iscl;
int iron_data_ShaderContext_getCompareMode(iron__data__ShaderContext,String);
int iron_data_ShaderContext_getCullMode(iron__data__ShaderContext,String);
int iron_data_ShaderContext_getBlendingFactor(iron__data__ShaderContext,String);
int iron_data_ShaderContext_getBlendingOperation(iron__data__ShaderContext,String);
extern hl_type t$_bool;
extern hl_type t$_dyn;
void hl_types_ArrayObj___expand(hl__types__ArrayObj,int);
int iron_data_ShaderContext_getTextureFormat(iron__data__ShaderContext,String);
void hl_types_ArrayBytes_Int___expand(hl__types__ArrayBytes_Int,int);
int String___compare(String,vdynamic*);
kha__graphics4__VertexShader kha_graphics4_VertexShader_fromSource(String);
kha__graphics4__FragmentShader kha_graphics4_FragmentShader_fromSource(String);
void iron_data_ShaderContext_finishCompile(iron__data__ShaderContext,vclosure*);
extern String s$5058f1a;
extern String s$b14a7b8;
String StringTools_replace(String,String,String);
extern kha__$Shaders g$_kha_Shaders;
vdynamic* Reflect_field(vdynamic*,String);
extern hl_type t$kha_graphics4_FragmentShader;
extern hl_type t$kha_graphics4_VertexShader;
extern hl_type t$kha_graphics4_GeometryShader;
extern hl_type t$kha_graphics4_TessellationControlShader;
extern hl_type t$kha_graphics4_TessellationEvaluationShader;
#include <iron/data/TShaderConstant.h>
#include <iron/data/TTextureUnit.h>
void kha_graphics4_PipelineState_compile(kha__graphics4__PipelineState);
void iron_data_ShaderContext_addConstant(iron__data__ShaderContext,iron__data__TShaderConstant);
void iron_data_ShaderContext_addTexture(iron__data__ShaderContext,iron__data__TTextureUnit);
extern String s$float1;
extern String s$float2;
extern String s$float3;
extern String s$float4;
extern String s$short2norm;
extern String s$short4norm;
#include <iron/data/TVertexElement.h>
vvirtual* kha_graphics4_PipelineState_getConstantLocation(kha__graphics4__PipelineState,String);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
vvirtual* kha_graphics4_PipelineState_getTextureUnit(kha__graphics4__PipelineState,String);
#include <kha/graphics4/VertexBuffer.h>
#include <kha/Image.h>
#include <kha/math/FastMatrix3.h>
#include <kha/math/FastMatrix4.h>
#include <kha/graphics4/IndexBuffer.h>
#include <kha/arrays/ByteArrayPrivate.h>
#include <kha/graphics4/CubeMap.h>
#include <iron/data/TBindTexture.h>
extern hl_type t$fun_4ad9aaa;
extern String s$voxel;

void iron_data_ShaderContext_compile(iron__data__ShaderContext r0,vclosure* r1) {
	String r11, r21, r26, r28, r29;
	kha__graphics4__FragmentShader r25;
	kha__graphics4__PipelineState r3;
	hl__types__ArrayObj r4, r15;
	hl_type *r6;
	kha__graphics4__TessellationControlShader r31;
	iron__data__TShaderContext r13;
	bool r12, r23;
	kha__$Shaders r27;
	kha__graphics4__VertexShader r24;
	hl__types__ArrayBytes_Int r19;
	kha__graphics4__TessellationEvaluationShader r32;
	kha__graphics4__GeometryShader r30;
	vdynamic *r18, *r22;
	vbyte *r20;
	kha__graphics4__VertexStructure r9, r10;
	int r7, r8, r14, r16, r17;
	varray *r5;
	r3 = r0->pipeState;
	if( !r3 ) goto label$b94d45c_1_5;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	kha_graphics4_PipelineState_delete(r3);
	label$b94d45c_1_5:
	r3 = (kha__graphics4__PipelineState)hl_alloc_obj(&t$kha_graphics4_PipelineState);
	kha_graphics4_PipelineState_new(r3);
	r0->pipeState = r3;
	r6 = &t$vrt_b840ca7;
	r7 = 0;
	r5 = hl_alloc_array(r6,r7);
	r4 = hl_types_ArrayObj_alloc(r5);
	r0->constants = r4;
	r6 = &t$vrt_b840ca7;
	r7 = 0;
	r5 = hl_alloc_array(r6,r7);
	r4 = hl_types_ArrayObj_alloc(r5);
	r0->textureUnits = r4;
	r7 = r0->instancingType;
	r8 = 0;
	if( r8 >= r7 ) goto label$b94d45c_1_59;
	r9 = (kha__graphics4__VertexStructure)hl_alloc_obj(&t$kha_graphics4_VertexStructure);
	kha_graphics4_VertexStructure_new(r9);
	r11 = (String)s$ipos;
	r7 = 2;
	kha_graphics4_VertexStructure_add(r9,r11,r7);
	r7 = r0->instancingType;
	r8 = 2;
	if( r7 == r8 ) goto label$b94d45c_1_32;
	r7 = r0->instancingType;
	r8 = 4;
	if( r7 != r8 ) goto label$b94d45c_1_35;
	label$b94d45c_1_32:
	r11 = (String)s$irot;
	r7 = 2;
	kha_graphics4_VertexStructure_add(r9,r11,r7);
	label$b94d45c_1_35:
	r7 = r0->instancingType;
	r8 = 3;
	if( r7 == r8 ) goto label$b94d45c_1_41;
	r7 = r0->instancingType;
	r8 = 4;
	if( r7 != r8 ) goto label$b94d45c_1_44;
	label$b94d45c_1_41:
	r11 = (String)s$iscl;
	r7 = 2;
	kha_graphics4_VertexStructure_add(r9,r11,r7);
	label$b94d45c_1_44:
	r12 = true;
	r9->instanced = r12;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r6 = &t$kha_graphics4_VertexStructure;
	r7 = 2;
	r5 = hl_alloc_array(r6,r7);
	r10 = r0->structure;
	r7 = 0;
	((kha__graphics4__VertexStructure*)(r5 + 1))[r7] = r10;
	r7 = 1;
	((kha__graphics4__VertexStructure*)(r5 + 1))[r7] = r9;
	r4 = hl_types_ArrayObj_alloc(r5);
	r3->inputLayout = r4;
	goto label$b94d45c_1_69;
	label$b94d45c_1_59:
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r6 = &t$kha_graphics4_VertexStructure;
	r7 = 1;
	r5 = hl_alloc_array(r6,r7);
	r9 = r0->structure;
	r7 = 0;
	((kha__graphics4__VertexStructure*)(r5 + 1))[r7] = r9;
	r4 = hl_types_ArrayObj_alloc(r5);
	r3->inputLayout = r4;
	label$b94d45c_1_69:
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->depth_write;
	r3->depthWrite = r12;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->compare_mode;
	r7 = iron_data_ShaderContext_getCompareMode(r0,r11);
	r3->depthMode = r7;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->cull_mode;
	r7 = iron_data_ShaderContext_getCullMode(r0,r11);
	r3->cullMode = r7;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->blend_source;
	if( !r11 ) goto label$b94d45c_1_100;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->blend_source;
	r7 = iron_data_ShaderContext_getBlendingFactor(r0,r11);
	r3->blendSource = r7;
	label$b94d45c_1_100:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->blend_destination;
	if( !r11 ) goto label$b94d45c_1_111;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->blend_destination;
	r7 = iron_data_ShaderContext_getBlendingFactor(r0,r11);
	r3->blendDestination = r7;
	label$b94d45c_1_111:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->blend_operation;
	if( !r11 ) goto label$b94d45c_1_122;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->blend_operation;
	r7 = iron_data_ShaderContext_getBlendingOperation(r0,r11);
	r3->blendOperation = r7;
	label$b94d45c_1_122:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->alpha_blend_source;
	if( !r11 ) goto label$b94d45c_1_133;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->alpha_blend_source;
	r7 = iron_data_ShaderContext_getBlendingFactor(r0,r11);
	r3->alphaBlendSource = r7;
	label$b94d45c_1_133:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->alpha_blend_destination;
	if( !r11 ) goto label$b94d45c_1_144;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->alpha_blend_destination;
	r7 = iron_data_ShaderContext_getBlendingFactor(r0,r11);
	r3->alphaBlendDestination = r7;
	label$b94d45c_1_144:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->alpha_blend_operation;
	if( !r11 ) goto label$b94d45c_1_155;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->alpha_blend_operation;
	r7 = iron_data_ShaderContext_getBlendingOperation(r0,r11);
	r3->alphaBlendOperation = r7;
	label$b94d45c_1_155:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_red;
	if( !r4 ) goto label$b94d45c_1_191;
	r7 = 0;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_red;
	if( r4 == NULL ) hl_null_access();
	r8 = r4->length;
	label$b94d45c_1_165:
	if( r7 >= r8 ) goto label$b94d45c_1_191;
	r14 = r7;
	++r7;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->colorWriteMasksRed;
	if( r4 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r15 = r13->color_writes_red;
	if( r15 == NULL ) hl_null_access();
	r17 = r15->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$b94d45c_1_181;
	r12 = false;
	goto label$b94d45c_1_184;
	label$b94d45c_1_181:
	r5 = r15->array;
	r18 = ((vdynamic**)(r5 + 1))[r14];
	r12 = (bool)hl_dyn_casti(&r18,&t$_dyn,&t$_bool);
	label$b94d45c_1_184:
	r16 = r4->length;
	if( ((unsigned)r14) < ((unsigned)r16) ) goto label$b94d45c_1_187;
	hl_types_ArrayObj___expand(r4,r14);
	label$b94d45c_1_187:
	r5 = r4->array;
	r18 = hl_alloc_dynbool(r12);
	((vdynamic**)(r5 + 1))[r14] = r18;
	goto label$b94d45c_1_165;
	label$b94d45c_1_191:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_green;
	if( !r4 ) goto label$b94d45c_1_227;
	r7 = 0;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_green;
	if( r4 == NULL ) hl_null_access();
	r8 = r4->length;
	label$b94d45c_1_201:
	if( r7 >= r8 ) goto label$b94d45c_1_227;
	r14 = r7;
	++r7;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->colorWriteMasksGreen;
	if( r4 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r15 = r13->color_writes_green;
	if( r15 == NULL ) hl_null_access();
	r17 = r15->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$b94d45c_1_217;
	r12 = false;
	goto label$b94d45c_1_220;
	label$b94d45c_1_217:
	r5 = r15->array;
	r18 = ((vdynamic**)(r5 + 1))[r14];
	r12 = (bool)hl_dyn_casti(&r18,&t$_dyn,&t$_bool);
	label$b94d45c_1_220:
	r16 = r4->length;
	if( ((unsigned)r14) < ((unsigned)r16) ) goto label$b94d45c_1_223;
	hl_types_ArrayObj___expand(r4,r14);
	label$b94d45c_1_223:
	r5 = r4->array;
	r18 = hl_alloc_dynbool(r12);
	((vdynamic**)(r5 + 1))[r14] = r18;
	goto label$b94d45c_1_201;
	label$b94d45c_1_227:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_blue;
	if( !r4 ) goto label$b94d45c_1_263;
	r7 = 0;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_blue;
	if( r4 == NULL ) hl_null_access();
	r8 = r4->length;
	label$b94d45c_1_237:
	if( r7 >= r8 ) goto label$b94d45c_1_263;
	r14 = r7;
	++r7;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->colorWriteMasksBlue;
	if( r4 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r15 = r13->color_writes_blue;
	if( r15 == NULL ) hl_null_access();
	r17 = r15->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$b94d45c_1_253;
	r12 = false;
	goto label$b94d45c_1_256;
	label$b94d45c_1_253:
	r5 = r15->array;
	r18 = ((vdynamic**)(r5 + 1))[r14];
	r12 = (bool)hl_dyn_casti(&r18,&t$_dyn,&t$_bool);
	label$b94d45c_1_256:
	r16 = r4->length;
	if( ((unsigned)r14) < ((unsigned)r16) ) goto label$b94d45c_1_259;
	hl_types_ArrayObj___expand(r4,r14);
	label$b94d45c_1_259:
	r5 = r4->array;
	r18 = hl_alloc_dynbool(r12);
	((vdynamic**)(r5 + 1))[r14] = r18;
	goto label$b94d45c_1_237;
	label$b94d45c_1_263:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_alpha;
	if( !r4 ) goto label$b94d45c_1_299;
	r7 = 0;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_writes_alpha;
	if( r4 == NULL ) hl_null_access();
	r8 = r4->length;
	label$b94d45c_1_273:
	if( r7 >= r8 ) goto label$b94d45c_1_299;
	r14 = r7;
	++r7;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->colorWriteMasksAlpha;
	if( r4 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r15 = r13->color_writes_alpha;
	if( r15 == NULL ) hl_null_access();
	r17 = r15->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$b94d45c_1_289;
	r12 = false;
	goto label$b94d45c_1_292;
	label$b94d45c_1_289:
	r5 = r15->array;
	r18 = ((vdynamic**)(r5 + 1))[r14];
	r12 = (bool)hl_dyn_casti(&r18,&t$_dyn,&t$_bool);
	label$b94d45c_1_292:
	r16 = r4->length;
	if( ((unsigned)r14) < ((unsigned)r16) ) goto label$b94d45c_1_295;
	hl_types_ArrayObj___expand(r4,r14);
	label$b94d45c_1_295:
	r5 = r4->array;
	r18 = hl_alloc_dynbool(r12);
	((vdynamic**)(r5 + 1))[r14] = r18;
	goto label$b94d45c_1_273;
	label$b94d45c_1_299:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_attachments;
	if( !r4 ) goto label$b94d45c_1_345;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_attachments;
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	r3->colorAttachmentCount = r7;
	r7 = 0;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_attachments;
	if( r4 == NULL ) hl_null_access();
	r8 = r4->length;
	label$b94d45c_1_317:
	if( r7 >= r8 ) goto label$b94d45c_1_345;
	r14 = r7;
	++r7;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r19 = r3->colorAttachments;
	if( r19 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r4 = r13->color_attachments;
	if( r4 == NULL ) hl_null_access();
	r17 = r4->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$b94d45c_1_333;
	r11 = NULL;
	goto label$b94d45c_1_336;
	label$b94d45c_1_333:
	r5 = r4->array;
	r18 = ((vdynamic**)(r5 + 1))[r14];
	r11 = (String)r18;
	label$b94d45c_1_336:
	r16 = iron_data_ShaderContext_getTextureFormat(r0,r11);
	r17 = r19->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$b94d45c_1_340;
	hl_types_ArrayBytes_Int___expand(r19,r14);
	label$b94d45c_1_340:
	r20 = r19->bytes;
	r17 = 2;
	r17 = r14 << r17;
	*(int*)(r20 + r17) = r16;
	goto label$b94d45c_1_317;
	label$b94d45c_1_345:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->depth_attachment;
	r21 = NULL;
	if( r11 != r21 && (!r11 || !r21 || String___compare(r11,(vdynamic*)r21) != 0) ) goto label$b94d45c_1_352;
	r12 = false;
	goto label$b94d45c_1_353;
	label$b94d45c_1_352:
	r12 = true;
	label$b94d45c_1_353:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r22 = r13->conservative_raster;
	if( !r22 ) goto label$b94d45c_1_364;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r22 = r13->conservative_raster;
	r23 = r22 ? r22->v.b : 0;
	r3->conservativeRasterization = r23;
	label$b94d45c_1_364:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r22 = r13->shader_from_source;
	r23 = r22 ? r22->v.b : 0;
	if( !r23 ) goto label$b94d45c_1_385;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->vertex_shader;
	r24 = kha_graphics4_VertexShader_fromSource(r11);
	r3->vertexShader = r24;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->fragment_shader;
	r25 = kha_graphics4_FragmentShader_fromSource(r11);
	r3->fragmentShader = r25;
	iron_data_ShaderContext_finishCompile(r0,r1);
	goto label$b94d45c_1_458;
	label$b94d45c_1_385:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r11 = r13->fragment_shader;
	r21 = (String)s$5058f1a;
	r26 = (String)s$b14a7b8;
	r11 = StringTools_replace(r11,r21,r26);
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r27 = (kha__$Shaders)g$_kha_Shaders;
	r18 = Reflect_field(((vdynamic*)r27),r11);
	r25 = (kha__graphics4__FragmentShader)hl_dyn_castp(&r18,&t$_dyn,&t$kha_graphics4_FragmentShader);
	r3->fragmentShader = r25;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r21 = r13->vertex_shader;
	r26 = (String)s$5058f1a;
	r28 = (String)s$b14a7b8;
	r21 = StringTools_replace(r21,r26,r28);
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r27 = (kha__$Shaders)g$_kha_Shaders;
	r18 = Reflect_field(((vdynamic*)r27),r21);
	r24 = (kha__graphics4__VertexShader)hl_dyn_castp(&r18,&t$_dyn,&t$kha_graphics4_VertexShader);
	r3->vertexShader = r24;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r26 = r13->geometry_shader;
	if( !r26 ) goto label$b94d45c_1_425;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r26 = r13->geometry_shader;
	r28 = (String)s$5058f1a;
	r29 = (String)s$b14a7b8;
	r26 = StringTools_replace(r26,r28,r29);
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r27 = (kha__$Shaders)g$_kha_Shaders;
	r18 = Reflect_field(((vdynamic*)r27),r26);
	r30 = (kha__graphics4__GeometryShader)hl_dyn_castp(&r18,&t$_dyn,&t$kha_graphics4_GeometryShader);
	r3->geometryShader = r30;
	label$b94d45c_1_425:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r26 = r13->tesscontrol_shader;
	if( !r26 ) goto label$b94d45c_1_441;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r26 = r13->tesscontrol_shader;
	r28 = (String)s$5058f1a;
	r29 = (String)s$b14a7b8;
	r26 = StringTools_replace(r26,r28,r29);
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r27 = (kha__$Shaders)g$_kha_Shaders;
	r18 = Reflect_field(((vdynamic*)r27),r26);
	r31 = (kha__graphics4__TessellationControlShader)hl_dyn_castp(&r18,&t$_dyn,&t$kha_graphics4_TessellationControlShader);
	r3->tessellationControlShader = r31;
	label$b94d45c_1_441:
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r26 = r13->tesseval_shader;
	if( !r26 ) goto label$b94d45c_1_457;
	r13 = r0->raw;
	if( r13 == NULL ) hl_null_access();
	r26 = r13->tesseval_shader;
	r28 = (String)s$5058f1a;
	r29 = (String)s$b14a7b8;
	r26 = StringTools_replace(r26,r28,r29);
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	r27 = (kha__$Shaders)g$_kha_Shaders;
	r18 = Reflect_field(((vdynamic*)r27),r26);
	r32 = (kha__graphics4__TessellationEvaluationShader)hl_dyn_castp(&r18,&t$_dyn,&t$kha_graphics4_TessellationEvaluationShader);
	r3->tessellationEvaluationShader = r32;
	label$b94d45c_1_457:
	iron_data_ShaderContext_finishCompile(r0,r1);
	label$b94d45c_1_458:
	return;
}

void iron_data_ShaderContext_finishCompile(iron__data__ShaderContext r0,vclosure* r1) {
	String r4;
	kha__graphics4__PipelineState r5;
	hl__types__ArrayObj r7;
	iron__data__TShaderContext r8;
	iron__data__TShaderConstant r10;
	iron__data__TTextureUnit r13;
	vdynamic *r11;
	varray *r12;
	int r6, r9;
	iron__data__TShaderOverride r3;
	r3 = r0->overrideContext;
	if( !r3 ) goto label$b94d45c_2_13;
	r3 = r0->overrideContext;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->cull_mode;
	if( !r4 ) goto label$b94d45c_2_13;
	r5 = r0->pipeState;
	if( r5 == NULL ) hl_null_access();
	r3 = r0->overrideContext;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->cull_mode;
	r6 = iron_data_ShaderContext_getCullMode(r0,r4);
	r5->cullMode = r6;
	label$b94d45c_2_13:
	r5 = r0->pipeState;
	if( r5 == NULL ) hl_null_access();
	kha_graphics4_PipelineState_compile(r5);
	r8 = r0->raw;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->constants;
	if( !r7 ) goto label$b94d45c_2_38;
	r6 = 0;
	r8 = r0->raw;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->constants;
	label$b94d45c_2_24:
	if( r7 == NULL ) hl_null_access();
	r9 = r7->length;
	if( r6 >= r9 ) goto label$b94d45c_2_38;
	r9 = r7->length;
	if( ((unsigned)r6) < ((unsigned)r9) ) goto label$b94d45c_2_32;
	r10 = NULL;
	goto label$b94d45c_2_35;
	label$b94d45c_2_32:
	r12 = r7->array;
	r11 = ((vdynamic**)(r12 + 1))[r6];
	r10 = (iron__data__TShaderConstant)r11;
	label$b94d45c_2_35:
	++r6;
	iron_data_ShaderContext_addConstant(r0,r10);
	goto label$b94d45c_2_24;
	label$b94d45c_2_38:
	r8 = r0->raw;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->texture_units;
	if( !r7 ) goto label$b94d45c_2_60;
	r6 = 0;
	r8 = r0->raw;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->texture_units;
	label$b94d45c_2_46:
	if( r7 == NULL ) hl_null_access();
	r9 = r7->length;
	if( r6 >= r9 ) goto label$b94d45c_2_60;
	r9 = r7->length;
	if( ((unsigned)r6) < ((unsigned)r9) ) goto label$b94d45c_2_54;
	r13 = NULL;
	goto label$b94d45c_2_57;
	label$b94d45c_2_54:
	r12 = r7->array;
	r11 = ((vdynamic**)(r12 + 1))[r6];
	r13 = (iron__data__TTextureUnit)r11;
	label$b94d45c_2_57:
	++r6;
	iron_data_ShaderContext_addTexture(r0,r13);
	goto label$b94d45c_2_46;
	label$b94d45c_2_60:
	if( r1 == NULL ) hl_null_access();
	r1->hasValue ? ((void (*)(vdynamic*,iron__data__ShaderContext))r1->fun)((vdynamic*)r1->value,r0) : ((void (*)(iron__data__ShaderContext))r1->fun)(r0);
	return;
}

int iron_data_ShaderContext_parseData(String r0) {
	String r1;
	int r2;
	r1 = (String)s$float1;
	if( r0 != r1 && (!r0 || !r1 || String___compare(r0,(vdynamic*)r1) != 0) ) goto label$b94d45c_3_4;
	r2 = 0;
	return r2;
	label$b94d45c_3_4:
	r1 = (String)s$float2;
	if( r0 != r1 && (!r0 || !r1 || String___compare(r0,(vdynamic*)r1) != 0) ) goto label$b94d45c_3_8;
	r2 = 1;
	return r2;
	label$b94d45c_3_8:
	r1 = (String)s$float3;
	if( r0 != r1 && (!r0 || !r1 || String___compare(r0,(vdynamic*)r1) != 0) ) goto label$b94d45c_3_12;
	r2 = 2;
	return r2;
	label$b94d45c_3_12:
	r1 = (String)s$float4;
	if( r0 != r1 && (!r0 || !r1 || String___compare(r0,(vdynamic*)r1) != 0) ) goto label$b94d45c_3_16;
	r2 = 3;
	return r2;
	label$b94d45c_3_16:
	r1 = (String)s$short2norm;
	if( r0 != r1 && (!r0 || !r1 || String___compare(r0,(vdynamic*)r1) != 0) ) goto label$b94d45c_3_20;
	r2 = 23;
	return r2;
	label$b94d45c_3_20:
	r1 = (String)s$short4norm;
	if( r0 != r1 && (!r0 || !r1 || String___compare(r0,(vdynamic*)r1) != 0) ) goto label$b94d45c_3_24;
	r2 = 27;
	return r2;
	label$b94d45c_3_24:
	r2 = 0;
	return r2;
}

void iron_data_ShaderContext_parseVertexStructure(iron__data__ShaderContext r0) {
	String r14, r15;
	hl__types__ArrayObj r7;
	iron__data__TShaderContext r8;
	bool r3, r4, r5, r16;
	iron__data__TVertexElement r11;
	vdynamic *r12;
	varray *r13;
	int r6, r9, r10;
	kha__graphics4__VertexStructure r1;
	r1 = (kha__graphics4__VertexStructure)hl_alloc_obj(&t$kha_graphics4_VertexStructure);
	kha_graphics4_VertexStructure_new(r1);
	r0->structure = r1;
	r3 = false;
	r4 = false;
	r5 = false;
	r6 = 0;
	r8 = r0->raw;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->vertex_elements;
	label$b94d45c_4_10:
	if( r7 == NULL ) hl_null_access();
	r10 = r7->length;
	if( r6 >= r10 ) goto label$b94d45c_4_48;
	r10 = r7->length;
	if( ((unsigned)r6) < ((unsigned)r10) ) goto label$b94d45c_4_18;
	r11 = NULL;
	goto label$b94d45c_4_21;
	label$b94d45c_4_18:
	r13 = r7->array;
	r12 = ((vdynamic**)(r13 + 1))[r6];
	r11 = (iron__data__TVertexElement)r12;
	label$b94d45c_4_21:
	++r6;
	if( r11 == NULL ) hl_null_access();
	r14 = r11->name;
	r15 = (String)s$ipos;
	if( r14 != r15 && (!r14 || !r15 || String___compare(r14,(vdynamic*)r15) != 0) ) goto label$b94d45c_4_29;
	r16 = true;
	r3 = r16;
	goto label$b94d45c_4_10;
	label$b94d45c_4_29:
	r14 = r11->name;
	r15 = (String)s$irot;
	if( r14 != r15 && (!r14 || !r15 || String___compare(r14,(vdynamic*)r15) != 0) ) goto label$b94d45c_4_35;
	r16 = true;
	r4 = r16;
	goto label$b94d45c_4_10;
	label$b94d45c_4_35:
	r14 = r11->name;
	r15 = (String)s$iscl;
	if( r14 != r15 && (!r14 || !r15 || String___compare(r14,(vdynamic*)r15) != 0) ) goto label$b94d45c_4_41;
	r16 = true;
	r5 = r16;
	goto label$b94d45c_4_10;
	label$b94d45c_4_41:
	r1 = r0->structure;
	if( r1 == NULL ) hl_null_access();
	r14 = r11->name;
	r15 = r11->data;
	r9 = iron_data_ShaderContext_parseData(r15);
	kha_graphics4_VertexStructure_add(r1,r14,r9);
	goto label$b94d45c_4_10;
	label$b94d45c_4_48:
	if( !r3 ) goto label$b94d45c_4_54;
	if( r4 ) goto label$b94d45c_4_54;
	if( r5 ) goto label$b94d45c_4_54;
	r6 = 1;
	r0->instancingType = r6;
	goto label$b94d45c_4_71;
	label$b94d45c_4_54:
	if( !r3 ) goto label$b94d45c_4_60;
	if( !r4 ) goto label$b94d45c_4_60;
	if( r5 ) goto label$b94d45c_4_60;
	r6 = 2;
	r0->instancingType = r6;
	goto label$b94d45c_4_71;
	label$b94d45c_4_60:
	if( !r3 ) goto label$b94d45c_4_66;
	if( r4 ) goto label$b94d45c_4_66;
	if( !r5 ) goto label$b94d45c_4_66;
	r6 = 3;
	r0->instancingType = r6;
	goto label$b94d45c_4_71;
	label$b94d45c_4_66:
	if( !r3 ) goto label$b94d45c_4_71;
	if( !r4 ) goto label$b94d45c_4_71;
	if( !r5 ) goto label$b94d45c_4_71;
	r6 = 4;
	r0->instancingType = r6;
	label$b94d45c_4_71:
	return;
}

int iron_data_ShaderContext_getCompareMode(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_5_9;
	r2 = r1->length;
	r3 = 6;
	if( r2 != r3 ) goto label$b94d45c_5_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("always");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_74;
	label$b94d45c_5_9:
	if( !r1 ) goto label$b94d45c_5_18;
	r2 = r1->length;
	r3 = 5;
	if( r2 != r3 ) goto label$b94d45c_5_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("equal");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_76;
	label$b94d45c_5_18:
	if( !r1 ) goto label$b94d45c_5_27;
	r2 = r1->length;
	r3 = 7;
	if( r2 != r3 ) goto label$b94d45c_5_27;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("greater");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_78;
	label$b94d45c_5_27:
	if( !r1 ) goto label$b94d45c_5_36;
	r2 = r1->length;
	r3 = 13;
	if( r2 != r3 ) goto label$b94d45c_5_36;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("greater_equal");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_80;
	label$b94d45c_5_36:
	if( !r1 ) goto label$b94d45c_5_45;
	r2 = r1->length;
	r3 = 4;
	if( r2 != r3 ) goto label$b94d45c_5_45;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("less");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_82;
	label$b94d45c_5_45:
	if( !r1 ) goto label$b94d45c_5_54;
	r2 = r1->length;
	r3 = 10;
	if( r2 != r3 ) goto label$b94d45c_5_54;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("less_equal");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_84;
	label$b94d45c_5_54:
	if( !r1 ) goto label$b94d45c_5_63;
	r2 = r1->length;
	r3 = 5;
	if( r2 != r3 ) goto label$b94d45c_5_63;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("never");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_86;
	label$b94d45c_5_63:
	if( !r1 ) goto label$b94d45c_5_72;
	r2 = r1->length;
	r3 = 9;
	if( r2 != r3 ) goto label$b94d45c_5_72;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("not_equal");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_5_88;
	label$b94d45c_5_72:
	r2 = 4;
	return r2;
	label$b94d45c_5_74:
	r2 = 0;
	return r2;
	label$b94d45c_5_76:
	r2 = 2;
	return r2;
	label$b94d45c_5_78:
	r2 = 6;
	return r2;
	label$b94d45c_5_80:
	r2 = 7;
	return r2;
	label$b94d45c_5_82:
	r2 = 4;
	return r2;
	label$b94d45c_5_84:
	r2 = 5;
	return r2;
	label$b94d45c_5_86:
	r2 = 1;
	return r2;
	label$b94d45c_5_88:
	r2 = 3;
	return r2;
}

int iron_data_ShaderContext_getCullMode(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_6_9;
	r2 = r1->length;
	r3 = 9;
	if( r2 != r3 ) goto label$b94d45c_6_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("clockwise");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_6_20;
	label$b94d45c_6_9:
	if( !r1 ) goto label$b94d45c_6_18;
	r2 = r1->length;
	r3 = 4;
	if( r2 != r3 ) goto label$b94d45c_6_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("none");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_6_22;
	label$b94d45c_6_18:
	r2 = 1;
	return r2;
	label$b94d45c_6_20:
	r2 = 0;
	return r2;
	label$b94d45c_6_22:
	r2 = 2;
	return r2;
}

int iron_data_ShaderContext_getBlendingOperation(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_7_9;
	r2 = r1->length;
	r3 = 3;
	if( r2 != r3 ) goto label$b94d45c_7_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("add");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_7_47;
	label$b94d45c_7_9:
	if( !r1 ) goto label$b94d45c_7_18;
	r2 = r1->length;
	r3 = 3;
	if( r2 != r3 ) goto label$b94d45c_7_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("max");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_7_49;
	label$b94d45c_7_18:
	if( !r1 ) goto label$b94d45c_7_27;
	r2 = r1->length;
	r3 = 3;
	if( r2 != r3 ) goto label$b94d45c_7_27;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("min");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_7_51;
	label$b94d45c_7_27:
	if( !r1 ) goto label$b94d45c_7_36;
	r2 = r1->length;
	r3 = 16;
	if( r2 != r3 ) goto label$b94d45c_7_36;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("reverse_subtract");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_7_53;
	label$b94d45c_7_36:
	if( !r1 ) goto label$b94d45c_7_45;
	r2 = r1->length;
	r3 = 8;
	if( r2 != r3 ) goto label$b94d45c_7_45;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("subtract");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_7_55;
	label$b94d45c_7_45:
	r2 = 0;
	return r2;
	label$b94d45c_7_47:
	r2 = 0;
	return r2;
	label$b94d45c_7_49:
	r2 = 4;
	return r2;
	label$b94d45c_7_51:
	r2 = 3;
	return r2;
	label$b94d45c_7_53:
	r2 = 2;
	return r2;
	label$b94d45c_7_55:
	r2 = 1;
	return r2;
}

int iron_data_ShaderContext_getBlendingFactor(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_8_9;
	r2 = r1->length;
	r3 = 9;
	if( r2 != r3 ) goto label$b94d45c_8_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("blend_one");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_92;
	label$b94d45c_8_9:
	if( !r1 ) goto label$b94d45c_8_18;
	r2 = r1->length;
	r3 = 10;
	if( r2 != r3 ) goto label$b94d45c_8_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("blend_zero");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_94;
	label$b94d45c_8_18:
	if( !r1 ) goto label$b94d45c_8_27;
	r2 = r1->length;
	r3 = 17;
	if( r2 != r3 ) goto label$b94d45c_8_27;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("destination_alpha");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_96;
	label$b94d45c_8_27:
	if( !r1 ) goto label$b94d45c_8_36;
	r2 = r1->length;
	r3 = 17;
	if( r2 != r3 ) goto label$b94d45c_8_36;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("destination_color");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_98;
	label$b94d45c_8_36:
	if( !r1 ) goto label$b94d45c_8_45;
	r2 = r1->length;
	r3 = 25;
	if( r2 != r3 ) goto label$b94d45c_8_45;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("inverse_destination_alpha");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_100;
	label$b94d45c_8_45:
	if( !r1 ) goto label$b94d45c_8_54;
	r2 = r1->length;
	r3 = 25;
	if( r2 != r3 ) goto label$b94d45c_8_54;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("inverse_destination_color");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_102;
	label$b94d45c_8_54:
	if( !r1 ) goto label$b94d45c_8_63;
	r2 = r1->length;
	r3 = 20;
	if( r2 != r3 ) goto label$b94d45c_8_63;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("inverse_source_alpha");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_104;
	label$b94d45c_8_63:
	if( !r1 ) goto label$b94d45c_8_72;
	r2 = r1->length;
	r3 = 20;
	if( r2 != r3 ) goto label$b94d45c_8_72;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("inverse_source_color");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_106;
	label$b94d45c_8_72:
	if( !r1 ) goto label$b94d45c_8_81;
	r2 = r1->length;
	r3 = 12;
	if( r2 != r3 ) goto label$b94d45c_8_81;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("source_alpha");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_108;
	label$b94d45c_8_81:
	if( !r1 ) goto label$b94d45c_8_90;
	r2 = r1->length;
	r3 = 12;
	if( r2 != r3 ) goto label$b94d45c_8_90;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("source_color");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_8_110;
	label$b94d45c_8_90:
	r2 = 0;
	return r2;
	label$b94d45c_8_92:
	r2 = 1;
	return r2;
	label$b94d45c_8_94:
	r2 = 2;
	return r2;
	label$b94d45c_8_96:
	r2 = 4;
	return r2;
	label$b94d45c_8_98:
	r2 = 8;
	return r2;
	label$b94d45c_8_100:
	r2 = 6;
	return r2;
	label$b94d45c_8_102:
	r2 = 10;
	return r2;
	label$b94d45c_8_104:
	r2 = 5;
	return r2;
	label$b94d45c_8_106:
	r2 = 9;
	return r2;
	label$b94d45c_8_108:
	r2 = 3;
	return r2;
	label$b94d45c_8_110:
	r2 = 7;
	return r2;
}

int iron_data_ShaderContext_getTextureAddresing(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_9_9;
	r2 = r1->length;
	r3 = 6;
	if( r2 != r3 ) goto label$b94d45c_9_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("mirror");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_9_20;
	label$b94d45c_9_9:
	if( !r1 ) goto label$b94d45c_9_18;
	r2 = r1->length;
	r3 = 6;
	if( r2 != r3 ) goto label$b94d45c_9_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("repeat");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_9_22;
	label$b94d45c_9_18:
	r2 = 2;
	return r2;
	label$b94d45c_9_20:
	r2 = 1;
	return r2;
	label$b94d45c_9_22:
	r2 = 0;
	return r2;
}

int iron_data_ShaderContext_getTextureFilter(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_10_9;
	r2 = r1->length;
	r3 = 6;
	if( r2 != r3 ) goto label$b94d45c_10_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("linear");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_10_20;
	label$b94d45c_10_9:
	if( !r1 ) goto label$b94d45c_10_18;
	r2 = r1->length;
	r3 = 5;
	if( r2 != r3 ) goto label$b94d45c_10_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("point");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_10_22;
	label$b94d45c_10_18:
	r2 = 2;
	return r2;
	label$b94d45c_10_20:
	r2 = 1;
	return r2;
	label$b94d45c_10_22:
	r2 = 0;
	return r2;
}

int iron_data_ShaderContext_getMipmapFilter(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_11_9;
	r2 = r1->length;
	r3 = 2;
	if( r2 != r3 ) goto label$b94d45c_11_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("no");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_11_20;
	label$b94d45c_11_9:
	if( !r1 ) goto label$b94d45c_11_18;
	r2 = r1->length;
	r3 = 5;
	if( r2 != r3 ) goto label$b94d45c_11_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("point");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_11_22;
	label$b94d45c_11_18:
	r2 = 2;
	return r2;
	label$b94d45c_11_20:
	r2 = 0;
	return r2;
	label$b94d45c_11_22:
	r2 = 1;
	return r2;
}

int iron_data_ShaderContext_getTextureFormat(iron__data__ShaderContext r0,String r1) {
	vbyte *r4, *r5;
	int r2, r3;
	if( !r1 ) goto label$b94d45c_12_9;
	r2 = r1->length;
	r3 = 7;
	if( r2 != r3 ) goto label$b94d45c_12_9;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("DEPTH16");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_65;
	label$b94d45c_12_9:
	if( !r1 ) goto label$b94d45c_12_18;
	r2 = r1->length;
	r3 = 3;
	if( r2 != r3 ) goto label$b94d45c_12_18;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("R16");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_67;
	label$b94d45c_12_18:
	if( !r1 ) goto label$b94d45c_12_27;
	r2 = r1->length;
	r3 = 3;
	if( r2 != r3 ) goto label$b94d45c_12_27;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("R32");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_69;
	label$b94d45c_12_27:
	if( !r1 ) goto label$b94d45c_12_36;
	r2 = r1->length;
	r3 = 2;
	if( r2 != r3 ) goto label$b94d45c_12_36;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("R8");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_71;
	label$b94d45c_12_36:
	if( !r1 ) goto label$b94d45c_12_45;
	r2 = r1->length;
	r3 = 7;
	if( r2 != r3 ) goto label$b94d45c_12_45;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("RGBA128");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_73;
	label$b94d45c_12_45:
	if( !r1 ) goto label$b94d45c_12_54;
	r2 = r1->length;
	r3 = 6;
	if( r2 != r3 ) goto label$b94d45c_12_54;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("RGBA32");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_75;
	label$b94d45c_12_54:
	if( !r1 ) goto label$b94d45c_12_63;
	r2 = r1->length;
	r3 = 6;
	if( r2 != r3 ) goto label$b94d45c_12_63;
	r4 = r1->bytes;
	r5 = (vbyte*)USTR("RGBA64");
	r2 = hl_string_compare(r4,r5,r2);
	r3 = 0;
	if( r2 == r3 ) goto label$b94d45c_12_77;
	label$b94d45c_12_63:
	r2 = 0;
	return r2;
	label$b94d45c_12_65:
	r2 = 3;
	return r2;
	label$b94d45c_12_67:
	r2 = 6;
	return r2;
	label$b94d45c_12_69:
	r2 = 5;
	return r2;
	label$b94d45c_12_71:
	r2 = 1;
	return r2;
	label$b94d45c_12_73:
	r2 = 2;
	return r2;
	label$b94d45c_12_75:
	r2 = 0;
	return r2;
	label$b94d45c_12_77:
	r2 = 4;
	return r2;
}

void iron_data_ShaderContext_addConstant(iron__data__ShaderContext r0,iron__data__TShaderConstant r1) {
	String r6;
	kha__graphics4__PipelineState r5;
	vvirtual *r4;
	hl__types__ArrayObj r3;
	int r2;
	r3 = r0->constants;
	if( r3 == NULL ) hl_null_access();
	r5 = r0->pipeState;
	if( r5 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r6 = r1->name;
	r4 = kha_graphics4_PipelineState_getConstantLocation(r5,r6);
	r2 = hl_types_ArrayObj_push(r3,((vdynamic*)r4));
	return;
}

void iron_data_ShaderContext_addTexture(iron__data__ShaderContext r0,iron__data__TTextureUnit r1) {
	String r4;
	kha__graphics4__PipelineState r3;
	hl__types__ArrayObj r7;
	vvirtual *r2;
	int r6;
	r3 = r0->pipeState;
	if( r3 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r4 = r1->name;
	r2 = kha_graphics4_PipelineState_getTextureUnit(r3,r4);
	r7 = r0->textureUnits;
	if( r7 == NULL ) hl_null_access();
	r6 = hl_types_ArrayObj_push(r7,((vdynamic*)r2));
	return;
}

void iron_data_ShaderContext_setTextureParameters(iron__data__ShaderContext r0,vvirtual* r1,int r2,iron__data__TBindTexture r3) {
	String r11;
	vvirtual *r7;
	hl__types__ArrayObj r4;
	vdynamic *r8;
	varray *r9;
	int r5, r6, r12, r13, r14;
	r4 = r0->textureUnits;
	if( r4 == NULL ) hl_null_access();
	r6 = r4->length;
	if( ((unsigned)r2) < ((unsigned)r6) ) goto label$b94d45c_15_6;
	r7 = NULL;
	goto label$b94d45c_15_9;
	label$b94d45c_15_6:
	r9 = r4->array;
	r8 = ((vdynamic**)(r9 + 1))[r2];
	r7 = hl_to_virtual(&t$vrt_b840ca7,(vdynamic*)r8);
	label$b94d45c_15_9:
	if( r1 == NULL ) hl_null_access();
	if( r3 == NULL ) hl_null_access();
	r11 = r3->u_addressing;
	if( r11 ) goto label$b94d45c_15_15;
	r5 = 0;
	goto label$b94d45c_15_17;
	label$b94d45c_15_15:
	r11 = r3->u_addressing;
	r5 = iron_data_ShaderContext_getTextureAddresing(r0,r11);
	label$b94d45c_15_17:
	r11 = r3->v_addressing;
	if( r11 ) goto label$b94d45c_15_21;
	r6 = 0;
	goto label$b94d45c_15_23;
	label$b94d45c_15_21:
	r11 = r3->v_addressing;
	r6 = iron_data_ShaderContext_getTextureAddresing(r0,r11);
	label$b94d45c_15_23:
	r11 = r3->min_filter;
	if( r11 ) goto label$b94d45c_15_27;
	r12 = 1;
	goto label$b94d45c_15_29;
	label$b94d45c_15_27:
	r11 = r3->min_filter;
	r12 = iron_data_ShaderContext_getTextureFilter(r0,r11);
	label$b94d45c_15_29:
	r11 = r3->mag_filter;
	if( r11 ) goto label$b94d45c_15_33;
	r13 = 1;
	goto label$b94d45c_15_35;
	label$b94d45c_15_33:
	r11 = r3->mag_filter;
	r13 = iron_data_ShaderContext_getTextureFilter(r0,r11);
	label$b94d45c_15_35:
	r11 = r3->mipmap_filter;
	if( r11 ) goto label$b94d45c_15_39;
	r14 = 0;
	goto label$b94d45c_15_41;
	label$b94d45c_15_39:
	r11 = r3->mipmap_filter;
	r14 = iron_data_ShaderContext_getMipmapFilter(r0,r11);
	label$b94d45c_15_41:
	if( hl_vfields(r1)[3] ) ((void (*)(vdynamic*,vvirtual*,int,int,int,int,int))hl_vfields(r1)[3])(r1->value,r7,r5,r6,r12,r13,r14); else {
		void *args[] = {r7,&r5,&r6,&r12,&r13,&r14};
		hl_dyn_call_obj(r1->value,&t$fun_4ad9aaa,357382632/*setTextureParameters*/,args,NULL);
	}
	return;
}

void iron_data_ShaderContext_new(iron__data__ShaderContext r0,iron__data__TShaderContext r1,vclosure* r2,iron__data__TShaderOverride r3) {
	String r6, r7;
	int r4;
	r4 = 0;
	r0->instancingType = r4;
	r0->raw = r1;
	if( r1 == NULL ) hl_null_access();
	r6 = r1->name;
	r7 = (String)s$voxel;
	if( r6 != r7 && (!r6 || !r7 || String___compare(r6,(vdynamic*)r7) != 0) ) goto label$b94d45c_16_10;
	if( r2 == NULL ) hl_null_access();
	r2->hasValue ? ((void (*)(vdynamic*,iron__data__ShaderContext))r2->fun)((vdynamic*)r2->value,r0) : ((void (*)(iron__data__ShaderContext))r2->fun)(r0);
	return;
	label$b94d45c_16_10:
	r0->overrideContext = r3;
	iron_data_ShaderContext_parseVertexStructure(r0);
	iron_data_ShaderContext_compile(r0,r2);
	return;
}

