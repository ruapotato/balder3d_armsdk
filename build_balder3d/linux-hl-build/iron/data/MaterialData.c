// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <iron/data/MaterialData.h>
#include <iron/data/MaterialContext.h>
void hl_types_ArrayObj___expand(hl__types__ArrayObj,int);
void hl_types_ArrayBytes_Int___expand(hl__types__ArrayBytes_Int,int);
#include <iron/data/TMaterialContext.h>
extern hl_type t$iron_data_MaterialContext;
#include <hl/natives.h>
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
hl__types__ArrayBytes_Int hl_types_ArrayBase_allocI32(vbyte*,int);
extern hl_type t$ctx_955f890;
extern hl_type t$fun_1916425;
void iron_data_MaterialContext_new(iron__data__MaterialContext,iron__data__TMaterialContext,vclosure*);
#include <iron/data/TSceneFormat.h>
#include <hl/types/ArrayDyn.h>
#include <haxe/Log.h>
iron__data__TMaterialData iron_data_Data_getMaterialRawByName(hl__types__ArrayObj,String);
extern haxe__$Log g$_haxe_Log;
extern String s$Material_data_;
String String___add__(String,String);
extern String s$_not_found_;
extern hl_type t$vrt_329ffa8;
extern String s$4c028d1;
extern hl_type t$String;
extern hl_type t$_i32;
extern String s$iron_data_MaterialData;
extern String s$parse;
extern hl_type t$vrt_eaa6a3b;
extern hl_type t$iron_data_MaterialData;
void iron_data_MaterialData_new(iron__data__MaterialData,iron__data__TMaterialData,vclosure*,String);
extern hl_type t$ctx_6e52869;
extern hl_type t$fun_53d0d62;
void iron_data_Data_getSceneRaw(String,vclosure*);
String String_substr(String,int,vdynamic*);
int String___compare(String,vdynamic*);
#include <iron/data/TShaderOverride.h>
extern String s$;
extern iron__data__$MaterialData g$_iron_data_MaterialData;
extern String s$6666cd7;
hl__types__ArrayObj String_split(String,String);
extern hl_type t$ctx_0da146a;
extern hl_type t$fun_73968be;
void iron_data_Data_getShader(String,String,vclosure*,iron__data__TShaderOverride);

void iron_data_MaterialData_new__$2(venum* r0,iron__data__MaterialContext r1) {
	hl__types__ArrayObj r2;
	hl__types__ArrayBytes_Int r8;
	iron__data__MaterialData r3;
	iron__data__TMaterialData r11;
	vclosure *r12;
	vbyte *r9;
	varray *r7;
	int r4, r5, r10;
	r3 = ((Enumt$ctx_955f890*)r0)->p2;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->contexts;
	if( r2 == NULL ) hl_null_access();
	r4 = ((Enumt$ctx_955f890*)r0)->p4;
	r5 = r2->length;
	if( ((unsigned)r4) < ((unsigned)r5) ) goto label$51bd30c_1_8;
	hl_types_ArrayObj___expand(r2,r4);
	label$51bd30c_1_8:
	r7 = r2->array;
	((iron__data__MaterialContext*)(r7 + 1))[r4] = r1;
	r8 = ((Enumt$ctx_955f890*)r0)->p3;
	if( r8 == NULL ) hl_null_access();
	r4 = 0;
	r5 = r8->length;
	if( ((unsigned)r4) < ((unsigned)r5) ) goto label$51bd30c_1_16;
	hl_types_ArrayBytes_Int___expand(r8,r4);
	label$51bd30c_1_16:
	r9 = r8->bytes;
	r5 = 2;
	r5 = r4 << r5;
	r10 = *(int*)(r9 + r5);
	++r10;
	*(int*)(r9 + r5) = r10;
	r8 = ((Enumt$ctx_955f890*)r0)->p3;
	if( r8 == NULL ) hl_null_access();
	r4 = 0;
	r5 = r8->length;
	if( ((unsigned)r4) < ((unsigned)r5) ) goto label$51bd30c_1_29;
	r4 = 0;
	goto label$51bd30c_1_33;
	label$51bd30c_1_29:
	r9 = r8->bytes;
	r5 = 2;
	r5 = r4 << r5;
	r4 = *(int*)(r9 + r5);
	label$51bd30c_1_33:
	r11 = ((Enumt$ctx_955f890*)r0)->p0;
	if( r11 == NULL ) hl_null_access();
	r2 = r11->contexts;
	if( r2 == NULL ) hl_null_access();
	r5 = r2->length;
	if( r4 != r5 ) goto label$51bd30c_1_43;
	r12 = ((Enumt$ctx_955f890*)r0)->p1;
	if( r12 == NULL ) hl_null_access();
	r3 = ((Enumt$ctx_955f890*)r0)->p2;
	r12->hasValue ? ((void (*)(vdynamic*,iron__data__MaterialData))r12->fun)((vdynamic*)r12->value,r3) : ((void (*)(iron__data__MaterialData))r12->fun)(r3);
	label$51bd30c_1_43:
	return;
}

void iron_data_MaterialData_new__$1(venum* r0,iron__data__ShaderData r1) {
	hl__types__ArrayObj r3;
	venum *r18;
	iron__data__MaterialContext r9;
	hl_type *r5;
	iron__data__TMaterialContext r15;
	hl__types__ArrayBytes_Int r11;
	iron__data__MaterialData r2;
	iron__data__TMaterialData r8;
	vclosure *r17, *r19;
	vdynamic *r16;
	vbyte *r12;
	int r6, r7, r13, r14;
	varray *r4;
	r2 = ((Enumt$ctx_0da146a*)r0)->p2;
	if( r2 == NULL ) hl_null_access();
	r2->shader = r1;
	r2 = ((Enumt$ctx_0da146a*)r0)->p2;
	if( r2 == NULL ) hl_null_access();
	r5 = &t$iron_data_MaterialContext;
	r6 = 0;
	r4 = hl_alloc_array(r5,r6);
	r3 = hl_types_ArrayObj_alloc(r4);
	r2->contexts = r3;
	label$51bd30c_2_10:
	r2 = ((Enumt$ctx_0da146a*)r0)->p2;
	if( r2 == NULL ) hl_null_access();
	r3 = r2->contexts;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->length;
	r8 = ((Enumt$ctx_0da146a*)r0)->p0;
	if( r8 == NULL ) hl_null_access();
	r3 = r8->contexts;
	if( r3 == NULL ) hl_null_access();
	r7 = r3->length;
	if( r6 >= r7 ) goto label$51bd30c_2_29;
	r2 = ((Enumt$ctx_0da146a*)r0)->p2;
	if( r2 == NULL ) hl_null_access();
	r3 = r2->contexts;
	if( r3 == NULL ) hl_null_access();
	r9 = NULL;
	r6 = hl_types_ArrayObj_push(r3,((vdynamic*)r9));
	goto label$51bd30c_2_10;
	label$51bd30c_2_29:
	r6 = 4;
	r12 = hl_alloc_bytes(r6);
	r6 = 0;
	r7 = 0;
	r13 = 2;
	r13 = r6 << r13;
	*(int*)(r12 + r13) = r7;
	++r6;
	r6 = 1;
	r11 = hl_types_ArrayBase_allocI32(r12,r6);
	r6 = 0;
	r8 = ((Enumt$ctx_0da146a*)r0)->p0;
	if( r8 == NULL ) hl_null_access();
	r3 = r8->contexts;
	if( r3 == NULL ) hl_null_access();
	r7 = r3->length;
	label$51bd30c_2_45:
	if( r6 >= r7 ) goto label$51bd30c_2_73;
	r13 = r6;
	++r6;
	r8 = ((Enumt$ctx_0da146a*)r0)->p0;
	if( r8 == NULL ) hl_null_access();
	r3 = r8->contexts;
	if( r3 == NULL ) hl_null_access();
	r14 = r3->length;
	if( ((unsigned)r13) < ((unsigned)r14) ) goto label$51bd30c_2_57;
	r15 = NULL;
	goto label$51bd30c_2_60;
	label$51bd30c_2_57:
	r4 = r3->array;
	r16 = ((vdynamic**)(r4 + 1))[r13];
	r15 = (iron__data__TMaterialContext)r16;
	label$51bd30c_2_60:
	r9 = (iron__data__MaterialContext)hl_alloc_obj(&t$iron_data_MaterialContext);
	r18 = hl_alloc_enum(&t$ctx_955f890,0);
	r8 = ((Enumt$ctx_0da146a*)r0)->p0;
	((Enumt$ctx_955f890*)r18)->p0 = (iron__data__TMaterialData)r8;
	r19 = ((Enumt$ctx_0da146a*)r0)->p1;
	((Enumt$ctx_955f890*)r18)->p1 = (vclosure*)r19;
	r2 = ((Enumt$ctx_0da146a*)r0)->p2;
	((Enumt$ctx_955f890*)r18)->p2 = (iron__data__MaterialData)r2;
	((Enumt$ctx_955f890*)r18)->p3 = (hl__types__ArrayBytes_Int)r11;
	((Enumt$ctx_955f890*)r18)->p4 = (int)r13;
	r17 = hl_alloc_closure_ptr(&t$fun_1916425,iron_data_MaterialData_new__$2,r18);
	iron_data_MaterialContext_new(r9,r15,r17);
	goto label$51bd30c_2_45;
	label$51bd30c_2_73:
	return;
}

void iron_data_MaterialData_parse__$1(venum* r0,iron__data__TSceneFormat r1) {
	String r4, r8;
	vvirtual *r9, *r11;
	hl__types__ArrayObj r3;
	iron__data__MaterialData r13;
	haxe__$Log r7;
	iron__data__TMaterialData r2;
	vclosure *r6, *r12;
	int r10;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->material_datas;
	r4 = ((Enumt$ctx_6e52869*)r0)->p1;
	r2 = iron_data_Data_getMaterialRawByName(r3,r4);
	if( r2 ) goto label$51bd30c_3_28;
	r7 = (haxe__$Log)g$_haxe_Log;
	r6 = r7->trace;
	if( r6 == NULL ) hl_null_access();
	r4 = (String)s$Material_data_;
	r8 = ((Enumt$ctx_6e52869*)r0)->p1;
	r4 = String___add__(r4,r8);
	r8 = (String)s$_not_found_;
	r4 = String___add__(r4,r8);
	r9 = hl_alloc_virtual(&t$vrt_329ffa8);
	r8 = (String)s$4c028d1;
	if( hl_vfields(r9)[1] ) *(String*)(hl_vfields(r9)[1]) = (String)r8; else hl_dyn_setp(r9->value,37969014/*fileName*/,&t$String,r8);
	r10 = 58;
	if( hl_vfields(r9)[2] ) *(int*)(hl_vfields(r9)[2]) = (int)r10; else hl_dyn_seti(r9->value,371360620/*lineNumber*/,&t$_i32,r10);
	r8 = (String)s$iron_data_MaterialData;
	if( hl_vfields(r9)[0] ) *(String*)(hl_vfields(r9)[0]) = (String)r8; else hl_dyn_setp(r9->value,-63073762/*className*/,&t$String,r8);
	r8 = (String)s$parse;
	if( hl_vfields(r9)[3] ) *(String*)(hl_vfields(r9)[3]) = (String)r8; else hl_dyn_setp(r9->value,302979532/*methodName*/,&t$String,r8);
	r11 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r9);
	r6->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r6->fun)((vdynamic*)r6->value,((vdynamic*)r4),r11) : ((void (*)(vdynamic*,vvirtual*))r6->fun)(((vdynamic*)r4),r11);
	r12 = ((Enumt$ctx_6e52869*)r0)->p2;
	if( r12 == NULL ) hl_null_access();
	r13 = NULL;
	r12->hasValue ? ((void (*)(vdynamic*,iron__data__MaterialData))r12->fun)((vdynamic*)r12->value,r13) : ((void (*)(iron__data__MaterialData))r12->fun)(r13);
	label$51bd30c_3_28:
	r13 = (iron__data__MaterialData)hl_alloc_obj(&t$iron_data_MaterialData);
	r12 = ((Enumt$ctx_6e52869*)r0)->p2;
	r4 = ((Enumt$ctx_6e52869*)r0)->p0;
	iron_data_MaterialData_new(r13,r2,r12,r4);
	return;
}

void iron_data_MaterialData_parse(String r0,String r1,vclosure* r2) {
	venum *r5;
	vclosure *r4;
	r5 = hl_alloc_enum(&t$ctx_6e52869,0);
	((Enumt$ctx_6e52869*)r5)->p0 = (String)r0;
	((Enumt$ctx_6e52869*)r5)->p1 = (String)r1;
	((Enumt$ctx_6e52869*)r5)->p2 = (vclosure*)r2;
	r4 = hl_alloc_closure_ptr(&t$fun_53d0d62,iron_data_MaterialData_parse__$1,r5);
	iron_data_Data_getSceneRaw(r0,r4);
	return;
}

iron__data__MaterialContext iron_data_MaterialData_getContext(iron__data__MaterialData r0,String r1) {
	String r9;
	hl__types__ArrayObj r3;
	iron__data__MaterialContext r6;
	iron__data__TMaterialContext r10;
	vdynamic *r7, *r11;
	varray *r8;
	int r2, r4, r5;
	r2 = 0;
	r3 = r0->contexts;
	label$51bd30c_5_2:
	if( r3 == NULL ) hl_null_access();
	r5 = r3->length;
	if( r2 >= r5 ) goto label$51bd30c_5_27;
	r5 = r3->length;
	if( ((unsigned)r2) < ((unsigned)r5) ) goto label$51bd30c_5_10;
	r6 = NULL;
	goto label$51bd30c_5_13;
	label$51bd30c_5_10:
	r8 = r3->array;
	r7 = ((vdynamic**)(r8 + 1))[r2];
	r6 = (iron__data__MaterialContext)r7;
	label$51bd30c_5_13:
	++r2;
	if( r6 == NULL ) hl_null_access();
	r10 = r6->raw;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->name;
	if( r9 == NULL ) hl_null_access();
	r4 = 0;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r11 = hl_alloc_dynamic(&t$_i32);
	r11->v.i = r5;
	r9 = String_substr(r9,r4,r11);
	if( r9 != r1 && (!r9 || !r1 || String___compare(r9,(vdynamic*)r1) != 0) ) goto label$51bd30c_5_26;
	return r6;
	label$51bd30c_5_26:
	goto label$51bd30c_5_2;
	label$51bd30c_5_27:
	r6 = NULL;
	return r6;
}

void iron_data_MaterialData_new(iron__data__MaterialData r0,iron__data__TMaterialData r1,vclosure* r2,String r3) {
	String r4, r10, r12;
	hl__types__ArrayObj r5;
	venum *r16;
	vclosure *r15;
	double r9;
	iron__data__$MaterialData r7;
	vdynamic *r13;
	iron__data__TShaderOverride r17;
	varray *r14;
	int r8, r11;
	if( r3 ) goto label$51bd30c_6_3;
	r4 = (String)s$;
	r3 = r4;
	label$51bd30c_6_3:
	r5 = NULL;
	r0->contexts = r5;
	r7 = (iron__data__$MaterialData)g$_iron_data_MaterialData;
	r8 = r7->uidCounter;
	++r8;
	r7->uidCounter = r8;
	r9 = (double)r8;
	r0->uid = r9;
	r0->raw = r1;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->name;
	r0->name = r4;
	r4 = r1->shader;
	if( r4 == NULL ) hl_null_access();
	r10 = (String)s$6666cd7;
	r5 = String_split(r4,r10);
	r4 = (String)s$;
	r10 = (String)s$;
	if( r5 == NULL ) hl_null_access();
	r8 = r5->length;
	r11 = 2;
	if( r8 != r11 ) goto label$51bd30c_6_44;
	r8 = 0;
	r11 = r5->length;
	if( ((unsigned)r8) < ((unsigned)r11) ) goto label$51bd30c_6_30;
	r12 = NULL;
	goto label$51bd30c_6_33;
	label$51bd30c_6_30:
	r14 = r5->array;
	r13 = ((vdynamic**)(r14 + 1))[r8];
	r12 = (String)r13;
	label$51bd30c_6_33:
	r4 = r12;
	r8 = 1;
	r11 = r5->length;
	if( ((unsigned)r8) < ((unsigned)r11) ) goto label$51bd30c_6_39;
	r12 = NULL;
	goto label$51bd30c_6_42;
	label$51bd30c_6_39:
	r14 = r5->array;
	r13 = ((vdynamic**)(r14 + 1))[r8];
	r12 = (String)r13;
	label$51bd30c_6_42:
	r10 = r12;
	goto label$51bd30c_6_47;
	label$51bd30c_6_44:
	r4 = r3;
	r12 = r1->shader;
	r10 = r12;
	label$51bd30c_6_47:
	r16 = hl_alloc_enum(&t$ctx_0da146a,0);
	((Enumt$ctx_0da146a*)r16)->p0 = (iron__data__TMaterialData)r1;
	((Enumt$ctx_0da146a*)r16)->p1 = (vclosure*)r2;
	((Enumt$ctx_0da146a*)r16)->p2 = (iron__data__MaterialData)r0;
	r15 = hl_alloc_closure_ptr(&t$fun_73968be,iron_data_MaterialData_new__$1,r16);
	r17 = r1->override_context;
	iron_data_Data_getShader(r4,r10,r15,r17);
	return;
}

