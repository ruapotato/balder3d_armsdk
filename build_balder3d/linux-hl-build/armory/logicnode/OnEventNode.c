// Generated by HLC 4.2.5 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <armory/logicnode/OnEventNode.h>
#include <hl/natives.h>
void armory_logicnode_OnEventNode_init(armory__logicnode__OnEventNode);
extern hl_type t$fun_e1e8cfb;
#include <iron/Trait.h>
void iron_Trait_notifyOnInit(iron__Trait,vclosure*);
void armory_logicnode_OnEventNode_update(armory__logicnode__OnEventNode);
void iron_Trait_notifyOnUpdate(iron__Trait,vclosure*);
#include <armory/logicnode/LogicNodeLink.h>
#include <iron/object/Object.h>
extern hl_type t$String;
extern hl_type t$_dyn;
void armory_logicnode_OnEventNode_onEvent(armory__logicnode__OnEventNode);
vvirtual* armory_system_Event_add(String,vclosure*,int*);
int String___compare(String,vdynamic*);
void armory_logicnode_OnEventNode_onRemove(armory__logicnode__OnEventNode);
void armory_logicnode_LogicNode_runOutput(armory__logicnode__LogicNode,int);
void armory_system_Event_removeListener(vvirtual*);
void armory_logicnode_LogicNode_new(armory__logicnode__LogicNode,armory__logicnode__LogicTree);
void iron_Trait_notifyOnRemove(iron__Trait,vclosure*);

void armory_logicnode_OnEventNode_init_main(armory__logicnode__OnEventNode r0) {
	String r2;
	armory__logicnode__LogicTree r7;
	vclosure *r8;
	vbyte *r5, *r6;
	int r3, r4;
	r2 = r0->property1;
	if( !r2 ) goto label$550a2c8_1_10;
	r3 = r2->length;
	r4 = 4;
	if( r3 != r4 ) goto label$550a2c8_1_10;
	r5 = r2->bytes;
	r6 = (vbyte*)USTR("init");
	r3 = hl_string_compare(r5,r6,r3);
	r4 = 0;
	if( r3 == r4 ) goto label$550a2c8_1_20;
	label$550a2c8_1_10:
	if( !r2 ) goto label$550a2c8_1_19;
	r3 = r2->length;
	r4 = 6;
	if( r3 != r4 ) goto label$550a2c8_1_19;
	r5 = r2->bytes;
	r6 = (vbyte*)USTR("update");
	r3 = hl_string_compare(r5,r6,r3);
	r4 = 0;
	if( r3 == r4 ) goto label$550a2c8_1_25;
	label$550a2c8_1_19:
	goto label$550a2c8_1_29;
	label$550a2c8_1_20:
	r7 = r0->tree;
	if( r7 == NULL ) hl_null_access();
	r8 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_init,r0);
	iron_Trait_notifyOnInit(((iron__Trait)r7),r8);
	goto label$550a2c8_1_29;
	label$550a2c8_1_25:
	r7 = r0->tree;
	if( r7 == NULL ) hl_null_access();
	r8 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_update,r0);
	iron_Trait_notifyOnUpdate(((iron__Trait)r7),r8);
	label$550a2c8_1_29:
	return;
}

void armory_logicnode_OnEventNode_init(armory__logicnode__OnEventNode r0) {
	String r9;
	armory__logicnode__LogicTree r13;
	vvirtual *r10;
	armory__logicnode__LogicNodeLink r4;
	hl__types__ArrayObj r1;
	armory__logicnode__LogicNode r8;
	vclosure *r11;
	int *r14;
	iron__object__Object r12;
	vdynamic *r5;
	varray *r6;
	int r2, r3;
	r1 = r0->inputs;
	if( r1 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r1->length;
	if( ((unsigned)r2) < ((unsigned)r3) ) goto label$550a2c8_2_7;
	r4 = NULL;
	goto label$550a2c8_2_10;
	label$550a2c8_2_7:
	r6 = r1->array;
	r5 = ((vdynamic**)(r6 + 1))[r2];
	r4 = (armory__logicnode__LogicNodeLink)r5;
	label$550a2c8_2_10:
	if( r4 == NULL ) hl_null_access();
	r8 = r4->fromNode;
	if( r8 == NULL ) hl_null_access();
	r2 = r4->fromIndex;
	r5 = ((vdynamic* (*)(armory__logicnode__LogicNode,int))r8->$type->vobj_proto[1])(r8,r2);
	r9 = (String)hl_dyn_castp(&r5,&t$_dyn,&t$String);
	r0->value = r9;
	r9 = r0->value;
	r11 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_onEvent,r0);
	r13 = r0->tree;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->object;
	if( r12 == NULL ) hl_null_access();
	r2 = r12->uid;
	r14 = &r2;
	r10 = armory_system_Event_add(r9,r11,r14);
	r0->listener = r10;
	return;
}

void armory_logicnode_OnEventNode_update(armory__logicnode__OnEventNode r0) {
	String r9, r10;
	armory__logicnode__LogicTree r14;
	vvirtual *r11;
	armory__logicnode__LogicNodeLink r4;
	hl__types__ArrayObj r1;
	armory__logicnode__LogicNode r8;
	vclosure *r12;
	int *r15;
	iron__object__Object r13;
	vdynamic *r5;
	varray *r6;
	int r2, r3;
	r1 = r0->inputs;
	if( r1 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r1->length;
	if( ((unsigned)r2) < ((unsigned)r3) ) goto label$550a2c8_3_7;
	r4 = NULL;
	goto label$550a2c8_3_10;
	label$550a2c8_3_7:
	r6 = r1->array;
	r5 = ((vdynamic**)(r6 + 1))[r2];
	r4 = (armory__logicnode__LogicNodeLink)r5;
	label$550a2c8_3_10:
	if( r4 == NULL ) hl_null_access();
	r8 = r4->fromNode;
	if( r8 == NULL ) hl_null_access();
	r2 = r4->fromIndex;
	r5 = ((vdynamic* (*)(armory__logicnode__LogicNode,int))r8->$type->vobj_proto[1])(r8,r2);
	r9 = (String)hl_dyn_castp(&r5,&t$_dyn,&t$String);
	r0->value = r9;
	r9 = r0->value;
	r10 = r0->oldValue;
	if( r9 == r10 || (r9 && r10 && String___compare(r9,(vdynamic*)r10) == 0) ) goto label$550a2c8_3_33;
	armory_logicnode_OnEventNode_onRemove(r0);
	r9 = r0->value;
	r12 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_onEvent,r0);
	r14 = r0->tree;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->object;
	if( r13 == NULL ) hl_null_access();
	r2 = r13->uid;
	r15 = &r2;
	r11 = armory_system_Event_add(r9,r12,r15);
	r0->listener = r11;
	r9 = r0->value;
	r0->oldValue = r9;
	label$550a2c8_3_33:
	return;
}

void armory_logicnode_OnEventNode_run(armory__logicnode__OnEventNode r0,int r1) {
	String r10, r11;
	armory__logicnode__LogicTree r15;
	vvirtual *r12;
	armory__logicnode__LogicNodeLink r5;
	hl__types__ArrayObj r2;
	armory__logicnode__LogicNode r9;
	vclosure *r13;
	int *r16;
	iron__object__Object r14;
	vdynamic *r6;
	varray *r7;
	int r3, r4;
	r2 = r0->inputs;
	if( r2 == NULL ) hl_null_access();
	r3 = 1;
	r4 = r2->length;
	if( ((unsigned)r3) < ((unsigned)r4) ) goto label$550a2c8_4_7;
	r5 = NULL;
	goto label$550a2c8_4_10;
	label$550a2c8_4_7:
	r7 = r2->array;
	r6 = ((vdynamic**)(r7 + 1))[r3];
	r5 = (armory__logicnode__LogicNodeLink)r6;
	label$550a2c8_4_10:
	if( r5 == NULL ) hl_null_access();
	r9 = r5->fromNode;
	if( r9 == NULL ) hl_null_access();
	r3 = r5->fromIndex;
	r6 = ((vdynamic* (*)(armory__logicnode__LogicNode,int))r9->$type->vobj_proto[1])(r9,r3);
	r10 = (String)hl_dyn_castp(&r6,&t$_dyn,&t$String);
	r0->value = r10;
	r10 = r0->value;
	r11 = r0->oldValue;
	if( r10 == r11 || (r10 && r11 && String___compare(r10,(vdynamic*)r11) == 0) ) goto label$550a2c8_4_33;
	armory_logicnode_OnEventNode_onRemove(r0);
	r10 = r0->value;
	r13 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_onEvent,r0);
	r15 = r0->tree;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->object;
	if( r14 == NULL ) hl_null_access();
	r3 = r14->uid;
	r16 = &r3;
	r12 = armory_system_Event_add(r10,r13,r16);
	r0->listener = r12;
	r10 = r0->value;
	r0->oldValue = r10;
	label$550a2c8_4_33:
	return;
}

void armory_logicnode_OnEventNode_onEvent(armory__logicnode__OnEventNode r0) {
	int r2;
	r2 = 0;
	armory_logicnode_LogicNode_runOutput(((armory__logicnode__LogicNode)r0),r2);
	return;
}

void armory_logicnode_OnEventNode_onRemove(armory__logicnode__OnEventNode r0) {
	vvirtual *r2;
	r2 = r0->listener;
	if( !r2 ) goto label$550a2c8_6_4;
	r2 = r0->listener;
	armory_system_Event_removeListener(r2);
	label$550a2c8_6_4:
	return;
}

void armory_logicnode_OnEventNode_new(armory__logicnode__OnEventNode r0,armory__logicnode__LogicTree r1) {
	vvirtual *r2;
	vclosure *r4;
	r2 = NULL;
	r0->listener = r2;
	armory_logicnode_LogicNode_new(((armory__logicnode__LogicNode)r0),r1);
	if( r1 == NULL ) hl_null_access();
	r4 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_init_main,r0);
	iron_Trait_notifyOnInit(((iron__Trait)r1),r4);
	r4 = hl_alloc_closure_ptr(&t$fun_e1e8cfb,armory_logicnode_OnEventNode_onRemove,r0);
	iron_Trait_notifyOnRemove(((iron__Trait)r1),r4);
	return;
}

